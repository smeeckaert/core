var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){"use strict";function r(e,t){typeof t=="undefined"&&(t=2);var n=""+e+"";if(n.length>t)n=n.substr(n.length-t);else while(n.length<t)n="0"+n;return n}var t=jQuery,n=(t.ui||t.mobile).keyCode,i=function(r){function i(){r.apply(this,arguments)}return __extends(i,r),i.prototype._createTextProvider=function(){this._textProvider=new o(this,this.options.dateFormat)},i.prototype._strToDate=function(e){return this._textProvider.parseDate(e)},i.prototype._beginUpdate=function(){var e=this.options,t,n=null;r.prototype._beginUpdate.call(this),e.minDate&&typeof e.minDate=="string"&&(e.minDate=this._strToDate(e.minDate)),e.maxDate&&typeof e.maxDate=="string"&&(e.maxDate=this._strToDate(e.maxDate)),e.date?typeof e.date=="string"?t=e.date:n=e.date:!this.element.data("elementValue")||(t=this.element.data("elementValue")),t&&(n=this._strToDate(t)),this._safeSetDate(n),this.element.data({defaultDate:n===null?n:new Date(e.date.getTime()),preDate:n===null?n:new Date(e.date.getTime())}),this._resetTimeStamp(),e.showTrigger&&!this._hasComboItems()&&this._initCalendar(),this.element.addClass(e.wijCSS.wijinputdate).attr({"aria-valuemin":new Date(1900,1,1),"aria-valuemax":new Date(2099,1,1),"aria-valuenow":e.date})},i.prototype._endUpdate=function(){var e=this;r.prototype._endUpdate.call(this),this.element.bind("click.wijinput",function(){e._highLightCursor()})},i.prototype._isValidDate=function(e,t){var n=this.options;if(e===undefined)return!1;if(isNaN(e))return!1;if(e.getFullYear()<1||e.getFullYear()>9999)return!1;if(t){if(n.minDate&&e<n.minDate)return!1;if(n.maxDate&&e>n.maxDate)return!1}return!0},i.prototype._checkRange=function(e){var t=this.options;return e&&(t.minDate&&e<t.minDate&&(e=new Date(Math.max(t.minDate,e))),t.maxDate&&e>t.maxDate&&(e=new Date(Math.min(t.maxDate,e)))),e},i.prototype._safeSetDate=function(e){var t=this.options,n=e;return e=this._checkRange(e),isNaN(e)&&(e=n),t.date=e,!0},i.prototype._safeGetDate=function(){var e=this.options.date||this._creationDate;return e=this._checkRange(e),e},i.prototype._setOption=function(e,t){r.prototype._setOption.call(this,e,t);switch(e){case"date":!t||(typeof t=="string"?t=this._strToDate(t):typeof t=="object"?t=new Date(t.getTime()):t=new Date(t),isNaN(t)&&(t=new Date)),this._safeSetDate(t),this._updateText(),this._highLightField();break;case"dateFormat":case"culture":this._textProvider._setFormat(this.options.dateFormat),this._updateText();var n=this.element.data("calendar");n&&n.wijcalendar("option",e,t);break;case"activeField":t=Math.min(t,this._textProvider.getFieldCount()-1),t=Math.max(t,0),this.options.activeField=t,this._highLightField(),this._resetTimeStamp();break;case"nextTooltip":case"prevTooltip":case"titleFormat":case"toolTipFormat":var n=this.element.data("calendar",n);n&&n.wijcalendar("option",e,t)}},i.prototype._setData=function(e){this.option("date",e)},i.prototype._resetData=function(){var e=this.element.data("defaultDate");e===undefined||e===null?(e=this.element.data("elementValue"),e!==undefined&&e!==null&&e!==""?this.setText(e):this._setData(null)):this._setData(e)},i.prototype._resetTimeStamp=function(){this.element.data("cursorPos",0),this.element.data("timeStamp",new Date("1900/1/1"))},i.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(this.options.showNullText&&this.isDateNull())return"";var e=this._textProvider.toString();return e===this.options.nullText?"":e},i.prototype._highLightField=function(e){typeof e=="undefined"&&(e=this.options.activeField);if(this.isFocused()){var t=this._textProvider.getFieldRange(e);t&&this.element.wijtextselection(t)}},i.prototype._highLightCursor=function(e){if(this._isNullText())return;e===undefined&&(e=Math.max(0,this.element.wijtextselection().start));var t=this._textProvider.getCursorField(e);if(t<0)return;this._setOption("activeField",t)},i.prototype._toNextField=function(){this._setOption("activeField",this.options.activeField+1)},i.prototype._toPrevField=function(){this._setOption("activeField",this.options.activeField-1)},i.prototype._toFirstField=function(){this._setOption("activeField",0)},i.prototype._toLastField=function(){this._setOption("activeField",this._textProvider.getFieldCount())},i.prototype._clearField=function(t){typeof t=="undefined"&&(t=this.options.activeField);var n=this._textProvider.getFieldRange(t),r,i=this;n&&(r=new e.wijInputResult,this._textProvider.removeAt(n.start,n.end,r),this._updateText(),window.setTimeout(function(){i._highLightField()},1))},i.prototype._doSpin=function(e,t){var n=this;return this._allowEdit()?t&&this.element.data("breakSpinner")?!1:(this._textProvider[e?"incEnumPart":"decEnumPart"]()&&(this._updateText(),this._highLightField()),t&&!this.element.data("breakSpinner")&&window.setTimeout(function(){return n._doSpin(e,!0)},this._calcSpinInterval()),!0):!1},i.prototype._onChange=function(){},i.prototype._afterFocused=function(){this._isNullText()&&this._doFocus()},i.prototype._keyDownPreview=function(e){var t=e.keyCode||e.which,r;switch(t){case n.LEFT:return this._toPrevField(),!0;case n.RIGHT:return this._toNextField(),!0;case n.TAB:case n.SPACE:case 188:case 190:case 110:case 191:if(e.shiftKey){if(this.options.activeField>0)return this._toPrevField(),!0}else if(this.options.activeField<this._textProvider.getFieldCount()-1)return this._toNextField(),!0;break;case n.HOME:return e.ctrlKey?this._setOption("date",new Date):this._toFirstField(),!0;case n.END:return e.ctrlKey?this._setOption("date",new Date("1970/1/1")):this._toLastField(),!0;case n.DELETE:if(this._allowEdit())return r=this.element.wijtextselection(),r.end-r.start===this.element.val().length?(this.isDeleteAll=!0,this._setOption("date",new Date("1970/1/1"))):this._clearField(),!0}return!1},i.prototype._autoMoveToNextField=function(e,t){if(!this.options.autoNextField)return;this._textProvider.needToMove(this.options.activeField,e,t)&&this._toNextField()},i.prototype._keyPressPreview=function(e){var t=e.keyCode||e.which,r,i,s,o,u,a,f,l,c,h,p;if(t===n.ENTER)return this.isDateNull()&&(this.options.date=new Date),!1;r=this._textProvider.getFieldRange(this.options.activeField);if(r){if(t===n.TAB)return!0;if(t===n.SPACE)return this._stopEvent(e),!0;i=String.fromCharCode(t),s=this._textProvider.isFieldSep(i,this.options.activeField);if(s)return this._toNextField(),this._stopEvent(e),!0;o=this.element.data("cursorPos"),u=new Date,f=this.element.data("timeStamp"),p=this.element.data("lastInput"),a=u.getTime()-f.getTime()>this.options.keyDelay;var h=i;return a?o=0:p&&(h=p+h),this.element.data({timeStamp:u,lastInput:h}),l=r.start+o,this.element.data("cursorPos",++o),c=this._textProvider.addToField(h,this.options.activeField,l),c?(this._updateText(),this._autoMoveToNextField(o,i),this._highLightField()):(this._resetTimeStamp(),this._fireIvalidInputEvent()),this._stopEvent(e),!0}return!1},i.prototype._raiseDataChanged=function(){var e=this.options.date,t=this.element.data("preDate");this.element.data("preDate",e?new Date(e.getTime()):null);if(!t&&e||t&&!e||t&&e&&t.getTime()!==e.getTime())this._syncCalendar(),this.element.attr("aria-valuenow",e),this._trigger("dateChanged",null,{date:e})},i.prototype.isDateNull=function(){return this.options.date===null||this.options.date===undefined},i.prototype._isMinDate=function(e){return e.getFullYear()===1&&e.getMonth()===0&&e.getDate()===1},i.prototype._initCalendar=function(){var e=this,n=this.options,r=n.calendar,i;if(r===undefined||r===null)return;if(typeof r=="boolean"||r==="default")r=t("<div/>"),r.appendTo(document.body);i=t(r);if(i.length!==1)return;this.element.data("calendar",i),n.localization&&(n.nextTooltip=n.localization.nextTooltip,n.prevTooltip=n.localization.prevTooltip,n.titleFormat=n.localization.titleFormat,n.toolTipFormat=n.localization.toolTipFormat),i.wijcalendar({popupMode:!0,culture:n.culture,nextTooltip:n.nextTooltip||"Next",prevTooltip:n.prevTooltip||"Previous",titleFormat:n.titleFormat||"MMMM yyyy",toolTipFormat:n.toolTipFormat||"dddd, MMMM dd, yyyy",selectedDatesChanged:function(){var t=i.wijcalendar("getSelectedDate"),n=e.option("date");i.wijcalendar("close"),t&&(n&&(t.setHours(n.getHours()),t.setMinutes(n.getMinutes()),t.setSeconds(n.getSeconds()),t.setMilliseconds(n.getMilliseconds())),e.option("date",t),e.selectText()),e._trySetFocus()}}),this._syncCalendar()},i.prototype._syncCalendar=function(){var e=this.element.data("calendar"),t,n;if(!e)return;t=this.options,n=this._safeGetDate(),this._isMinDate(n)&&(n=new Date),e.wijcalendar("option","displayDate",n),t.minDate&&e.wijcalendar("option","minDate",t.minDate),t.maxDate&&e.wijcalendar("option","maxDate",t.maxDate),e.wijcalendar("unSelectAll"),e.wijcalendar("selectDate",n),e.wijcalendar("refresh")},i.prototype._isPopupShowing=function(){var e=this.element.data("calendar");return e?e.wijcalendar("isPopupShowing"):r.prototype._isPopupShowing.call(this)},i.prototype._showPopup=function(){var e=this.element.data("calendar");if(!e)return r.prototype._showPopup.call(this);if(!this._allowEdit())return;this._syncCalendar(),e.wijcalendar("popup",t.extend({},this.options.popupPosition,{of:this.outerDiv}))},i.prototype._hidePopup=function(){var e=this.element.data("calendar");if(!e)return r.prototype._hidePopup.call(this);e.wijcalendar("close")},i.prototype._isCalendarVisible=function(){if(!this._allowEdit())return!1;var e=this.element.data("calendar");return e?e.wijcalendar("isPopupShowing"):!1},i.prototype._popupVisible=function(){return this._hasComboItems()?this._isComboListVisible():this._isCalendarVisible()},i}(e.wijinputcore);e.wijinputdate=i;var s=function(){function t(){this.wijCSS={wijinputdate:e.wijinputcore.prototype.options.wijCSS.wijinput+"-date"},this.date=null,this.minDate=null,this.maxDate=null,this.dateFormat="d",this.startYear=1950,this.smartInputMode=!0,this.activeField=0,this.keyDelay=800,this.autoNextField=!0,this.calendar="default",this.popupPosition={offset:"0 4"},this.dateChanged=null}return t}();i.prototype.options=t.extend(!0,{},e.wijinputcore.prototype.options,new s),t.wijmo.registerWidget("wijinputdate",i.prototype);var o=function(n){function i(e,t){n.call(this),this.inputWidget=e,this.maskPartsCount=0,this.pattern="M/d/yyyy",this._disableSmartInputMode=!1,this.paddingZero=r,this.descriptors=new Array(0),this.desPostions=new Array(0),this.fields=new Array(0),this._setFormat(t)}return __extends(i,n),i.prototype.initialize=function(){},i.prototype.getFieldCount=function(){return this.fields.length},i.prototype.getFieldRange=function(e){var t=this.fields[e];return{start:t.startIndex,end:t.startIndex+t.getText().length}},i.prototype.getCursorField=function(e){e=Math.min(e,this.desPostions.length-1),e=Math.max(e,0);var n=this.desPostions[e].desc,r;if(n.type===-1){r=t.inArray(n,this.descriptors);if(!(r>0&&this.descriptors[r-1].type!==-1))return-1;n=this.descriptors[r-1]}return t.inArray(n,this.fields)},i.prototype.needToMove=function(e,t,n){if(!this.inputWidget._isValidDate(this.inputWidget._safeGetDate(),!0))return!1;var r=this.fields[e],i=parseInt(n,10);if(t===r.maxLen)return!0;if(isNaN(i))return!1;switch(r.type){case 20:case 25:case 45:case 46:return i>1;case 47:case 48:return i>2;case 30:case 31:return i>3;case 50:case 51:case 60:case 61:return i>6}return!1},i.prototype._getCulture=function(){return this.inputWidget._getCulture()},i.prototype._isDigitString=function(e){e=t.trim(e);if(e.length===0)return!0;var n=e.charAt(0),r,i;if(n==="+"||n==="-")e=e.substr(1),e=t.trim(e);if(e.length===0)return!0;try{return r=parseFloat(e),i=r.toString(),i===e}catch(s){return!1}},i.prototype._setFormat=function(e){this.descriptors=[];var n="",r="",i=!1,s=!1,o,u;this.pattern=this._parseFormatToPattern(e);for(o=0;o<this.pattern.length;o++){u=this.pattern.charAt(o);if(s){this.descriptors.push(this.createDescriptor(-1,u)),n="",s=!1;continue}if(u==="\\"){s=!0,n.length>0&&(this.handlePattern(n)||this.descriptors.push(this.createDescriptor(-1,r)),n="");continue}if(u==="'"){i?(i=!1,n=""):(i=!0,n.length>0&&(this.handlePattern(n)||this.descriptors.push(this.createDescriptor(-1,r)),n=""));continue}if(i){this.descriptors.push(this.createDescriptor(-1,u)),n="";continue}o||(r=u),r!==u&&n.length>0&&(this.handlePattern(n)||this.descriptors.push(this.createDescriptor(-1,r)),n=""),n+=u,r=u}n.length>0&&(this.handlePattern(n)||this.descriptors.push(this.createDescriptor(-1,r))),this.fields=t.grep(this.descriptors,function(e){return e.type!==-1})},i.prototype._parseFormatToPattern=function(e){var t=this.inputWidget._getCulture().calendars.standard,n=t.patterns.d;if(e.length<=1)switch(e){case"":case"d":n=t.patterns.d;break;case"D":n=t.patterns.D;break;case"f":n=t.patterns.D+" "+t.patterns.t;break;case"F":n=t.patterns.D+" "+t.patterns.T;break;case"g":n=t.patterns.d+" "+t.patterns.t;break;case"G":n=t.patterns.d+" "+t.patterns.T;break;case"m":n=t.patterns.M;break;case"M":n=t.patterns.M;break;case"s":n=t.patterns.S;break;case"t":n=t.patterns.t;break;case"T":n=t.patterns.T;break;case"u":n=t.patterns.S;break;case"U":n=t.patterns.D+" "+t.patterns.T;break;case"y":n=t.patterns.Y;break;case"Y":n=t.patterns.Y}else n=e;return n},i.prototype.getDate=function(){return this.inputWidget?new Date(this.inputWidget._safeGetDate().getTime()):undefined},i.prototype.setDate=function(e){this.inputWidget&&this.inputWidget._setData(e)},i.prototype._internalSetDate=function(e){if(this.inputWidget){var t=this,n=this.inputWidget.options,r=this.inputWidget.element,i=!!r.data("typing"),s;i?(n.date=e,s=function(){var e=new Date,i=r.data("timeStamp");e.getTime()-i.getTime()>n.keyDelay?(t.inputWidget._safeSetDate(n.date),t.inputWidget._updateText(),t.inputWidget._highLightField()):window.setTimeout(s,n.keyDelay)},window.setTimeout(s,n.keyDelay)):this.inputWidget._safeSetDate(e)}},i.prototype.daysInMonth=function(e,t){e-=1;var n=(new Date(t,++e,1,-1)).getDate();return n},i.prototype.setYear=function(e,t,n){try{t&&t.isfullreset&&(t.offset=1,e="1970");if(typeof e=="string"&&!this._isDigitString(e))return!1;e*=1;var r=this.inputWidget.options,i=1,s=9999,o,u,a;n&&(r.minDate&&(i=Math.max(i,r.minDate.getFullYear())),r.maxDate&&(s=Math.min(s,r.maxDate.getFullYear()))),t&&t.isreset&&(e=i),e<i&&(e=i),e>s&&(e=s),o=this.getDate(),u=new Date(o.getTime()),u.setFullYear(e);if(this._isValidDate(u))return a=this.daysInMonth(this.getMonth(),this.getYear()),a===o.getDate()?(u=new Date(o.getTime()),u.setDate(1),u.setFullYear(e),a=this.daysInMonth(u.getMonth()+1,u.getFullYear()),u.setDate(a),this._isValidDate(u)?(this._internalSetDate(u),!0):!1):(o.setFullYear(e),this._internalSetDate(o),!0);return t&&t.isreset?(o.setFullYear(1),this._internalSetDate(o),!0):!1}catch(f){return!1}},i.prototype.getYear=function(){return this.getDate().getFullYear()},i.prototype.setMonth=function(e,t,n){try{n&&n.isfullreset&&(e="1"),e*=1;var r=this.getDate(),i,s;if(typeof t!="undefined"&&!t)if(e>12||e<1){if(!n||!n.isreset)return!1;e=1}return i=this.daysInMonth(this.getMonth(),this.getYear()),i===this.getDate().getDate()?(s=new Date(r.getTime()),s.setDate(1),s.setMonth(e-1),i=this.daysInMonth(s.getMonth()+1,s.getFullYear()),s.setDate(i),this._isValidDate(s)?(this._internalSetDate(s),!0):!1):(s=new Date(r.getTime()),s.setMonth(e-1),this._isValidDate(s)?(this._internalSetDate(s),!0):!1)}catch(o){return!1}},i.prototype.getMonth=function(){return this.getDate().getMonth()+1},i.prototype.setDayOfMonth=function(e,t,n){try{if(n&&n.isfullreset)return this.setDayOfMonth(1,t);var r=this.getDate(),i,s;e*=1;if(typeof t!="undefined"&&!t){i=this.daysInMonth(this.getMonth(),this.getYear());if(e>i||e<1)return n&&n.isreset?this.setDayOfMonth(1,t,n):!1}return s=new Date(r.getTime()),s.setDate(e),this._isValidDate(s)?(this._internalSetDate(s),!0):!1}catch(o){return!1}},i.prototype.getDayOfMonth=function(){return this.getDate().getDate()},i.prototype.setHours=function(e,t){try{e*=1;if(typeof t!="undefined"&&!t&&e>24)return!1;var n=new Date(this.getDate().getTime());return n.setHours(e),this._isValidDate(n)?(this._internalSetDate(n),!0):!1}catch(r){return!1}},i.prototype.getHours=function(){return this.getDate().getHours()},i.prototype.setMinutes=function(e,t){try{e*=1;if(typeof t!="undefined"&&!t&&e>60)return!1;var n=new Date(this.getDate().getTime());return n.setMinutes(e),this._isValidDate(n)?(this._internalSetDate(n),!0):!1}catch(r){return!1}},i.prototype.getMinutes=function(){return this.getDate().getMinutes()},i.prototype.setSeconds=function(e,t){try{e*=1;if(typeof t!="undefined"&&!t&&e>60)return!1;var n=new Date(this.getDate().getTime());return n.setSeconds(e),this._isValidDate(n)?(this._internalSetDate(n),!0):!1}catch(r){return!1}},i.prototype.getSeconds=function(){return this.getDate().getSeconds()},i.prototype.setDayOfWeek=function(e){try{e*=1;var t=e-this.getDayOfWeek();return this.setDayOfMonth(this.getDayOfMonth()+t,!0)}catch(n){return!1}},i.prototype.getDayOfWeek=function(){return this.getDate().getDay()+1},i.prototype.handlePattern=function(e){var t=new RegExp("y{3,4}"),n=t.test(e);return n?(this.descriptors.push(this.createDescriptor(10)),!0):(t=new RegExp("y{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(2)),!0):(t=new RegExp("y{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(1)),!0):(t=new RegExp("d{4,4}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(101)),!0):(t=new RegExp("d{3,3}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(100)),!0):(t=new RegExp("d{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(30)),!0):(t=new RegExp("d{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(31)),!0):(t=new RegExp("M{4,4}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(27)),!0):(t=new RegExp("M{3,3}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(26)),!0):(t=new RegExp("M{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(20)),!0):(t=new RegExp("M{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(25)),!0):(t=new RegExp("h{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(46)),!0):(t=new RegExp("h{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(45)),!0):(t=new RegExp("H{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(48)),!0):(t=new RegExp("H{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(47)),!0):(t=new RegExp("m{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(50)),!0):(t=new RegExp("m{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(51)),!0):(t=new RegExp("s{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(60)),!0):(t=new RegExp("s{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(61)),!0):(t=new RegExp("t{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(251)),!0):(t=new RegExp("t{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(250)),!0):!1))))))))))))))))))))},i.prototype.createDescriptor=function(e,t){var n=null,r=this.maskPartsCount++;switch(e){case-1:n=new f(this,r),n.liternal=t;break;case 20:n=new c(this,r);break;case 25:n=new h(this,r);break;case 26:n=new p(this,r);break;case 27:n=new d(this,r);break;case 30:n=new m(this,r);break;case 31:n=new g(this,r);break;case 100:n=new y(this,r);break;case 101:n=new b(this,r);break;case 10:n=new E(this,r);break;case 1:n=new x(this,r);break;case 2:n=new T(this,r);break;case 45:n=new k(this,r);break;case 46:n=new L(this,r);break;case 47:n=new O(this,r);break;case 48:n=new M(this,r);break;case 250:n=new D(this,r);break;case 251:n=new P(this,r);break;case 50:n=new B(this,r);break;case 51:n=new j(this,r);break;case 60:n=new I(this,r);break;case 61:n=new q(this,r);break;default:}return n},i.prototype.toString=function(){if(this.inputWidget.options.showNullText&&!this.inputWidget.isFocused()&&this.inputWidget.isDateNull())return this.inputWidget.options.nullText;var e="",t=0,n,r,i;this.desPostions=new Array(0);for(n=0;n<this.descriptors.length;n++){this.descriptors[n].startIndex=e.length,r=this.descriptors[n].getText(),e+=r;for(i=0;i<r.length;i++){this.desPostions.push({desc:this.descriptors[n],pos:i,text:r,length:r.length}),t++;if(this.desPostions.length!==t)throw"Fatal Error !!!!!!!!!!!!!!!"}}return e},i.prototype.parseDate=function(e){var t;if(this.pattern==="dddd"||this.pattern==="ddd"||typeof e=="object")try{t=new Date(e),isNaN(t)&&(t=new Date)}catch(n){t=new Date}else t=Globalize.parseDate(e,this.pattern,this._getCulture()),t||(t=this._tryParseDate(e,this.pattern)),t||(t=new Date);return t},i.prototype.set=function(e){return this._internalSetDate(new Date(this.parseDate(e))),!0},i.prototype.haveEnumParts=function(){return!1},i.prototype.removeLiterals=function(e){return e=""+e+"",e=e.replace(new RegExp("[+]","g"),""),e=e.replace(new RegExp("[.]","g"),""),e=e.replace(new RegExp("[:]","g"),""),e=e.replace(new RegExp("[-]","g"),""),e=e.replace(new RegExp("[()=]","g"),""),e},i.prototype.getFirstDelimiterPos=function(e,t){var n=0,r=0,i,s;while(n<t.length&&r<e.length){i=t.charAt(n),s=e.charAt(r);if(i!==s)return r-1;r++,n++}return e.length-1},i.prototype.findAlikeArrayItemIndex=function(e,t){var n=-1,r=99999,i,s;for(i=0;i<e.length;i++)s=e[i].toLowerCase().indexOf(t.toLowerCase()),s!==-1&&s<r&&(r=s,n=i);return n},i.prototype._isValidDate=function(e){return this.inputWidget._isValidDate(e)},i.prototype.isFieldSep=function(e,t){var n=t++,r;return n<this.descriptors.length?(r=this.descriptors[n],r.type!==-1?!1:e===r.text):!1},i.prototype.getPositionType=function(e){var t=this.desPostions[e];return t.desc.type},i.prototype.addToField=function(e,t,n){var r=this.fields[t],i,s,o;return i=e,s={val:e,pos:0,offset:0,isreset:!1},this.inputWidget.element.data("typing",!0),o=r.setText(i,e.length===1?!1:!0,s),this.inputWidget.element.data("typing",!1),o},i.prototype.insertAt=function(t,n,r){typeof r=="undefined"&&(r=new e.wijInputResult),r.testPosition=-1;var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;if(t.length===1){i=this.desPostions[n];if(i&&i.desc.type===-1&&i.text===t)return r.testPosition=n,r.hint=r.characterEscaped,!0}s=t,o=n,t=this.removeLiterals(t),u=t,a=!1,l=!1,o>0&&u.length===1&&(o--,n=o,i=this.desPostions[o],a=!0,i&&(i.desc.type===-1||i.desc.getText().length!==1)&&(n++,o++,a=!1)),f=!1;while(u.length>0&&o<this.desPostions.length){i=this.desPostions[o];if(i.desc.type===-1){o+=i.length;continue}if(i.desc.needAdjustInsertPos()){c=u.substr(0,i.length-i.pos),c=i.text.slice(0,i.pos)+c+i.text.slice(i.pos+c.length,i.length),a&&(c=i.text+c),l&&(c+=i.text),p=i.desc.getText().length,v="";try{t.length===1&&(i.pos?i.pos>0&&(v=c.substring(0,i.pos+1)):v=t)}catch(E){}p===1&&c.length>1&&t.length===1&&(i.desc.type===31||i.desc.type===25)&&(this._disableSmartInputMode=!0),h={val:t,pos:i.pos,offset:0,isreset:!1},f=i.desc.setText(c,t.length===1?!1:!0,h),this._disableSmartInputMode=!1,!f&&typeof v!="undefined"&&v.length>0&&(i.desc.type===26||i.desc.type===27||i.desc.type===100||i.desc.type===101||i.desc.type===250||i.desc.type===251)&&(f=i.desc.setText(v,t.length===1?!1:!0,h));if(f)r.hint=r.success,r.testPosition=o+h.offset,t.length===1&&(m=i.desc.getText().length,d=i.pos,i.pos>m-1&&(d=m),g=m-p,g>0&&i.pos===p-1&&(d=m-1),y=this.toString(),r.testPosition=i.desc.startIndex+d+h.offset),u=u.slice(i.length-i.pos,u.length);else{r.hint=r.invalidInput,r.testPosition!==-1&&(r.testPosition=n);if(i.desc.type!==-1&&t.length===1)return!1}o+=i.length}else b=this.getFirstDelimiterPos(u,s),b<0&&(b=0),c=u.substring(0,b+1),h={val:t,pos:i.pos,offset:0,isreset:!1},f=i.desc.setText(c,t.length===1?!1:!0,h),f?(r.hint=r.success,r.testPosition=o+h.offset,u=u.slice(b+1,u.length)):(r.hint=r.invalidInput,r.testPosition!==-1&&(r.testPosition=n)),b<0&&(b=0),w=b+1,o+=w}return f},i.prototype.removeAt=function(e,t,n){try{var r=this.desPostions[e],i,s,o,u,a=this.inputWidget,f=a.element,l=f.val().length;return l===t+1&&e===0&&(a.isDeleteAll=!0),r.desc.needAdjustInsertPos()&&(i="0",s=e,r.text=r.desc.getText(),i=r.text.slice(0,r.pos)+i+r.text.slice(r.pos+i.length,r.length),o={val:i,pos:r.pos,offset:0,isreset:!0,isfullreset:!1},t-e+1>=r.length&&(o.isfullreset=!0,e+=r.length,s=e),u=r.desc.setText(i,!1,o),u?(n.hint=n.success,n.testPosition=s):(n.hint=n.invalidInput,n.testPosition===-1&&(n.testPosition=e))),e<t&&this.removeAt(e+1,t,n),!0}catch(c){return!1}},i.prototype.incEnumPart=function(){var e=this.fields[this.inputWidget.options.activeField];return e&&e.inc(),!0},i.prototype.decEnumPart=function(e){var t=this.fields[this.inputWidget.options.activeField];return t&&t.dec(),!0},i.prototype.setValue=function(e){return this.setDate(new Date(e instanceof Date?e.getTime():e)),!0},i.prototype.getValue=function(){return this.getDate()},i.prototype._isSmartInputMode=function(){return this._disableSmartInputMode?!1:this.inputWidget?this.inputWidget.options.smartInputMode:!0},i.prototype._getInt=function(e,n,r,i){var s,o;for(s=i;s>=r;s--){o=e.substring(n,n+s);if(o.length<r)return null;if(t.wij.charValidator.isDigit(o))return o}return null},i.prototype._tryParseDate=function(e,t){var n=this._getCulture().calendars,r,i,s,o;return t=t||n.standard.patterns.d,t&&(t.indexOf("MMM")===-1&&t.indexOf("MMMM")===-1&&(t=t.replace("MM","M")),t=t.replace("dd","d"),t=t.replace("tt","a")),r=t.replace("yyyy","yy"),i=n.standard["/"],s=[t,r,t.replace(new RegExp(i,"g"),"-"),r.replace(new RegExp(i,"g"),"-"),t.replace(new RegExp(i,"g"),"."),r.replace(new RegExp(i,"g"),".")],o=Globalize.parseDate(e,s,this._getCulture()),o?o:(o=new Date(e),o.toString()!=="Invalid Date"&&e&&e!==""?o:0)},i.prototype._formatDate=function(e,t,n){var i=this;if(!e.valueOf())return"&nbsp;";var s=this.inputWidget._getCulture().calendars.standard,o=t.replace(new RegExp("yyyy|MMMM|MMM|MM|M|mm|m|dddd|ddd|dd|d|hh|h|HH|H|ss|s|tt|t|a/p","gi"),function(t){var o;switch(t){case"yyyy":return r(e.getFullYear(),4);case"MMMM":return n.dateTimeFormat.monthNames[e.getMonth()];case"MMM":return n.dateTimeFormat.abbreviatedMonthNames[e.getMonth()];case"MM":return i.paddingZero(e.getMonth()+1,2);case"M":return i.paddingZero(e.getMonth()+1,1);case"mm":return i.paddingZero(e.getMinutes(),2);case"m":return i.paddingZero(e.getMinutes(),1);case"dddd":return n.dateTimeFormat.dayNames[e.getDay()];case"ddd":return n.dateTimeFormat.abbreviatedDayNames[e.getDay()];case"dd":return i.paddingZero(e.getDate(),2);case"d":return i.paddingZero(e.getDate(),1);case"hh":return o=e.getHours()%12,i.paddingZero(o?o:12,2);case"h":return o=e.getHours()%12,i.paddingZero(o?o:12,1);case"HH":return i.paddingZero(e.getHours(),2);case"H":return i.paddingZero(e.getHours(),1);case"ss":return i.paddingZero(e.getSeconds(),2);case"s":return i.paddingZero(e.getSeconds(),1);case"tt":return e.getHours()<12?s.AM[0]:s.PM[0];case"t":return e.getHours()<12?s.AM[0].length>0?s.AM[0].charAt(0):"":s.PM[0].length>0?s.PM[0].charAt(0):"";case"a/p":return e.getHours()<12?"a":"p"}return"N"});return o},i}(e.wijTextProvider);e.wijDateTextProvider=o,function(e){e._map=[],e.liternal=-1,e.OneDigitYear=1,e.TwoDigitYear=2,e.FourDigitYear=10,e.TwoDigitMonth=20,e.Month=25,e.AbbreviatedMonthNames=26,e.MonthNames=27,e.TwoDigityDayOfMonth=30,e.DayOfMonth=31,e.AbbreviatedDayNames=100,e.DayNames=101,e.h=45,e.hh=46,e.H=47,e.HH=48,e.ShortAmPm=250,e.AmPm=251,e.mm=50,e.m=51,e.ss=60,e.s=61}(e.DescriptorType||(e.DescriptorType={}));var u=e.DescriptorType,a=function(){function e(e,t){this.id=t,this.startIndex=0,this.name=null,this.type=u.liternal,this.maxLen=2,this._txtProvider=e,this.startIndex=0}return e.prototype.getText=function(){return null},e.prototype.setText=function(e,t,n){return!1},e.prototype.inc=function(){},e.prototype.dec=function(){},e.prototype.needAdjustInsertPos=function(){return!0},e.prototype.reachMaxLen=function(){var e=this.getText();do{if(e.charAt(0)!=="0")break;e=e.slice(1)}while(e.length>0);return e.length>=this.maxLen},e}();e._iDateDescriptor=a;var f=function(e){function t(t,n){e.call(this,t,n),this.liternal="",this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){return this.liternal},t}(a),l=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setMonth(this._txtProvider.getMonth()+1,!0)},t.prototype.dec=function(){this._txtProvider.setMonth(this._txtProvider.getMonth()-1,!0)},t.prototype.setText=function(e,t,n){return this._txtProvider.setMonth(e,t,n)},t}(a),c=function(e){function t(t,n){e.call(this,t,n),this.name="Two-digit month",this.type=u.TwoDigitMonth}return __extends(t,e),t.prototype.getText=function(){var e=""+this._txtProvider.getMonth()+"";return e.length===1?"0"+e:e},t}(l),h=function(e){function t(t,n){e.call(this,t,n),this.name="month",this.type=u.Month}return __extends(t,e),t.prototype.getText=function(){var e=""+this._txtProvider.getMonth()+"";return e},t}(l),p=function(e){function t(t,n){e.call(this,t,n),this.name="AbbreviatedMonthNames",this.type=u.AbbreviatedMonthNames,this.maxLen=u.AbbreviatedMonthNames}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getMonth(),t=this._txtProvider._getCulture();return t.calendars.standard.months.namesAbbr[e-1]},t.prototype.setText=function(e,t,n){var r=-1,i=this._txtProvider.inputWidget._getCulture().calendars.standard;return r=this._txtProvider.findAlikeArrayItemIndex(i.months.namesAbbr,e),r===-1?!1:this._txtProvider.setMonth(r+1,t,n)},t}(l),d=function(e){function t(t,n){e.call(this,t,n),this.name="MonthNames",this.type=u.MonthNames,this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getMonth(),t=this._txtProvider._getCulture();return t.calendars.standard.months.names[e-1]},t.prototype.setText=function(e,t,n){var r=-1,i;if(n&&n.isfullreset)r=1;else{i=this._txtProvider._getCulture(),r=this._txtProvider.findAlikeArrayItemIndex(i.calendars.standard.months.names,e);if(r===-1)return!1}return this._txtProvider.setMonth(r+1,t,n)},t}(l),v=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()+1,!0)},t.prototype.dec=function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()-1,!0)},t.prototype.setText=function(e,t,n){return this._txtProvider.setDayOfMonth(e,t,n)},t}(a),m=function(e){function t(t,n){e.call(this,t,n),this.name="Two-digit day of month",this.type=u.TwoDigityDayOfMonth}return __extends(t,e),t.prototype.getText=function(){return r(this._txtProvider.getDayOfMonth())},t}(v),g=function(e){function t(t,n){e.call(this,t,n),this.name="Day of month",this.type=u.DayOfMonth}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getDayOfMonth();return""+e+""},t}(v),y=function(e){function t(t,n){e.call(this,t,n),this.name="AbbreviatedDayNames",this.type=u.AbbreviatedDayNames,this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getDayOfWeek(),t=this._txtProvider._getCulture();return t.calendars.standard.days.namesShort[e-1]},t.prototype.setText=function(e,t,n){var r=-1,i=this._txtProvider._getCulture();return r=this._txtProvider.findAlikeArrayItemIndex(i.calendars.standard.days.namesShort,e),r===-1?!1:this._txtProvider.setDayOfWeek(r+1)},t.prototype.needAdjustInsertPos=function(){return!1},t}(v),b=function(e){function t(t,n){e.call(this,t,n),this.name="DayNames",this.type=u.DayNames,this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getDayOfWeek(),t=this._txtProvider._getCulture();return t.calendars.standard.days.names[e-1]},t.prototype.setText=function(e,t,n){var r=-1,i=this._txtProvider._getCulture();return r=this._txtProvider.findAlikeArrayItemIndex(i.calendars.standard.days.names,e),r===-1?!1:this._txtProvider.setDayOfWeek(r+1)},t.prototype.needAdjustInsertPos=function(){return!1},t}(v),w=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setYear(this._txtProvider.getYear()+1,null,!0)},t.prototype.dec=function(){this._txtProvider.setYear(this._txtProvider.getYear()-1,null,!0)},t}(a),E=function(e){function t(t,n){e.call(this,t,n),this.name="Four-digit year",this.type=u.FourDigitYear,this.maxLen=4}return __extends(t,e),t.prototype.getText=function(){return r(this._txtProvider.getYear(),4)},t.prototype.setText=function(e,t,n){if(this._txtProvider._isSmartInputMode()&&n){var r=2e3,i,s,o,u,a,f,l,c;this._txtProvider.inputWidget.options.startYear&&(r=this._txtProvider.inputWidget.options.startYear),s=r+100-1,i=this._txtProvider.paddingZero(r,4),s=this._txtProvider.paddingZero(s,4);if(n.pos===0||n.pos===1){o=new Date,u=this._txtProvider.paddingZero(this._txtProvider.getYear(),4);if(u.charAt(0)==="0"&&u.charAt(1)==="0"&&n.pos<=1)return a=n.val,f="00",a>=5?f=i.slice(0,2):f=s.slice(0,2),l=n.val+u.slice(3,4),c=f+l,n.offset=2-n.pos,this._txtProvider.setYear(c,n),!0}}return this._txtProvider.setYear(e,n)},t}(w),S=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.setText=function(e,t,n){e=r(e);var i=r(this._txtProvider.getYear(),4),s,o,u,a,f;return e==="00"&&(s=this._txtProvider.getMonth(),o=this._txtProvider.getDayOfMonth(),u=this._txtProvider.getHours(),a=this._txtProvider.getMinutes(),f=this._txtProvider.getSeconds(),s===1&&o===1&&!u&&!a&&!f&&(i="0001",e="01")),i.length>=2&&(i=i.substr(0,2)+e.substr(0,2)),this._txtProvider.setYear(i,n)},t}(w),x=function(e){function t(t,n){e.call(this,t,n),this.name="One-digit year",this.type=u.OneDigitYear}return __extends(t,e),t.prototype.getText=function(){var e=r(this._txtProvider.getYear());return e[0]==="0"&&(e=e[1]),e},t}(S),T=function(e){function t(t,n){e.call(this,t,n),this.name="Two-digit year",this.type=u.TwoDigitYear}return __extends(t,e),t.prototype.getText=function(){return r(this._txtProvider.getYear(),2)},t}(S),N=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setHours(this._txtProvider.getHours()+1,!0)},t.prototype.dec=function(){this._txtProvider.setHours(this._txtProvider.getHours()-1,!0)},t}(a),C=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.setText=function(e,t,n){var r=this._txtProvider.getHours();return r>12&&(e=e*1+12),this._txtProvider.setHours(e,t)},t}(N),k=function(e){function t(t,n){e.call(this,t,n),this.name="h",this.type=u.h}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours();return e>12?e-=12:e===0&&(e=12),""+e+""},t}(C),L=function(e){function t(t,n){e.call(this,t,n),this.name="hh",this.type=u.hh}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours();if(e>12)e-=12;else if(e===0)return"12";return r(e)},t}(C),A=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.setText=function(e,t,n){return this._txtProvider.setHours(e,t)},t}(N),O=function(e){function t(t,n){e.call(this,t,n),this.name="H",this.type=u.H}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours();return""+e+""},t}(A),M=function(e){function t(t,n){e.call(this,t,n),this.name="HH",this.type=u.HH}return __extends(t,e),t.prototype.getText=function(){return r(this._txtProvider.getHours())},t}(A),_=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){var e=(this._txtProvider.getHours()+12)%24;this._txtProvider.setHours(e,!0)},t.prototype.dec=function(){var e=(this._txtProvider.getHours()+12)%24;this._txtProvider.setHours(e,!0)},t.prototype.setText=function(e,t,n){var r;return e.toLowerCase().indexOf("a")>=0?(r=this._txtProvider.getHours()%12,this._txtProvider.setHours(r,!0)):e.toLowerCase().indexOf("p")>=0&&(r=this._txtProvider.getHours()%12+12,this._txtProvider.setHours(r,!0)),!0},t}(a),D=function(e){function t(t,n){e.call(this,t,n),this.name="t",this.type=u.ShortAmPm}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours(),t=this._txtProvider._getCulture(),n=t.calendars.standard[e<12?"AM":"PM"][0];return n.charAt(0)||" "},t}(_),P=function(e){function t(t,n){e.call(this,t,n),this.name="tt",this.type=u.AmPm}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours(),t="",n=this._txtProvider._getCulture();return e<12?t=n.calendars.standard.AM[0]:t=n.calendars.standard.PM[0],t.length<=0&&(t=" "),t},t}(_),H=function(e){function t(t,n){e.call(this,t,n),this.delta=1}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()+this.delta,!0)},t.prototype.dec=function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()-this.delta,!0)},t.prototype.setText=function(e,t,n){return n&&n.isfullreset&&(e="0"),this._txtProvider.setMinutes(e,t)},t}(a),B=function(e){function t(t,n){e.call(this,t,n),this.name="mm",this.type=u.mm}return __extends(t,e),t.prototype.getText=function(){return r(this._txtProvider.getMinutes())},t}(H),j=function(e){function t(t,n){e.call(this,t,n),this.name="m",this.type=u.m,this.delta=12}return __extends(t,e),t.prototype.getText=function(){return this._txtProvider.getMinutes().toString()},t}(H),F=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()+12,!0)},t.prototype.dec=function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()-12,!0)},t.prototype.setText=function(e,t,n){return n&&n.isfullreset&&(e="0"),this._txtProvider.setSeconds(e,t)},t}(a),I=function(e){function t(t,n){e.call(this,t,n),this.name="ss",this.type=u.ss}return __extends(t,e),t.prototype.getText=function(){return r(this._txtProvider.getSeconds())},t}(F),q=function(e){function t(t,n){e.call(this,t,n),this.name="s",this.type=u.s}return __extends(t,e),t.prototype.getText=function(){return this._txtProvider.getSeconds().toString()},t}(F)})(wijmo||(wijmo={}));