var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){"use strict";var t=jQuery,n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._create=function(){var e=this;if(this.element.is(":hidden")&&this.element.wijAddVisibilityObserver){this.element.wijAddVisibilityObserver(function(){e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver(),e._pageLize(!0)},"wijwizard");return}this._pageLize(!0)},n.prototype._init=function(){var e=this.options,t=e.disabled;e.disabledState?(this.disable(),e.disabled=t):e.autoPlay&&this.play()},n.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);switch(t){case"activeIndex":this.show(n);break;case"navButtons":this._createButtons();break;default:this._pageLize(!1)}},n.prototype.destroy=function(){var e=this.options;return this.abort(),this.stop(),this._removeScroller(),this._removeButtons(),this.element.unbind(".wijwizard").removeClass(e.wijCSS.wijwizard).removeClass(e.wijCSS.widget).removeClass(e.wijCSS.helperClearFix).removeData("wijwizard"),this.list&&this.list.removeClass(e.wijCSS.widget).removeClass(e.wijCSS.helperReset).removeClass(e.wijCSS.wijwizardSteps).removeClass(e.wijCSS.helperClearFix).removeAttr("role"),this.lis&&(this.lis.removeClass(e.wijCSS.header).removeClass(e.wijCSS.cornerAll).removeClass(e.wijCSS.priorityPrimary).removeClass(e.wijCSS.prioritySecondary).removeAttr("role"),t.each(this.lis,function(){t.data(this,"destroy.wijwizard")?t(this).remove():t(this).removeAttr("aria-selected")})),t.each(this.panels,function(){var n=t(this).unbind(".wijwizard");t.each(["load","cache"],function(e,t){n.removeData(t+".wijwizard")}),t.data(this,"destroy.wijwizard")?n.remove():n.removeClass(e.wijCSS.stateDefault).removeClass(e.wijCSS.wijwizardActived).removeClass(e.wijCSS.stateActive).removeClass(e.wijCSS.stateHover).removeClass(e.wijCSS.stateFocus).removeClass(e.wijCSS.stateDisabled).removeClass(e.wijCSS.wijwizardPanel).removeClass(e.wijCSS.content).removeClass(e.wijCSS.wijwizardHide).css({position:"",left:"",top:""}).removeAttr("aria-hidden")}),this.container.replaceWith(this.container.contents()),e.cookie&&this._cookie(null,e.cookie),this},n.prototype._pageLize=function(e){var n=this.options,r=/^#.+/;this.list=this.element.children("ol,ul").eq(0),this.list&&this.list.length===0&&(this.list=this.element.find("."+n.wijCSS.wijwizardSteps).eq(0),this.list&&this.list.length===0&&(this.list=null)),this.list&&(this.lis=t("li",this.list)),e?(this.panels=t("> div",this.element),t.each(this.panels,function(e,n){var i=t(n).attr("src");i&&!r.test(i)&&t.data(n,"load.wijwizard",i.replace(/#.*$/,""))}),this.element.addClass(n.wijCSS.wijwizard).addClass(n.wijCSS.widget).addClass(n.wijCSS.helperClearFix),this.list&&(this.list.addClass(n.wijCSS.widget).addClass(n.wijCSS.helperReset).addClass(n.wijCSS.wijwizardSteps).addClass(n.wijCSS.helperClearFix).attr("role","tablist"),this.lis.addClass(n.wijCSS.header).addClass(n.wijCSS.cornerAll).attr("role","tab")),this.container=t("<div/>"),this.container.addClass(n.wijCSS.wijwizardContent).addClass(n.wijCSS.widget).addClass(n.wijCSS.content).addClass(n.wijCSS.cornerAll),this.container.append(this.panels),this.container.appendTo(this.element),this.panels.addClass(n.wijCSS.wijwizardPanel).addClass(n.wijCSS.content).attr("role","tabpanel"),n.activeIndex===undefined?(typeof n.activeIndex!="number"&&n.cookie&&(n.activeIndex=parseInt(this._cookie(undefined,undefined),10)),typeof n.activeIndex!="number"&&this.panels.filter("."+n.wijCSS.wijwizardActived).length&&(n.activeIndex=this.panels.index(this.panels.filter("."+n.wijCSS.wijwizardActived))),n.activeIndex=n.activeIndex||(this.panels.length?0:-1)):n.activeIndex===null&&(n.activeIndex=-1),n.activeIndex=n.activeIndex>=0&&this.panels[n.activeIndex]||n.activeIndex<0?n.activeIndex:0,this.panels.addClass(n.wijCSS.wijwizardHide).attr("aria-hidden",!0),n.activeIndex>=0&&this.panels.length&&(this.panels.eq(n.activeIndex).removeClass(n.wijCSS.wijwizardHide).addClass(n.wijCSS.wijwizardActived).attr("aria-hidden",!1),this.load(n.activeIndex)),this._createButtons()):(this.panels=t("> div",this.container),n.activeIndex=this.panels.index(this.panels.filter("."+n.wijCSS.wijwizardActived))),this._refreshStep(),this._initScroller(),n.cookie&&this._cookie(n.activeIndex,n.cookie),n.cache===!1&&this.panels.removeData("cache.wijwizard");if(n.showOption===undefined||n.showOption===null)n.showOption={};this._normalizeBlindOption(n.showOption);if(n.hideOption===undefined||n.hideOption===null)n.hideOption={};this._normalizeBlindOption(n.hideOption),this.panels.unbind(".wijwizard")},n.prototype._removeButtons=function(){this.buttons&&(this.buttons.remove(),this.buttons=undefined)},n.prototype._createButtons=function(){var e=this,n=this,r=this.options,i,s,o,u=r.backBtnText,a=r.nextBtnText;this._removeButtons();if(r.navButtons==="none")return;this.buttons||(i=r.navButtons,i==="auto"&&(i=this.list?"common":"edge"),this.buttons=t("<div/>"),this.buttons.addClass(r.wijCSS.wijwizardButtons),s=function(e,t){if(r.disabled)return;t.is(":not(."+r.wijCSS.stateDisabled+")")&&t.addClass(e)},o=function(e,t){if(r.disabled)return;t.removeClass(e)},i==="common"?(this.backBtn=t("<a href='#'><span class='"+r.wijCSS.buttonText+"'>"+u+"</span></a>").addClass(r.wijCSS.widget).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerAll).addClass(r.wijCSS.button).addClass(r.wijCSS.buttonTextOnly).appendTo(this.buttons).bind({click:function(){return e.back(),!1},mouseover:function(){s(r.wijCSS.stateHover,t(this))},mouseout:function(){o(r.wijCSS.stateHover,t(this))},mousedown:function(){s(r.wijCSS.stateActive,t(this))},mouseup:function(){o(r.wijCSS.stateActive,t(this))}}).attr("role","button"),this.nextBtn=t("<a href='#'><span class='"+r.wijCSS.buttonText+"'>"+a+"</span></a>").addClass(r.wijCSS.widget).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerAll).addClass(r.wijCSS.button).addClass(r.wijCSS.buttonTextOnly).appendTo(this.buttons).bind({click:function(){return n.next(),!1},mouseover:function(){s(r.wijCSS.stateHover,t(this))},mouseout:function(){o(r.wijCSS.stateHover,t(this))},mousedown:function(){s(r.wijCSS.stateActive,t(this))},mouseup:function(){o(r.wijCSS.stateActive,t(this))}}).attr("role","button")):(this.backBtn=t("<a href='#'/>").addClass(r.wijCSS.wijwizardPrev).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerRight).append("<span class='"+r.wijCSS.icon+" "+r.wijCSS.iconArrowLeft+"'></span>").appendTo(this.buttons).bind({click:function(){return n.back(),!1},mouseover:function(){s(r.wijCSS.stateHover,t(this))},mouseout:function(){o(r.wijCSS.stateHover,t(this))},mousedown:function(){s(r.wijCSS.stateActive,t(this))},mouseup:function(){o(r.wijCSS.stateActive,t(this))}}).attr("role","button"),this.nextBtn=t("<a href='#'/>").addClass(r.wijCSS.wijwizardNext).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerLeft).append("<span class='"+r.wijCSS.icon+" "+r.wijCSS.iconArrowRight+"'></span>").appendTo(this.buttons).bind({click:function(){return n.next(),!1},mouseover:function(){s(r.wijCSS.stateHover,t(this))},mouseout:function(){o(r.wijCSS.stateHover,t(this))},mousedown:function(){s(r.wijCSS.stateActive,t(this))},mouseup:function(){o(r.wijCSS.stateActive,t(this))}}).attr("role","button")),this.buttons.appendTo(this.element))},n.prototype._refreshStep=function(){var e=this.options;this.lis&&(this.lis.removeClass(e.wijCSS.priorityPrimary).addClass(e.wijCSS.prioritySecondary).attr("aria-selected",!1),e.activeIndex>=0&&e.activeIndex<=this.lis.length-1&&(this.lis&&this.lis.eq(e.activeIndex).removeClass(e.wijCSS.prioritySecondary).addClass(e.wijCSS.priorityPrimary).attr("aria-selected",!0),this.scrollWrap&&this.scrollWrap.wijsuperpanel("scrollChildIntoView",this.lis.eq(e.activeIndex)))),this.buttons&&!e.loop&&(this.backBtn[e.activeIndex<=0?"addClass":"removeClass"](e.wijCSS.stateDisabled).attr("aria-disabled",e.activeIndex===0),this.nextBtn[e.activeIndex>=this.panels.length-1?"addClass":"removeClass"](e.wijCSS.stateDisabled).attr("aria-disabled",e.activeIndex>=this.panels.length-1))},n.prototype._initScroller=function(){if(!this.lis)return;var e=0;t.each(this.lis,function(){e+=t(this).outerWidth(!0)}),this.element.innerWidth()<e?(this.scrollWrap===undefined&&(this.list.wrap("<div class='scrollWrap'></div>"),this.scrollWrap=this.list.parent(),t.effects&&t.effects.save?t.effects.save(this.list,["width","height","overflow"]):t.save&&t.save(this.list,["width","height","overflow"])),this.list.width(e+8),this.scrollWrap.height(this.list.outerHeight(!0)),this.scrollWrap.wijsuperpanel({allowResize:!1,hScroller:{scrollBarVisibility:"hidden"},vScroller:{scrollBarVisibility:"hidden"}})):this._removeScroller()},n.prototype._removeScroller=function(){this.scrollWrap&&(this.scrollWrap.wijsuperpanel("destroy").replaceWith(this.scrollWrap.contents()),this.scrollWrap=undefined,t.effects&&t.effects.restore?t.effects.restore(this.list,["width","height","overflow"]):t.restore&&t.restore(this.list,["width","height","overflow"]))},n.prototype._cookie=function(e,n){var r=this.cookie||(this.cookie=this.options.cookie.name);return t.cookie.apply(null,[r].concat(t.makeArray(arguments)))},n.prototype._normalizeBlindOption=function(e){e.blind===undefined&&(e.blind=!1),e.fade===undefined&&(e.fade=!1),e.duration===undefined&&(e.duration=200);if(typeof e.duration=="string")try{e.duration=parseInt(e.duration,10)}catch(t){e.duration=200}},n.prototype._ui=function(e){return{panel:e,index:this.panels.index(e)}},n.prototype._removeSpinner=function(){this.element.removeClass(this.options.wijCSS.tabsLoading);var e=this.element.data("spinner.wijwizard");e&&(this.element.removeData("spinner.wijwizard"),e.remove())},n.prototype._showPanel=function(e){var n=this,r=this.options,i=t(e),s;i.addClass(r.wijCSS.wijwizardActived),(r.showOption.blind||r.showOption.fade)&&r.showOption.duration>0?(s={duration:r.showOption.duration},r.showOption.blind&&(s.height="toggle"),r.showOption.fade&&(s.opacity="toggle"),i.hide().removeClass(r.wijCSS.wijwizardHide).animate(s,r.showOption.duration||"normal","linear",function(){n._resetStyle(i),i.wijTriggerVisibility&&i.wijTriggerVisibility(),n._trigger("show",null,n._ui(i[0])),n._removeSpinner(),i.attr("aria-hidden",!1),n._trigger("activeIndexChanged",null,n._ui(i[0]))})):(i.removeClass(r.wijCSS.wijwizardHide).attr("aria-hidden",!1),i.wijTriggerVisibility&&i.wijTriggerVisibility(),this._trigger("show",null,this._ui(i[0])),this._removeSpinner(),this._trigger("activeIndexChanged",null,this._ui(i[0])))},n.prototype._hidePanel=function(e){var n=this,r=this,i=this.options,s=t(e),o;s.removeClass(i.wijCSS.wijwizardActived),(i.hideOption.blind||i.hideOption.fade)&&i.hideOption.duration>0?(o={duration:i.hideOption.duration},i.hideOption.blind&&(o.height="toggle"),i.hideOption.fade&&(o.opacity="toggle"),s.animate(o,i.hideOption.duration||"normal","linear",function(){s.addClass(i.wijCSS.wijwizardHide).attr("aria-hidden",!0),n._resetStyle(s),n.element.dequeue("wijwizard")})):(s.addClass(i.wijCSS.wijwizardHide).attr("aria-hidden",!0),this.element.dequeue("wijwizard"))},n.prototype._resetStyle=function(e){e.css({display:""}),t.support.opacity||e[0].style.removeAttribute("filter")},n.prototype.add=function(e,n,r){e===undefined&&(e=this.panels.length),n===undefined&&(n="Step "+e);var i=this,s=this.options,o=t(s.panelTemplate||i._defaults.panelTemplate).data("destroy.wijwizard",!0),u;return o.addClass(s.wijCSS.wijwizardPanel).addClass(s.wijCSS.content).addClass(s.wijCSS.cornerAll).addClass(s.wijCSS.wijwizardHide).attr("aria-hidden",!0),e>=this.panels.length?this.panels.length>0?o.insertAfter(this.panels[this.panels.length-1]):o.appendTo(this.container):o.insertBefore(this.panels[e]),this.list&&this.lis&&(u=t((s.stepHeaderTemplate||i._defaults.stepHeaderTemplate).replace(/#\{title\}/g,n).replace(/#\{desc\}/g,r)),u.addClass(s.wijCSS.header).addClass(s.wijCSS.cornerAll).addClass(s.wijCSS.prioritySecondary).data("destroy.wijwizard",!0),e>=this.lis.length?u.appendTo(this.list):u.insertBefore(this.lis[e])),this._pageLize(!1),this.panels.length===1&&(s.activeIndex=0,u.addClass(s.wijCSS.priorityPrimary),o.removeClass(s.wijCSS.wijwizardHide).addClass(s.wijCSS.wijwizardActived).attr("aria-hidden",!1),this.element.queue("wijwizard",function(){i._trigger("show",null,i._ui(i.panels[0]))}),this._refreshStep(),this.load(0)),this._trigger("add",null,this._ui(this.panels[e])),this},n.prototype.remove=function(e){var t=this.options,n=this.panels.eq(e).remove();return this.lis.eq(e).remove(),e<t.activeIndex&&t.activeIndex--,this._pageLize(!1),n.hasClass(t.wijCSS.wijwizardActived)&&this.panels.length>=1&&this.show(e+(e<this.panels.length?0:-1)),this._trigger("remove",null,this._ui(n[0])),this},n.prototype.show=function(e){var n=this;if(e<0||e>=this.panels.length)return this;if(this.element.queue("wijwizard").length>0)return this;var r=this.options,i={nextIndex:0,nextPanel:null},s,o;t.extend(i,this._ui(this.panels[r.activeIndex])),i.nextIndex=e,i.nextPanel=this.panels[e];if(this._trigger("validating",null,i)===!1)return this;s=this.panels.filter(":not(."+r.wijCSS.wijwizardHide+")"),o=this.panels.eq(e),r.activeIndex=e,this.abort(),r.cookie&&this._cookie(r.activeIndex,r.cookie),this._refreshStep();if(!o.length)throw"jQuery UI wijwizard: Mismatching fragment identifier.";return s.length&&this.element.queue("wijwizard",function(){n._hidePanel(s)}),this.element.queue("wijwizard",function(){n._showPanel(o)}),this.load(e),this},n.prototype.next=function(){var e=this.options,t=e.activeIndex+1;return e.disabled?!1:(e.loop&&(t%=this.panels.length),t<this.panels.length?(this.show(t),!0):!1)},n.prototype.back=function(){var e=this.options,t=e.activeIndex-1;return e.disabled?!1:(e.loop&&(t=t<0?this.panels.length-1:t),t>=0?(this.show(t),!0):!1)},n.prototype.load=function(e){var n=this,r=n.options,i=n.panels.eq(e)[0],s=t.data(i,"load.wijwizard"),o;n.abort();if(!s||n.element.queue("wijwizard").length!==0&&t.data(i,"cache.wijwizard")){n.element.dequeue("wijwizard");return}return this.element.addClass(r.wijCSS.tabsLoading),r.spinner&&(o=this.element.data("spinner.wijwizard"),o||(o=t("<div/>"),o.addClass(r.wijCSS.wijwizardSpinner),o.html(r.spinner||n._defaults.spinner),o.appendTo(document.body),this.element.data("spinner.wijwizard",o),o.wijpopup({showEffect:"blind",hideEffect:"blind"})),o.wijpopup("show",{of:this.element,my:"center center",at:"center center"})),this.xhr=t.ajax(t.extend({},r.ajaxOptions,{url:s,dataType:"html",success:function(s,o){t(i).html(s),r.cache&&t.data(i,"cache.wijwizard",!0),n._trigger("load",null,n._ui(n.panels[e]));try{r.ajaxOptions&&r.ajaxOptions.success&&r.ajaxOptions.success(s,o)}catch(u){}},error:function(t,s,o){n._trigger("load",null,n._ui(n.panels[e]));try{r.ajaxOptions&&r.ajaxOptions.error&&r.ajaxOptions.error(t,s,e,i)}catch(u){}}})),n.element.dequeue("wijwizard"),n},n.prototype.abort=function(){return this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("wijwizard",this.element.queue("wijwizard").splice(-2,2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._removeSpinner(),this},n.prototype.url=function(e,t){return this.panels.eq(e).removeData("cache.wijwizard").data("load.wijwizard",t),this},n.prototype.count=function(){return this.panels.length},n.prototype.stop=function(){var e=this.element.data("intId.wijwizard");e&&(window.clearInterval(e),this.element.removeData("intId.wijwizard"))},n.prototype.play=function(){var e=this,t=this.options,n,r=this.panels.length;this.element.data("intId.wijwizard")||(n=window.setInterval(function(){var n=t.activeIndex+1;if(n>=r){if(!t.loop){e.stop();return}n=0}e.show(n)},t.delay),this.element.data("intId.wijwizard",n))},n}(e.wijmoWidget);e.wijwizard=n,n.prototype._defaults={stepHeaderTemplate:"<li><h1>#{title}</h1>#{desc}</li>",panelTemplate:"<div></div>",spinner:"<em>Loading&#8230;</em>"},n.prototype.options=t.extend(!0,{},e.wijmoWidget.prototype.options,{wijCSS:{wijwizard:"wijmo-wijwizard",wijwizardButtons:"wijmo-wijwizard-buttons",wijwizardPrev:"wijmo-wijwizard-prev",wijwizardNext:"wijmo-wijwizard-next",wijwizardSteps:"wijmo-wijwizard-steps",wijwizardContent:"wijmo-wijwizard-content",wijwizardPanel:"wijmo-wijwizard-panel",wijwizardActived:"wijmo-wijwizard-actived",wijwizardHide:"wijmo-wijwizard-hide",wijwizardSpinner:"wijmo-wijwizard-spinner"},wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-a"},navButtons:"auto",autoPlay:!1,delay:3e3,loop:!1,hideOption:{fade:!0},showOption:{fade:!0,duration:400},ajaxOptions:null,cache:!1,cookie:null,stepHeaderTemplate:"",panelTemplate:"",spinner:"",backBtnText:"back",nextBtnText:"next",add:null,remove:null,activeIndexChanged:null,show:null,load:null,validating:null}),t.wijmo.registerWidget("wijwizard",n.prototype)})(wijmo||(wijmo={}));