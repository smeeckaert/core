var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){"use strict";var t=jQuery,n="wijtooltip",r="@wijtp@",i="wijmo-wijtooltip",s=i+"-arrow-",o=parseFloat,u=window,a=document,f=Math,l=f.max,c={},h=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n._tooltips=new Array,n.prototype._setOption=function(n,r){var i=this,s="_set_"+n,o=i.options[n];e.prototype._setOption.call(this,n,r),t.isPlainObject(r)&&(i.options[n]=t.extend({},o,r)),i[s]&&i[s](o)},n.prototype._set_cssClass=function(){var e=this,t=e.options,n=e._tooltipCache._$tooltip;if(!n)return;n.hasClass(t.cssClass)||n.addClass(t.cssClass)},n.prototype._set_content=function(e){var t=this;t._isAjaxCallback?(t._callbacked=!0,t.show(),t._callbacked=!1):t._setText()},n.prototype._create=function(){var e=this,i=e.options,s=e.element,o=s&&s.attr("id"),u="",a="",f=i.group||r,l=n._getTooltip(f);window.wijmoApplyWijTouchUtilEvents&&(t=window.wijmoApplyWijTouchUtilEvents(t)),l?l.count++:(l=e._createTooltip(),l.count=0,n._tooltips[f]=l),a=i.cssClass?i.cssClass:"",l._$tooltip.hasClass(a)||l._$tooltip.addClass(a),i.position.of=e.element,e._bindLiveEvents(),e._tooltipCache=l,o!==""&&(u=l._$tooltip.attr("aria-describedby"),u=u===undefined?"":u+" ",l._$tooltip.attr("aria-describedby",u+o))},n.prototype.destroy=function(){var t=this,i=t.element,s=t.options.group||r;i.unbind(".tooltip"),i.attr("title",t._content),n._removeTooltip(s),e.prototype.destroy.call(this)},n.prototype.widget=function(){return this._tooltipCache._$tooltip},n.prototype.show=function(){var e=this,n=e._tooltipCache,r=n?n._$tooltip:null,i=e.options;if(!n||i.disabled)return;n._showAnimationTimer&&(clearTimeout(n._showAnimationTimer),n._showAnimationTimer=null),n._showAtAnimationTimer&&(clearTimeout(n._showAtAnimationTimer),n._showAtAnimationTimer=null),n._hideAnimationTimer&&(clearTimeout(n._hideAnimationTimer),n._hideAnimationTimer=null),r.stop(!0,!0);if(i.ajaxCallback&&t.isFunction(i.ajaxCallback)&&!e._callbacked){e._isAjaxCallback=!0,i.ajaxCallback.call(e.element);return}e._setText(),n._showAnimationTimer=setTimeout(function(){c=r.offset();if(i.mouseTrailing){e._setCalloutCss();return}e._setPosition(),e._showTooltip()},e.options.showDelay)},n.prototype.showAt=function(e){var t=this,n=t._tooltipCache,r=n?n._$tooltip:null,i=n?n._callout:null,s,o=0,u=0,a={},f,l,h,p,d,v;if(!n||!i)return;r.stop(!0,!0),n._showAtAnimationTimer&&(clearTimeout(n._showAtAnimationTimer),n._showAtAnimationTimer=null),n._hideAnimationTimer&&(clearTimeout(n._hideAnimationTimer),n._hideAnimationTimer=null),n._showAtAnimationTimer=setTimeout(function(){var n=r.is(":visible");t._setText(),c=r.offset(),r.offset({left:0,top:0}).show(),s=i.position(),o=s.left,u=s.top,l=t._getBorder(i),h=l.left||l.right,p=l.top||l.bottom,d=r.width(),v=r.height(),f=t._getCalloutShape(),a={rt:{left:e.x-d-h,top:e.y-u},rc:{left:e.x-d-h,top:e.y-v/2},rb:{left:e.x-d-h,top:e.y-u-p},lt:{left:e.x+h,top:e.y-u},lc:{left:e.x+h,top:e.y-v/2},lb:{left:e.x+h,top:e.y-u-p},tl:{left:e.x-o,top:e.y+p},tc:{left:e.x-d/2,top:e.y+p},tr:{left:e.x-o-h,top:e.y+p},bl:{left:e.x-o,top:e.y-v-p},bc:{left:e.x-d/2,top:e.y-v-p},br:{left:e.x-o-h,top:e.y-v-p},cc:{left:e.x-d/2,top:e.y-v/2}}[f],f=t._flipTooltip(a,f,l),t._setUnfilledCallout(f),r.offset(a),n||r.hide(),t._calloutShape=f,t._showTooltip()},t.options.showDelay)},n.prototype.hide=function(){var e=this,n=e._tooltipCache;if(!n)return;n._showAnimationTimer&&(clearTimeout(n._showAnimationTimer),n._showAnimationTimer=null),n._showAtAnimationTimer&&(clearTimeout(n._showAtAnimationTimer),n._showAtAnimationTimer=null),n._hideAnimationTimer&&(clearTimeout(n._hideAnimationTimer),n._hideAnimationTimer=null),n._hideAnimationTimer=setTimeout(t.proxy(e._hideTooltip,e),e.options.hideDelay)},n.prototype._createTooltip=function(){var e=this,n=e.options,r=new TooltipCache,i=t("<div></div>").addClass(n.wijCSS.tooltip).addClass(n.wijCSS.widget).addClass(n.wijCSS.content).addClass(n.wijCSS.cornerAll),s=t("<div></div>").addClass(n.wijCSS.tooltipContainer),o=t("<div></div>").addClass(n.wijCSS.content).addClass(n.wijCSS.tooltipPointer).append(t("<div></div>").addClass(n.wijCSS.tooltipPointerInner)),u=t("<div></div>").addClass(n.wijCSS.tooltipTitle).addClass(n.wijCSS.header).addClass(n.wijCSS.cornerAll),a=t("<a href='#'></a>").addClass(n.wijCSS.tooltipClose).addClass(n.wijCSS.stateDefault).addClass(n.wijCSS.cornerAll);return a.append(t("<span></span>").addClass(n.wijCSS.icon).addClass(n.wijCSS.iconClose)).bind("click",t.proxy(e._onClickCloseBtn,e)),n.closeBehavior!=="sticky"&&a.hide(),n.showCallout||o.hide(),i.append(u).append(a).append(s).append(o).css("position","absolute").attr("role","tooltip").appendTo("body").hide(),r._$tooltip=i,r._container=s,r._callout=o,r._closeBtn=a,r._title=u,r},n.prototype._bindLiveEvents=function(){var e=this,n=e.options,r=e.element;e._content===undefined&&(e._content=r.attr("title"),r.attr("title","")),r.unbind(".tooltip"),n.mouseTrailing&&r.bind("mousemove.tooltip",function(t){if(n.disabled)return;var r=n.position.offset||"",i=r.split(" ");i.length===2?e.showAt({x:t.pageX+parseInt(i[0],10),y:t.pageY+parseInt(i[1],10)}):e.showAt({x:t.pageX,y:t.pageY})});switch(n.triggers){case"hover":r.bind("mouseover.tooltip",t.proxy(e.show,e)).bind("mouseout.tooltip",t.proxy(e._hideIfNeeded,e));break;case"click":r.bind("click.tooltip",t.proxy(e.show,e));break;case"focus":r.bind("focus.tooltip",t.proxy(e.show,e)).bind("blur.tooltip",t.proxy(e._hideIfNeeded,e));break;case"rightClick":r.bind("contextmenu.tooltip",function(t){e.show(),t.preventDefault()})}},n.prototype._hideIfNeeded=function(){var e=this,t=e.options,n=t.closeBehavior;if(n==="sticky"||t.modal||n==="none"||t.disabled)return;e.hide()},n.prototype._flipTooltip=function(e,t,n){var r=this,i=r._tooltipCache,s=i?i._$tooltip:null,o={width:s.width(),height:s.height()},u=r._flipCallout(e,o,t),a=u&&u.flip,f,l;return!i||!u||!a.h&&!a.v?u.calloutShape:(f=s.width(),l=s.height(),a.h==="l"?e.left-=f+n.right*2+1:a.h==="r"?e.left+=f+n.left*2+1:a.v==="t"?e.top-=l+n.bottom*2+1:a.v==="b"&&(e.top+=l+n.top*2+1),u.calloutShape)},n.prototype._flipCallout=function(e,n,r){var i=this,o=i.options,a=i._tooltipCache,f=a._$tooltip,l={h:!1,v:!1},c=t(u),h=(o.position.collision||"flip").split(" ");h.length===1&&(h[1]=h[0]);if(!a||h[0]!=="flip"&&h[1]!=="flip")return{flip:l,calloutShape:null};h[0]==="flip"&&(e.left<0||e.left+n.width>c.width()+c.scrollLeft())&&(l.h=!0),h[0]==="flip"&&(e.top<0||e.top+n.height>c.height()+c.scrollTop())&&(l.v=!0);if(o.showCallout){l.h&&(r.indexOf("l")>-1?(r=r.replace(/l/,"r"),l.h="l"):r.indexOf("r")>-1&&(r=r.replace(/r/,"l"),l.h="r")),l.v&&(r.indexOf("t")>-1?(r=r.replace(/t/,"b"),l.v="t"):r.indexOf("b")>-1&&(r=r.replace(/b/,"t"),l.v="b"));if(l.h||l.v)i._removeCalloutCss(),f.addClass(s+r)}return{flip:l,calloutShape:r}},n.prototype._set_position=function(e){var t=this,n=t.options,r=n.position;n.showCallout&&((e.my!==r.my||e.at!==r.at)&&t._setPosition(),t._setCalloutOffset(!0)),t._setText()},n.prototype._set_showCallout=function(){var e=this,t=e._tooltipCache,n=t?t._callout:null;if(!t||!n)return;e.options.showCallout?(e._setCalloutCss(),n.show()):n.hide()},n.prototype._set_closeBehavior=function(){var e=this,t=e._tooltipCache,n=t?t._closeBtn:null;n&&n[e.options.closeBehavior==="sticky"?"show":"hide"]()},n.prototype._set_triggers=function(){this._bindLiveEvents()},n.prototype._set_mouseTrailing=function(){this._bindLiveEvents()},n.prototype._getCalloutShape=function(){var e=this,n=e.options.position,r=function(e){return t.makeArray(t.map(e,function(e){return e.substr(0,1)}))},i=r(n.my.split(" ")),s=r(n.at.split(" ")),o=[];return i.length===2&&(o=i),i[0]===s[0]?(i[1]==="t"&&s[1]==="b"||i[1]==="b"&&s[1]==="t")&&o.reverse():s[0]==="c"&&o.reverse(),o[0]==="c"&&o.reverse(),o.join("")},n.prototype._setCalloutCss=function(){var e=this,n=e.options,r=e._tooltipCache,i=r?r._$tooltip:null,o="",u="",a=t.support.isTouchEnabled;if(!n.showCallout&&!a)return;return e._removeCalloutCss(),u=e._getCalloutShape(),o=s+u,i&&i.addClass(o),u},n.prototype._removeCalloutCss=function(){var e=this._tooltipCache,n;e&&(n=e._$tooltip,t.each(["tl","tc","tr","bl","bc","br","rt","rc","rb","lt","lc","lb","cc"],function(e,t){var r=s+t;if(n.hasClass(r))return n.removeClass(r),!1}))},n.prototype._getBorder=function(e){var n={};return t.each(["top","right","left","bottom"],function(t,r){n[r]=o(e.css("border-"+r+"-width"))}),n},n.prototype._setPosition=function(){var e=this,n=e.options,r=n.position,i=r.my,s=e._tooltipCache,u=s?s._$tooltip:null,a=u.is(":hidden"),f=e._setCalloutCss(),l=f?f.split(""):null,c=[0,0],h=s._callout,p,d,v,m,g,y={width:u.width(),height:u.height()},b,w,E=t.support.isTouchEnabled;a&&u.show(),u.css({left:0,top:0});if(n.showCallout){p=e._getBorder(h),v=o(h.css("left")),d=o(h.css("top")),m=o(h.css("right")),g=o(h.css("bottom"));switch(l[0]){case"l":c[0]=p.right;break;case"r":c[0]=-p.left;break;case"b":c[1]=g;break;case"t":c[1]=-d}switch(l[1]){case"t":c[1]=-d;break;case"b":c[1]=g;break;case"r":c[0]=m;break;case"l":c[0]=-v}}if(E&&E()){switch(l[0]){case"l":c[0]=c[0]+30;break;case"r":c[0]=c[0]-30;break;case"b":c[1]=c[1]-30;break;case"t":c[1]=c[1]+30}switch(l[1]){case"t":c[1]=c[1]+30;break;case"b":c[1]=c[1]-30;break;case"r":c[0]=c[0]-30;break;case"l":c[0]=c[0]+30}}r.my.indexOf(" ")>-1?i=r.my.split(" ")[0]+"+"+c[0]+" "+r.my.split(" ")[1]+"+"+c[1]:i=r.my+"+"+c[0]+" "+r.my+"+"+c[1],u.position({my:i,at:r.at,of:r.of,collision:"none none"}),b=e._flipCallout(u.offset(),y,f),w=b.flip;if(w.h||w.v)u.css({left:0,top:0}),u.position({my:i,at:r.at,of:r.of,collision:r.collision});n.showCallout&&e._setUnfilledCallout(f),e._calloutShape=f,a&&u.hide()},n.prototype._setCalloutOffset=function(e){var n=this,r=n.options,i=n._tooltipCache,s=i?i._$tooltip:null,o=i&&i._callout,u=n._calloutShape,a=!1,f=r.position.offset,l="",c=[],h=r.calloutAnimation;if(!o)return;if(!f||f.length===0)return;o.stop(!0,!0),t.each(["tr","tc","tl","bl","bc","br"],function(e,t){if(u===t)return a=!0,!1}),f&&(c=f.split(" "),c.length===2?l=a?c[0]:c[1]:c.length===1&&(l=c[0])),c&&c.length===2&&c[0]==="none"&&c[1]==="none"?o.css("left","").css("top",""):l==="none"?o.css(a?"left":"top",""):l!==""&&(e&&!e.disabled?a?o.animate({left:l},h.duration,h.easing):o.animate({top:l},h.duration,h.easing):o.css(a?"left":"top",l))},n.prototype._setUnfilledCallout=function(e){var t=this,n=t._tooltipCache,r=n?n._$tooltip:null,i=n&&n._callout,s=i&&i.children(),o=e.split(""),u=r?r.css("background-color"):"";if(!s)return;s.css({"border-left-color":"","border-top-color":"","border-bottom-color":"","border-right-color":""});if(!t.options.calloutFilled)switch(o[0]){case"l":s.css("border-right-color",u);break;case"t":s.css("border-bottom-color",u);break;case"r":s.css("border-left-color",u);break;case"b":s.css("border-top-color",u)}},n.prototype._showTooltip=function(){var e=this,r=e.options,i=e._tooltipCache,s=i?i._$tooltip:null,o,u,a;if(!i)return;if(e._trigger("showing",null,e)===!1)return;e._showModalLayer(),s.css("z-index",99999),t.fn.wijshow?(u={show:!0,context:s},o=t.extend({},r.animation,r.showAnimation),s.is(":visible")&&(a=s.offset(),s.offset(c),t.extend(u,{pos:a}),o.animated="tooltipSlide"),s.wijshow(o,n.animations,u,null,function(){e._trigger("shown")})):(s.show(),e._trigger("shown")),e._setCalloutOffset(!1)},n.prototype._hideTooltip=function(){var e=this,r=e.options,i=e._tooltipCache,s=i?i._$tooltip:null,o=t.extend({},r.animation,r.hideAnimation),u;if(!i)return;if(e._trigger("hiding",null,e)===!1)return;e._hideModalLayer(),t.fn.wijhide?(u={show:!1,context:s},s.wijhide(o,n.animations,u,null,function(){e._trigger("hidden"),s.css("z-index","")})):(s.hide(),e._trigger("hidden"),s.css("z-index",""))},n.prototype._getContent=function(e){var n={data:""},r;return t.isFunction(e)?(r=e.call(this.element,n),n.data!==""?n.data:r):window[e]&&t.isFunction(window[e])?(r=window[e].call(this.element,n),n.data!==""?n.data:r):e},n.prototype._setText=function(){var e=this,t=e.options,n=e._tooltipCache,r="",i="",s=n?n._title:null;if(!n)return;r=e._getContent(t.content),r=r===""?e._content:r,n._container.html(r),i=e._getContent(t.title),i!==""?s.html(i).show():s.hide()},n.prototype._showModalLayer=function(){var e=this,n=e.options,r=null;e.options.modal&&(r=t("<div>").addClass(n.wijCSS.overlay).css("z-index",99e3).width(e._getDocSize("Width")).height(e._getDocSize("Height")).appendTo("body"),t(window).bind("resize.wijtooltip",function(){r.width(e._getDocSize("Width")).height(e._getDocSize("Height"))}),e._tooltipCache._modalLayer=r)},n.prototype._hideModalLayer=function(){var e=this,n=e._tooltipCache._modalLayer;n&&(n.css("z-index","").remove(),t(window).unbind("resize.wijtooltip"))},n.prototype._getDocSize=function(e){var n,r,i="documentElement",s="body";return t.browser.msie&&parseFloat(t.browser.version)<9?(n=l(a[i]["scroll"+e],a[s]["scroll"+e]),r=l(a[i]["offset"+e],a[s]["offset"+e]),n<r?t(u)[e.toLowerCase()]()+"px":n+"px"):t(a)[e.toLowerCase()]()+"px"},n.prototype._onClickCloseBtn=function(e){this.hide(),e.preventDefault()},n.animations={fade:function(e,n){e=t.extend({duration:300,easing:"swing"},e,n),e.context.stop(!0,!0).animate(e.show?{opacity:"show"}:{opacity:"hide"},e)},tooltipSlide:function(e,n){e=t.extend({duration:300,easing:"swing"},e,n),e.context.stop(!0,!0).animate({left:e.pos.left,top:e.pos.top},e)}},n._getTooltip=function(t){return n._tooltips[t]},n._removeTooltip=function(t){var r=n._tooltips[t],i=r?r._$tooltip:null;r&&(r.count--,r.count<=0&&(i.remove(),n._tooltips[t]=null))},n}(e.wijmoWidget);e.wijtooltip=h,h.prototype.options=t.extend(!0,{},e.wijmoWidget.prototype.options,{initSelector:":jqmData(role='wijtooltip')",wijCSS:{tooltip:"wijmo-wijtooltip",tooltipContainer:"wijmo-wijtooltip-container",tooltipPointer:"wijmo-wijtooltip-pointer",tooltipPointerInner:"wijmo-wijtooltip-pointer-inner",tooltipTitle:"wijmo-wijtooltip-title",tooltipClose:"wijmo-wijtooltip-close"},wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-a",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-a"},content:"",title:"",closeBehavior:"auto",mouseTrailing:!1,triggers:"hover",position:{my:"left bottom",at:"right top",offset:null},showCallout:!0,animation:{animated:"fade",duration:500,easing:null},showAnimation:{},hideAnimation:{},showDelay:150,hideDelay:150,calloutAnimation:{duration:1e3,disabled:!1,easing:null},calloutFilled:!1,modal:!1,group:null,ajaxCallback:null,showing:null,shown:null,hiding:null,hidden:null,cssClass:""}),t.wijmo.registerWidget(n,h.prototype)})(wijmo||(wijmo={}));var TooltipCache=function(){function e(){}return e}();