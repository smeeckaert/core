var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){"use strict";var t=jQuery,n="wijslider",r=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._valueMin=function(){return t.ui.slider.prototype._valueMin.apply(this,arguments)},n.prototype._refreshValue=function(){return t.ui.slider.prototype._refreshValue.apply(this,arguments)},n.prototype._create=function(){return t.ui.slider.prototype._create.apply(this,arguments)},n.prototype.values=function(e,n){return t.ui.slider.prototype.values.apply(this,arguments)},n.prototype.value=function(e){return t.ui.slider.prototype.value.apply(this,arguments)},n.prototype._slide=function(e,n,r){return t.ui.slider.prototype._slide.apply(this,arguments)},n.prototype._change=function(e,n){return t.ui.slider.prototype._change.apply(this,arguments)},n}(e.JQueryUIWidget);e.JQueryUISlider=r;var i=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._setOption=function(e,n){var r=this;return e==="values"?(n=r._pre_set_values(n),r.options[e]=n,r._setValuesOption()):t.ui.slider.prototype._setOption.apply(r,arguments),e==="disabled"?r._handleDisabledOption(n,r.element.parent()):e==="range"&&r._setRangeOption(n),this},n.prototype._setRangeOption=function(e){var t=this,n=t.options,r;e===!0&&(!n.values||n.values&&n.values.length===0?(r=t._valueMin(),n.values=[r,r]):n.values.length&&n.values.length!==2&&(r=n.values[0],n.values=[r,r]),t._refresh_handle(2)),t._re_createRange(),t._refreshValue()},n.prototype._setValuesOption=function(){var e=this,n=0,r;e._animateOff=!0,e._refreshValue(),t.isArray(e.options.values)&&(n=e.options.values.length);for(r=0;r<n;r++)e._change(null,r);e._animateOff=!1},n.prototype._re_createRange=function(){var e=this,n=e.options;e.range&&(e.range.remove(),t(".ui-slider-range",e.element).length>0&&t(".ui-slider-range",e.element).remove()),n.range&&(e.range=t("<div></div>").appendTo(e.element).addClass("ui-slider-range ui-widget-header"+(n.range==="min"||n.range==="max"?" ui-slider-range-"+n.range:"")))},n.prototype._pre_set_values=function(e){var t=this,n=t.options,r=1,i;return r=e&&e.length?e.length:1,n.range===!0&&(!e||e&&e.length===0?(i=t._valueMin(),e=[i,i]):e.length&&e.length!==2&&(i=e[0],e=[i,i]),r=2),t._refresh_handle(r),t._re_createRange(),e},n.prototype._refresh_handle=function(e){var t=this,n=t.handles.length,r="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",i=[],s;if(n!==e){if(e>n){for(s=n;s<e;s++)i.push(r);t.element.append(i.join(""))}else t.element.find(".ui-slider-handle").eq(e-1).nextAll().remove();t.handles=t.element.find(".ui-slider-handle")}},n.prototype._initState=function(){this._dragFillTarget=!1,this._dragFillStart=0,this._rangeValue=0,this._oldValue1=0,this._oldValue2=0,this._oldX=0,this._oldY=0},n.prototype._create=function(){var n=this,r=n.element,i=n.options,s,o,u,a,f,l,c,h,p,d,v;window.wijmoApplyWijTouchUtilEvents&&(t=window.wijmoApplyWijTouchUtilEvents(t)),this._initState(),n._oriStyle=r.attr("style");if(r.is(":input")){i.orientation==="horizontal"?s=t("<div></div>").width(r.width()).appendTo(document.body):s=t("<div></div>").height(r.height()).appendTo(document.body),o=r.val();if(o!=="")try{u=o.split(";"),f=u.length;if(f>0){for(a=0;a<f;a++)u[a]=parseInt(u[a],10);f===1?i.value=u[0]:i.values=u}}catch(m){}r.data(n.widgetName,s.wijslider(i)).after(t(document.body).children("div:last")).hide();if(i.disabledState){var g=i.disabled;n.disable(),i.disabled=g}return}e.prototype._create.call(this),r.data("originalStyle",r.attr("style")),r.data("originalContent",r.html()),l=r.width(),c=r.height(),h=t("<div></div>"),i.orientation==="horizontal"?h.addClass("wijmo-wijslider-horizontal"):h.addClass("wijmo-wijslider-vertical"),h.width(l).height(c),p=t('<a class="wijmo-wijslider-decbutton"><span></span></a>'),d=t('<a class="wijmo-wijslider-incbutton"><span></span></a>'),r.wrap(h).before(p).after(d),n._container=r.parent(),n._attachClass(),v=r.find(".ui-slider-handle"),n._adjustSliderLayout(p,d,v);if(i.disabledState){var g=i.disabled;n.disable(),i.disabled=g}n.element.is(":hidden")&&n.element.wijAddVisibilityObserver&&n.element.wijAddVisibilityObserver(function(){n._refreshSlider(),n.element.wijRemoveVisibilityObserver&&n.element.wijRemoveVisibilityObserver()},"wijslider"),n._bindEvents()},n.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},n.prototype._createDisabledDiv=function(e){var n=this,r=e?e:n.element,i=r.offset(),s=r.outerWidth(),o=r.outerHeight();return t("<div></div>").addClass("ui-disabled").css({"z-index":"99999",position:"absolute",width:s,height:o,left:i.left,top:i.top})},n.prototype.refresh=function(){var e=this.element.data("wijslider"),t=this.element.data("wijmoWijslider");this.destroy(),this.element.data("wijslider",e),this.element.data("wijmoWijslider",t),this._create()},n.prototype._refreshSlider=function(){var e=this,t,n,r;n=e._container.find(".wijmo-wijslider-decbutton"),t=e._container.find(".wijmo-wijslider-incbutton"),r=e._container.find(".ui-slider-handle"),e._adjustSliderLayout(n,t,r),e._refreshValue()},n.prototype._adjustSliderLayout=function(e,t,n){var r=this,i=r.element,s=r.options,o,u,a,f,l,c,h,p,d,v,m,g;o=r._container.width(),u=r._container.height(),a=e.outerWidth(),f=e.outerHeight(),l=t.outerWidth(),c=t.outerHeight(),h=n.outerWidth(),p=n.outerHeight(),s.orientation==="horizontal"?(d=u/2-f/2,e.css("top",d).css("left",0),v=u/2-c/2,t.css("top",v).css("right",0),i.css("left",a+h/2-1).css("top",u/2-i.outerHeight()/2).width(o-a-l-h-2)):(m=o/2-a/2,e.css("left",m).css("top",0),g=o/2-l/2,t.css("left",g).css("bottom",0),i.css("left",o/2-i.outerWidth()/2).css("top",f+p/2+1).height(u-f-c-p-2))},n.prototype.destroy=function(){var n=this,r,i;r=this._getDecreBtn(),i=this._getIncreBtn(),r.unbind("."+n.widgetName),i.unbind("."+n.widgetName),e.prototype.destroy.call(this),t("a",n.element.parent()).remove(),n.element.unbind("."+n.widgetName),n.element.unwrap(),n._oriStyle===undefined?n.element.removeAttr("style"):n.element.attr("style",n._oriStyle),n.element.removeData(n.widgetName).removeData("originalStyle").removeData("originalContent"),n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},n.prototype._slide=function(t,n,r){var i=this,s=i.options,o=s.minRange,u=r,a;s.range===!0&&(a=i.values(),n===0&&a[1]-o<r?u=a[1]-o:n===1&&a[0]+o>r&&(u=a[0]+o)),e.prototype._slide.call(this,t,n,u)},n.prototype._getDecreBtn=function(){var e=this.element.parent().find(".wijmo-wijslider-decbutton");return e},n.prototype._getIncreBtn=function(){var e=this.element.parent().find(".wijmo-wijslider-incbutton");return e},n.prototype._attachClass=function(){this._getDecreBtn().addClass("ui-corner-all ui-state-default").attr("role","button"),this._getIncreBtn().addClass("ui-corner-all ui-state-default").attr("role","button"),this.element.parent().attr("role","slider").attr("aria-valuemin",this.options.min).attr("aria-valuenow","0").attr("aria-valuemax",this.options.max),this.options.orientation==="horizontal"?(this.element.parent().addClass("wijmo-wijslider-horizontal"),this._getDecreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-w"),this._getIncreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-e")):(this.element.parent().addClass("wijmo-wijslider-vertical"),this._getDecreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-n"),this._getIncreBtn().find("> span").addClass("ui-icon ui-icon-triangle-1-s"))},n.prototype._bindEvents=function(){var e=this,t,n,r;t=this._getDecreBtn(),n=this._getIncreBtn(),r=e.element,t.bind("click."+e.widgetName,e,e._decreBtnClick),n.bind("click."+e.widgetName,e,e._increBtnClick),t.bind("mouseover."+e.widgetName,e,e._decreBtnMouseOver),t.bind("mouseout."+e.widgetName,e,e._decreBtnMouseOut),t.bind("mousedown."+e.widgetName,e,e._decreBtnMouseDown),t.bind("mouseup."+e.widgetName,e,e._decreBtnMouseUp),n.bind("mouseover."+e.widgetName,e,e._increBtnMouseOver),n.bind("mouseout."+e.widgetName,e,e._increBtnMouseOut),n.bind("mousedown."+e.widgetName,e,e._increBtnMouseDown),n.bind("mouseup."+e.widgetName,e,e._increBtnMouseUp),r.bind("mouseup."+e.widgetName,e,e._elementMouseupEvent)},n.prototype._decreBtnMouseOver=function(e){var t=e.data,n,r;if(t.options.disabledState||t.options.disabled)return;n={buttonType:"decreButton"},t._trigger("buttonMouseOver",e,n),r=t._getDecreBtn(),r.addClass("ui-state-hover")},n.prototype._increBtnMouseOver=function(e){var t=e.data,n,r;if(t.options.disabledState||t.options.disabled)return;n={buttonType:"increButton"},t._trigger("buttonMouseOver",e,n),r=t._getIncreBtn(),r.addClass("ui-state-hover")},n.prototype._decreBtnMouseOut=function(e){var t=e.data,n,r;if(t.options.disabledState||t.options.disabled)return;n={buttonType:"decreButton"},t._trigger("buttonMouseOut",e,n),r=t._getDecreBtn(),r.removeClass("ui-state-hover ui-state-active")},n.prototype._increBtnMouseOut=function(e){var t=e.data,n,r;if(t.options.disabledState||t.options.disabled)return;n={buttonType:"increButton"},t._trigger("buttonMouseOut",e,n),r=t._getIncreBtn(),r.removeClass("ui-state-hover ui-state-active")},n.prototype._decreBtnMouseDown=function(e){var n=e.data,r,i;if(n.options.disabledState||n.options.disabled)return;r={buttonType:"decreButton"},n._trigger("buttonMouseDown",e,r),i=n._getDecreBtn(),i.addClass("ui-state-active"),t(document).bind("mouseup."+n.widgetName,{self:n,ele:i},n._documentMouseUp),n._intervalID!==null&&(window.clearInterval(n._intervalID),n._intervalID=null),n._intervalID=window.setInterval(function(){n._decreBtnHandle(n)},200)},n.prototype._documentMouseUp=function(e){var n=e.data.self,r=e.data.ele;if(n.options.disabledState||n.options.disabled)return;r.removeClass("ui-state-active"),n._intervalID!==null&&(window.clearInterval(n._intervalID),n._intervalID=null),t(document).unbind("mouseup."+n.widgetName,n._documentMouseUp)},n.prototype._increBtnMouseDown=function(e){var n=e.data,r,i;if(n.options.disabledState||n.options.disabled)return;r={buttonType:"increButton"},n._trigger("buttonMouseDown",e,r),i=n._getIncreBtn(),i.addClass("ui-state-active"),t(document).bind("mouseup."+n.widgetName,{self:n,ele:i},n._documentMouseUp),n._intervalID!==null&&(window.clearInterval(n._intervalID),n._intervalID=null),n._intervalID=window.setInterval(function(){n._increBtnHandle(n)},200)},n.prototype._decreBtnMouseUp=function(e){var t=e.data,n,r;if(t.options.disabledState||t.options.disabled)return;n={buttonType:"decreButton"},t._trigger("buttonMouseUp",e,n),r=t._getDecreBtn(),r.removeClass("ui-state-active"),window.clearInterval(t._intervalID)},n.prototype._increBtnMouseUp=function(e){var t=e.data,n,r;if(t.options.disabledState||t.options.disabled)return;n={buttonType:"increButton"},t._trigger("buttonMouseUp",e,n),r=t._getIncreBtn(),r.removeClass("ui-state-active"),window.clearInterval(t._intervalID)},n.prototype._decreBtnHandle=function(e){e.options.orientation==="horizontal"?e._decre():e._incre()},n.prototype._decreBtnClick=function(e){var t=e.data,n;if(t.options.disabledState||t.options.disabled)return;t._mouseSliding=!1,t._decreBtnHandle(t),n={buttonType:"decreButton",value:t.value()},t._trigger("buttonClick",e,n)},n.prototype._increBtnHandle=function(e){e.options.orientation==="horizontal"?e._incre():e._decre()},n.prototype._increBtnClick=function(e){var t=e.data,n;if(t.options.disabledState||t.options.disabled)return;t._mouseSliding=!1,t._increBtnHandle(t),n={buttonType:"increButton",value:t.value()},t._trigger("buttonClick",e,n)},n.prototype._decre=function(){var e=this,t=e.value(),n=e.options,r=n.min,i=n.step;n.values&&n.values.length?(t=e.values(0),t<=r?e.values(0,r):e.values(0,t-i)):(t=e.value(),t<=r?e.value(r):e.value(t-i)),e.element.parent().attr("aria-valuenow",e.value())},n.prototype._incre=function(){var e=this,t=e.value(),n=e.options,r=n.max,i=n.step,s;n.values&&n.values.length?(s=n.values.length===1?0:1,t=e.values(s),t>=r?e.values(s,r):e.values(s,t+i)):(t=e.value(),t>=r?e.value(r):e.value(t+i)),e.element.parent().attr("aria-valuenow",e.value())},n.prototype._elementMouseupEvent=function(e){var n=e.data;n.options.dragFill&&n.options.range&&(n._dragFillStart>0?n._dragFillStart=0:t.ui.slider.prototype._mouseCapture.apply(n,arguments))},n.prototype._mouseCapture=function(e){this.element.parent().attr("aria-valuenow",this.value());if(this.options.dragFill){if(e.target.className==="ui-slider-range ui-widget-header")return this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),!0;try{return t.ui.slider.prototype._mouseCapture.apply(this,arguments)}catch(n){}}else try{return t.ui.slider.prototype._mouseCapture.apply(this,arguments)}catch(n){}},n.prototype._mouseStart=function(e){if(this.options.dragFill){if(e.target&&e.target.className==="ui-slider-range ui-widget-header")return this._dragFillTarget=!0,this._rangeValue=this.values(1)-this.values(0),this._oldValue1=this.values(0),this._oldValue2=this.values(1),this._oldX=e.pageX,this._oldY=e.pageY,!0;this._dragFillTarget=!1}return!0},n.prototype._mouseDrag=function(e){var n,r,i,s,o,u;return this.options.dragFill?(n=e.pageX-this._oldX,r=this.element.outerWidth(),this.options.orientation==="vertical"&&(r=this.element.outerHeight(),n=-(e.pageY-this._oldY)),i=(this.options.max-this.options.min)/r*n,this._dragFillTarget?(this.options.orientation==="vertical"?t(document.documentElement).css("cursor","s-resize"):t(document.documentElement).css("cursor","w-resize"),this._dragFillStart>0&&(s=this._rangeValue,this.values(0,this._oldValue1+i),this.values(1,this._oldValue1+i+s),o=this.values(0),u=this.values(1),o+s>this.options.max&&this.values(0,this.options.max-s),u-s<this.options.min&&this.values(1,this.options.min+s)),this._dragFillStart++,!1):t.ui.slider.prototype._mouseDrag.apply(this,arguments)):t.ui.slider.prototype._mouseDrag.apply(this,arguments)},n.prototype._mouseStop=function(e){var n=t.ui.slider.prototype._mouseStop.apply(this,arguments);return this.options.dragFill&&(t(document.documentElement).css("cursor","default"),window.setTimeout(function(){this._dragFillTarget=!1,this._dragFillStart=0},500)),n},n}(r);e.wijslider=i,i.prototype.widgetEventPrefix="wijslider",i.prototype.options=t.extend(!0,{},t.Widget.prototype.options,{buttonMouseOver:null,buttonMouseOut:null,buttonMouseDown:null,buttonMouseUp:null,buttonClick:null,dragFill:!0,minRange:0}),t.ui&&t.ui.slider&&t.wijmo.registerWidget(n,t.ui.slider,i.prototype)})(wijmo||(wijmo={}));