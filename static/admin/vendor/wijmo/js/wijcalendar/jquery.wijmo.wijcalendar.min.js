var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){"use strict";var t=jQuery,n="wijcalendar",r={general:0,weekEnd:1,otherMonth:2,outOfRange:4,today:8,custom:16,disabled:32,selected:64,gap:128},i=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._create=function(){var e=this,n=e.options.wijCSS;window.wijmoApplyWijTouchUtilEvents&&(t=window.wijmoApplyWijTouchUtilEvents(t)),t.isFunction(window.wijmoASPNetParseOptions)&&wijmoASPNetParseOptions(this.options),this.element.addClass("wijmo-wijcalendar  "+n.datepickerInline+" "+n.datepicker+" "+n.widget+" "+n.content+" "+n.helperClearFix+" "+n.cornerAll).attr("role","grid"),this._previewWrapper(this.options.allowPreview),this.element.data("preview.wijcalendar",!1),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.refresh(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijcalendar")},n.prototype._init=function(){if(this.options.popupMode){var e={autoHide:!!this.options.autoHide,showing:undefined,shown:undefined,hiding:undefined,hidden:undefined},t=this;this.options.beforePopup&&(e.showing=this.options.beforePopup),this.options.afterPopup&&(e.shown=this.options.afterPopup),this.options.beforeClose&&(e.hiding=this.options.beforeClose),e.hidden=function(e){t.element.removeData("lastdate.wijcalendar"),t.options.afterClose&&t.options.afterClose.call(e)},this.element.wijpopup(e)}this._getSelectedDates(),this._getDisabledDates(),this._resetWidth(),this.refresh()},n.prototype.destroy=function(){var n=this.options.wijCSS;e.prototype.destroy.call(this),this.close(),this.element.html(""),this.element.removeClass("wijmo-wijcalendar "+n.datepickerInline+" "+n.datepicker+" "+n.widget+" "+n.content+" "+n.helperClearFix+" "+n.cornerAll+" "+n.datepickerMulti).removeAttr("role");var r=this;t.each(["preview","disableddates","selecteddates","dragging","lastdate","animating"],function(e,t){r.element.removeData(t+".wijcalendar")}),this._previewWrapper(!1)},n.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);switch(t){case"showWeekDays":case"showWeekNumbers":case"showTitle":case"showOtherMonthDays":case"selectionMode":this.unSelectAll(),this._resetWidth(),this.refresh();break;case"culture":this.refresh();break;case"allowPreview":this._previewWrapper(n),this.refresh();break;case"monthCols":this._myGrid&&(this._myGrid=undefined),this._resetWidth(),this.refresh();break;case"monthRows":this._myGrid&&(this._myGrid=undefined);break;case"autoHide":this.element.wijpopup({autoHide:this.options.autoHide});break;case"selectedDates":this._getSelectedDates().setDates(n),this.refresh();break;case"disabledDates":this._getDisabledDates().setDates(n),this.refresh();break;case"displayDate":this.refresh()}},n.prototype._previewWrapper=function(e){e?this.element.parent().hasClass("wijmo-wijcalendar-preview-wrapper")||this.element.wrap("<div class='wijmo-wijcalendar-preview-wrapper "+this.options.wijCSS.helperClearFix+"'></div>"):this.element.parent().hasClass("wijmo-wijcalendar-preview-wrapper")&&this.element.unwrap()},n.prototype._isRTL=function(){return!!this._getCulture(null).isRTL},n.prototype.refresh=function(){this.element.empty().append(this._createCalendar()),this.element[(this._isRTL()?"add":"remove")+"Class"](this.options.wijCSS.datepickerRtl),this.options.showTitle?this.element.removeClass("wijmo-wijcalendar-notitle"):this.element.addClass("wijmo-wijcalendar-notitle"),this._bindEvents()},n.prototype.refreshDate=function(e){if(!this._monthViews)return;if(e<this._groupStartDate||e>this._groupEndDate)return;t.each(this._monthViews,function(){this._refreshDate(e)})},n.prototype.getDisplayDate=function(){var e=this.options.displayDate?this.options.displayDate:new Date;return o.isSameDate(e,new Date(1900,0,1))&&(e=new Date),e},n.prototype.getSelectedDate=function(){var e=this.options.selectedDates;return!e||e.length===0?null:e[0]},n.prototype.selectDate=function(e){return e=new Date(e),this._getDisabledDates().contains(e)?!1:e<this.options.minDate||e>this.options.maxDate?!1:(this._getSelectedDates().add(e),this.refreshDate(e),!0)},n.prototype.unSelectDate=function(e){return e=new Date(e),this._getDisabledDates().contains(e)?!1:e<this.options.minDate||e>this.options.maxDate?!1:(this._getSelectedDates().remove(e),this.refreshDate(e),!0)},n.prototype.unSelectAll=function(){var e=this.options.selectedDates,t;if(e&&e.length>0){this._getSelectedDates().clear();for(t=0;t<e.length;t++)this.refreshDate(e[t])}},n.prototype._slideToDate=function(e){if(o.isSameMonth(this.getDisplayDate(),e))return;var t=this.element.is(":visible");if(!t)this.options.displayDate=e;else{if(this._trigger("beforeSlide")===!1)return;this._isSingleMonth()?this._playSlideAnimation(e):this._playMmSlideAnimation(e)}},n.prototype.isPopupShowing=function(){return this.options.popupMode?this.element.wijpopup("isVisible"):!1},n.prototype.popup=function(e){this._myGrid=undefined,this.refresh(),this.element.data("dragging.wijcalendar",!1),this.element.data("wijmoWijpopup")&&this.element.wijpopup("show",e)},n.prototype.popupAt=function(e,t){this._myGrid=undefined,this.refresh(),this.element.data("dragging.wijcalendar",!1),this.element.data("wijmoWijpopup")&&this.element.wijpopup("showAt",e,t)},n.prototype.close=function(){this.isPopupShowing()&&this.element.wijpopup("hide")},n.prototype._getCulture=function(e){return Globalize.findClosestCulture(e||this.options.culture)},n.prototype._getDates=function(e){var t=e.toLowerCase()+".wijcalendar",n=this.element.data(t);return n===undefined&&(n=new a(this,e),this.element.data(t,n)),n},n.prototype._getDisabledDates=function(){return this._getDates("disabledDates")},n.prototype._getSelectedDates=function(){return this._getDates("selectedDates")},n.prototype._onDayDragStart=function(e){return e.preventDefault(),e.stopPropagation(),!1},n.prototype._onDayMouseDown=function(e){e.preventDefault(),e.stopPropagation();var n=this.options,r=this,i,s,o=!1,u=n.selectedDates,a=!1,f=[];return e.which!==1?!1:(i=this._getCellDate(e.currentTarget),i===undefined?!1:n.selectionMode.day?(s={date:i},this._trigger("beforeSelect",null,s)===!1?!1:((!n.selectionMode.days||!e.metaKey&&!e.shiftKey&&!e.ctrlKey)&&this.unSelectAll(),!n.selectionMode.days||(e.shiftKey&&this.element.data("lastdate.wijcalendar")?(this._selectRange(this.element.data("lastdate.wijcalendar"),i,null),o=!0):e.ctrlKey&&(this.element.data("lastdate.wijcalendar",i),t.each(u,function(e,t){if(i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()&&i.getDate()===t.getDate())return a=!0,!1}),a?this.unSelectDate(i):this.selectDate(i),u=n.selectedDates,t.each(u,function(e,t){f.push(new Date(t))}),this._trigger("selectedDatesChanged",null,{dates:f}),o=!0)),o||(this.element.data("lastdate.wijcalendar",i),o=this.selectDate(i),this._trigger("selectedDatesChanged",null,{dates:[i]})),o&&(this._trigger("afterSelect",null,s),!n.selectionMode.days||(this.element.data("dragging.wijcalendar",!0),t(document.body).bind("mouseup."+this.widgetName,function(){t(document.body).unbind("mouseup."+r.widgetName),r.element.data("dragging.wijcalendar",!1)}))),!1)):!1)},n.prototype._onMouseUp=function(e){return e.preventDefault(),e.stopPropagation(),this.element.data("dragging.wijcalendar",!1),!1},n.prototype._onDayClicked=function(e){var n=this._getCellDate(e.currentTarget);return n===undefined?!1:this.options.selectionMode.day?(this.isPopupShowing()?this.close():t(e.currentTarget).hasClass(this.options.wijCSS.datepickerOtherMonth)&&this._slideToDate(n),!1):!1},n.prototype._onDayMouseEnter=function(e){t(e.currentTarget).attr("state","hover"),this._refreshDayCell(e.currentTarget);if(!!this.element.data("dragging.wijcalendar")){var n=this._getCellDate(e.currentTarget);if(n===undefined)return;this.unSelectAll(),this._selectRange(this.element.data("lastdate.wijcalendar"),n,!0)}},n.prototype._onDayMouseLeave=function(e){t(e.currentTarget).attr("state","normal"),this._refreshDayCell(e.currentTarget)},n.prototype._selectRange=function(e,t,n){if(e!==undefined&&e!==new Date(1900,1,1)){var r=e,i=t,s=[];e>t&&(i=e,r=t);for(;;){if(r>i)break;this.selectDate(r),s[s.length]=r,r=o.addDays(r,1)}n||this.element.removeData("lastdate.wijcalendar"),this._trigger("selectedDatesChanged",null,{dates:s})}else this.selectDate(e),this._trigger("selectedDatesChanged",null,{dates:[e]});return!0},n.prototype._getCellDate=function(e){var n=t(e).attr("date");return n===undefined?n:new Date(n)},n.prototype._getParentTable=function(e){var n=t(e).parents("table");return n.length===0?undefined:n.get(0)},n.prototype._initMonthSelector=function(e){if(t(e).data("cells")!==undefined)return;var n=e.id.split("_"),r,i,s=[],o,u,a,f,l;if(n[n.length-1]!=="ms")throw Error.create("not a monthview");r=n.slice(0,n.length-1).join("_"),i=this._getParentTable(e);if(i){if(i.id!==r)throw Error.create("not a monthview");for(o=0;o<i.rows.length;o++){l=i.rows[o];for(u=0;u<l.cells.length;u++)a=l.cells[u],a&&(f=t(a).attr("daytype"),f!==undefined&&t(a).find("a").hasClass(this.options.wijCSS.prioritySecondary)===!1&&this._isSelectable(parseInt(f,10))&&(s[s.length]=a))}}t(e).data("cells",s)},n.prototype._onMonthSelectorClicked=function(e){this._initMonthSelector(e.currentTarget);var n=t(e.currentTarget).data("cells"),r=[],i,s,o,u;this.element.removeData("lastdate.wijcalendar"),this.unSelectAll();for(i=0;i<n.length;i++)s=n[i],o=t(s).attr("date"),o!==undefined&&(u=new Date(o),this.selectDate(u),r[r.length]=u);return this._trigger("selectedDatesChanged",null,{dates:r}),this.isPopupShowing()&&this.close(),!1},n.prototype._onMonthSelectorMouseEnter=function(e){this._initMonthSelector(e.currentTarget);var n=t(e.currentTarget).data("cells"),r;for(r=0;r<n.length;r++)e.currentTarget=n[r],this._onDayMouseEnter(e)},n.prototype._onMonthSelectorMouseLeave=function(e){this._initMonthSelector(e.currentTarget);var n=t(e.currentTarget).data("cells"),r;for(r=0;r<n.length;r++)e.currentTarget=n[r],this._onDayMouseLeave(e)},n.prototype._initWeekDaySelector=function(e){if(t(e).data("cells")!==undefined)return;var n=e.id.split("_"),r,i,s,o=[],u=0,a,f,l;if(n[n.length-2]!=="cs")throw Error.create("not a column");r=parseInt(n[n.length-1],10),i=n.slice(0,n.length-2).join("_"),s=this._getParentTable(e);if(s){if(s.id!==i)throw Error.create("not a column");this.options.showWeekDays&&u++;for(;u<s.rows.length;u++)a=s.rows[u],r<a.cells.length&&(f=a.cells[r],f&&(l=t(f).attr("daytype"),l!==undefined&&t(f).find("a").hasClass(this.options.wijCSS.prioritySecondary)===!1&&this._isSelectable(parseInt(l,10))&&(o[o.length]=f)))}t(e).data("cells",o)},n.prototype._onWeekDayClicked=function(e){this._initWeekDaySelector(e.currentTarget);var n=t(e.currentTarget).data("cells"),r=[],i,s,o,u;this.unSelectAll();for(i=0;i<n.length;i++)s=t(n[i]),o=s.attr("date"),o!==undefined&&(u=new Date(o),this.selectDate(u),r[r.length]=u);return this._trigger("selectedDatesChanged",null,{dates:r}),this.isPopupShowing()&&this.close(),!1},n.prototype._onWeekDayMouseEnter=function(e){this._initWeekDaySelector(e.currentTarget);var n=t(e.currentTarget).data("cells"),r;for(r=0;r<n.length;r++)e.currentTarget=n[r],this._onDayMouseEnter(e)},n.prototype._onWeekDayMouseLeave=function(e){this._initWeekDaySelector(e.currentTarget);var n=t(e.currentTarget).data("cells"),r;for(r=0;r<n.length;r++)e.currentTarget=n[r],this._onDayMouseLeave(e)},n.prototype._initWeekNumberSelector=function(e){if(t(e).data("cells")!==undefined)return;var n=e.id.split("_"),r,i,s,o=[],u,a,f,l;if(n[n.length-2]!=="rs")throw Error.create("not a row");r=parseInt(n[n.length-1],10),i=n.slice(0,n.length-2).join("_"),s=this._getParentTable(e);if(s){if(s.id!==i)throw Error.create("not a row");u=s.rows[r];if(u){a=0,this.options.showWeekNumbers&&a++;for(;a<u.cells.length;a++)f=u.cells[a],f&&(l=t(f).attr("daytype"),l!==undefined&&t(f).find("a").hasClass(this.options.wijCSS.prioritySecondary)===!1&&this._isSelectable(parseInt(l,10))&&(o[o.length]=f))}}t(e).data("cells",o)},n.prototype._onWeekNumberClicked=function(e){this._initWeekNumberSelector(e.currentTarget);var n=t(e.currentTarget).data("cells"),r=[],i,s,o,u;this.unSelectAll();for(i=0;i<n.length;i++)s=t(n[i]),o=s.attr("date"),o!==undefined&&(u=new Date(o),this.selectDate(u),r[r.length]=u);return this._trigger("selectedDatesChanged",null,{dates:r}),this.isPopupShowing()&&this.close(),!1},n.prototype._onWeekNumberMouseEnter=function(e){this._initWeekNumberSelector(e.currentTarget);var n=t(e.currentTarget).data("cells"),r;for(r=0;r<n.length;r++)e.currentTarget=n[r],this._onDayMouseEnter(e)},n.prototype._onWeekNumberMouseLeave=function(e){this._initWeekNumberSelector(e.currentTarget);var n=t(e.currentTarget).data("cells"),r;for(r=0;r<n.length;r++)e.currentTarget=n[r],this._onDayMouseLeave(e)},n.prototype._isAnimating=function(){return!!this.element.data("animating.wijcalendar")},n.prototype._onPreviewMouseEnter=function(e){if(!!this.element.data("previewContainer"))return;if(this._isAnimating())return;var n=t(e.currentTarget),r=n.attr("id"),i=this.getDisplayDate(),s=this.options.wijCSS,u=this.options.monthCols*this.options.monthRows,a=t("<div/>");if(r===undefined)return;r==="prevPreview"&&(u=-u),this.options.displayDate=o.addMonths(i,u),this.element.data("preview.wijcalendar",!0),a.appendTo(document.body),a.hide(),a.addClass("wijmo-wijcalendar "+s.datepickerInline+" "+s.datepicker+" "+s.widget+" "+s.content+" "+s.helperClearFix+" "+s.cornerAll),a.append(this._createCalendar()),this.options.displayDate=i,this.element.data("preview.wijcalendar",!1),this._createMonthViews(),a.wijpopup({showEffect:"slide",showOptions:{direction:r==="prevPreview"?"right":"left"},hideEffect:"slide",hideOptions:{direction:r==="prevPreview"?"right":"left"}}),a.wijpopup("show",{my:r==="prevPreview"?"right top":"left top",at:r==="prevPreview"?"left top":"right top",of:n}),this.element.data("previewContainer",a)},n.prototype._onPreviewMouseLeave=function(e){var n=t(e.currentTarget),r=n.attr("id"),i=this.element.data("previewContainer"),s=this;if(r===undefined)return;i&&(i.wijpopup("isAnimating")?window.setTimeout(function(){s._onPreviewMouseLeave(e)},200):(i.wijpopup("hide"),this.element.removeData("previewContainer")))},n.prototype._resetWidth=function(){this._myGrid||(this.element.css("height",""),this.options.monthCols>1?(this.element.css("width",17*this.options.monthCols+"em"),this.element.addClass(this.options.wijCSS.datepickerMulti)):(this.element.css("width",""),this.element.removeClass(this.options.wijCSS.datepickerMulti)))},n.prototype._playMmSlideAnimation=function(e){var n=this.element.width(),r=this.element.height(),i=this.getDisplayDate(),s,o,u,a=this.options.direction||"horizontal",f=this,l,c;this.element.height(r),this.element.wrapInner("<div class='wijmo-wijcalendar-multi-aniwrapper'></div>"),s=this.element.find(">:first-child").width(n).height(r),o=s.clone(!1),o.hide(),this.options.displayDate=e,this._createMonthViews(),o.empty().append(this._createMonthGroup()),o.appendTo(this.element),u=e>i,this.element.data("animating.wijcalendar",!0),t.effects?(s.effect("slide",{mode:"hide",direction:a==="horizontal"?u?"left":"right":u?"up":"down",easing:this.options.easing||"easeOutBack",duration:this.options.duration},function(){s.remove()}),o.effect("slide",{direction:a==="horizontal"?u?"right":"left":u?"down":"up",easing:this.options.easing||"easeOutBack",duration:this.options.duration},function(){while(o.parent().is(".wijmo-wijcalendar-multi-aniwrapper"))o.parent().replaceWith(o);o.replaceWith(o.contents()),f.element.height(""),f._bindEvents(),f.element.data("animating.wijcalendar",!1),f._trigger("afterSlide")})):(a==="horizontal"?(l={width:0},c={width:"100%"}):(l={height:0},c={height:"100%"}),s.animate(l,this.options.duration,null,function(){s.remove()}),o.animate(c,this.options.duration,null,function(){while(o.parent().is(".wijmo-wijcalendar-multi-aniwrapper"))o.parent().replaceWith(o);o.replaceWith(o.contents()),f.element.height(""),f._bindEvents(),f.element.data("animating.wijcalendar",!1),f._trigger("afterSlide")}))},n.prototype._playSlideAnimation=function(e){if(!this._isSingleMonth())return;var n=this,r=this.getDisplayDate(),i=n.options.wijCSS,s=this.element.find("."+i.datepickerCalendar),o,a,f=1,l=this.options.direction||"horizontal",c=e>r,h=[],p,d,v;s.parent().is(".wijmo-wijcalendar-aniwrapper")?o=s.parent():(o=t.createWrapper(s).css({overflow:"hidden"}),o.removeClass(i.effectsWrapper),o.addClass("wijmo-wijcalendar-aniwrapper")),o.parent().is(".wijmo-wijcalendar-aniwrapper")?a=o.parent():(a=t.createWrapper(o).css({overflow:"hidden"}),a.removeClass(i.effectsWrapper),a.addClass("wijmo-wijcalendar-aniwrapper"));if(this._myGrid)switch(this._myGrid.gridType){case"month":f=1;break;case"year":f=10;break;case"decade":f=100}h[h.length]=e,p=s.outerWidth(),d=s.outerHeight(),l==="horizontal"?(s.width(p).css("float",c?"left":"right"),o.width((h.length+1)*p),o.css("left",c?0:-h.length*p).css("position","absolute")):(o.width(p),o.css("top",c?0:-h.length*d).css("position","absolute"),o.height((h.length+1)*d)),t.each(h,function(e,r){if(n._myGrid===undefined){var i=new u(n,r),s=n._customize(i.getHtml(!0));l==="horizontal"?s.width(p).css("float",c?"left":"right").appendTo(o):s.appendTo(o)}else l==="horizontal"?t(n._myGrid.getHtml(r,!0)).width(p).height(d).css("float",c?"left":"right").appendTo(o):t(n._myGrid.getHtml(r,!0)).height(d).appendTo(o)}),this.options.displayDate=e,this._myGrid===undefined&&this._createMonthViews(),this._refreshTitle(),this.element.data("animating.wijcalendar",!0),t.effects?o.effect("slide",{mode:"hide",direction:l==="horizontal"?c?"left":"right":c?"up":"down",easing:this.options.easing||"easeOutBack",distance:(l==="horizontal"?p:d)*h.length,duration:this.options.duration},function(){s=o.children(":last");while(s.parent().is(".wijmo-wijcalendar-aniwrapper"))s.parent().replaceWith(s);s.css({"float":"",width:""}),n._bindEvents(),n.element.data("animating.wijcalendar",!1),n._trigger("afterSlide")}):(l==="horizontal"?v={width:0}:v={height:0},o.animate(v,this.options.duration,null,function(){s=o.children(":last");while(s.parent().is(".wijmo-wijcalendar-aniwrapper"))s.parent().replaceWith(s);s.css({"float":"",width:""}),n._bindEvents(),n.element.data("animating.wijcalendar",!1),n._trigger("afterSlide")}))},n.prototype._onTitleClicked=function(){if(!this.options.allowQuickPick||!this._isSingleMonth())return;if(this._isAnimating())return;if(this._myGrid===undefined)this._myGrid=new f(this);else switch(this._myGrid.gridType){case"month":this._myGrid.gridType="year";break;case"year":this._myGrid.gridType="decade";break;case"decade":return}this._refreshTitle(),this.element.width(this.element.width()).height(this.element.height());var e=this.options.wijCSS,n=this.element.find("."+e.datepickerCalendar),r,i,s,o=n.outerWidth(),u=n.outerHeight(),a,l,c,h,p,d,v=this;n.parent().is(".wijmo-wijcalendar-aniwrapper")?r=n.parent():r=t.createWrapper(n).css({overflow:"hidden"}).removeClass(e.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper"),r.parent().is(".wijmo-wijcalendar-aniwrapper")?i=r.parent():i=t.createWrapper(r).css({overflow:"hidden"}).removeClass(e.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper").width(o).height(u),s=t(this._myGrid.getHtml(!0)).css({position:"absolute",top:0,left:0,opacity:0}).appendTo(i).height(u),a=this._myGrid.getSelectedIndex(),l=Math.floor(a/4),c=a-l*4,h=o/4,p=u/3,d={left:h*c,top:p*l,width:h,height:p},n.width("100%").height("100%"),r.css({border:"solid 1px #cccccc"}),this.element.data("animating.wijcalendar",!0),t.effects?r.effect("size",{to:d,duration:this.options.duration||500},function(){r.remove()}):r.animate(d,this.options.duration||500,null,function(){r.remove()}),s.animate({opacity:1},this.options.duration||500,null,function(){s.css({position:"",top:"",left:"",filter:""});while(s.parent().is(".wijmo-wijcalendar-aniwrapper"))s.parent().replaceWith(s);v._bindEvents(),v.element.data("animating.wijcalendar",!1)})},n.prototype._onMyGridClicked=function(e){if(this._myGrid===undefined)return!1;if(this._isAnimating())return!1;var n=t(e.currentTarget),r=parseInt(n.attr("index"),10),i=parseInt(n.attr("value"),10),s=this.options.wijCSS,o=this.element.find("."+s.datepickerCalendar),u,a,f,l,c,h,p,d,v,m=this;if(this._myGrid.gridType!=="month")if(!r||r===11)return!1;return n.hasClass(s.stateActive)||this._myGrid.select(r,i),this._myGrid.gridType==="decade"?this._myGrid.gridType="year":this._myGrid.gridType==="year"?this._myGrid.gridType="month":this._myGrid=undefined,this._refreshTitle(),f=o.outerWidth(),l=o.outerHeight(),o.parent().is(".wijmo-wijcalendar-aniwrapper")?a=o.parent():a=t.createWrapper(o).css({overflow:"hidden"}).removeClass(s.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper").width(f).height(l),c=t.extend({},n.position(),{width:n.width(),height:n.height()}),this._myGrid===undefined?(this._createMonthViews(),p=this.getDisplayDate(),d=this._getMonthView(p),h=this._customize(d.getHtml(!0))):h=t(this._myGrid.getHtml(!0)),v=h.height(l).appendTo(a),u=t.createWrapper(v).css({overflow:"hidden"}).removeClass(s.effectsWrapper).addClass("wijmo-wijcalendar-aniwrapper").css(t.extend(c,{border:"solid 1px #cccccc",position:"absolute"})),this.element.data("animating.wijcalendar",!0),u.animate({left:0,top:0,width:f,height:l},this.options.duration||500,null,function(){v.css("width","")}),o.animate({opacity:0},this.options.duration||500,null,function(){o.remove();while(v.parent().is(".wijmo-wijcalendar-aniwrapper"))v.parent().replaceWith(v);m._myGrid===undefined&&m.element.width("").height(""),m._bindEvents(),m.element.data("animating.wijcalendar",!1)}),!1},n.prototype._onMyGridMouseEnter=function(e){if(this._myGrid===undefined)return;var n=t(e.currentTarget),r=parseInt(n.attr("index"),10);if(this._myGrid.gridType!=="month"&&(r<0||r>11))return;n.addClass(this.options.wijCSS.stateHover)},n.prototype._onMyGridMouseLeave=function(e){if(this._myGrid===undefined)return;var n=t(e.currentTarget),r=parseInt(n.attr("index"),10);if(this._myGrid.gridType!=="month"&&(r<0||r>11))return;n.removeClass(this.options.wijCSS.stateHover)},n.prototype._bindEvents=function(){var e=this.options.wijCSS;!this.element.data("preview.wijcalendar")&&!this.options.disabledState&&!this.options.disabled&&(this.element.find("div .wijmo-wijcalendar-navbutton").unbind().bind("mouseout.wijcalendar",function(){var n=t(this);n.removeClass(e.stateHover),n.hasClass(e.datepickerNextHover)?n.removeClass(e.datepickerNextHover):n.hasClass(e.datepickerPrevHover)&&n.removeClass(e.datepickerPrevHover)}).bind("mouseover.wijcalendar",function(){var n=t(this);n.addClass(e.stateHover),n.hasClass(e.datepickerNext)?n.addClass(e.datepickerNextHover):n.hasClass(e.datepickerPrev)&&n.addClass(e.datepickerPrevHover)}).bind("click.wijcalendar",t.proxy(this._onNavButtonClicked,this)),this.element.unbind(".wijcalendar").bind({"mouseup.wijcalendar":t.proxy(this._onMouseUp,this)}),this.element.find("."+e.datepickerTitle).unbind().bind("mouseout.wijcalendar",function(){t(this).removeClass(e.stateHover)}).bind("mouseover.wijcalendar",function(){t(this).addClass(e.stateHover)}).bind("click.wijcalendar",t.proxy(this._onTitleClicked,this)),this.element.find(".wijmo-wijcalendar-prevpreview-button, .wijmo-wijcalendar-nextpreview-button").unbind("mouseenter.wijcalendar").unbind("mouseleave.wijcalendar").bind({"mouseenter.wijcalendar":t.proxy(this._onPreviewMouseEnter,this),"mouseleave.wijcalendar":t.proxy(this._onPreviewMouseLeave,this)}),this._myGrid===undefined?(this.element.find(".wijmo-wijcalendar-day-selectable").unbind().bind({"click.wijcalendar":t.proxy(this._onDayClicked,this),"mouseenter.wijcalendar":t.proxy(this._onDayMouseEnter,this),"mouseleave.wijcalendar":t.proxy(this._onDayMouseLeave,this),"mousedown.wijcalendar":t.proxy(this._onDayMouseDown,this),"dragstart.wijcalendar":t.proxy(this._onDayDragStart,this)}),!this.options.selectionMode.month||this.element.find(".wijmo-wijcalendar-monthselector").unbind().bind({"click.wijcalendar":t.proxy(this._onMonthSelectorClicked,this),"mouseenter.wijcalendar":t.proxy(this._onMonthSelectorMouseEnter,this),"mouseleave.wijcalendar":t.proxy(this._onMonthSelectorMouseLeave,this)}),!this.options.selectionMode.weekDay||this.element.find("."+e.datepickerWeekDay).unbind().bind({"click.wijcalendar":t.proxy(this._onWeekDayClicked,this),"mouseenter.wijcalendar":t.proxy(this._onWeekDayMouseEnter,this),"mouseleave.wijcalendar":t.proxy(this._onWeekDayMouseLeave,this)}),!this.options.selectionMode.weekNumber||this.element.find(".wijmo-wijcalendar-week-num").unbind().bind({"click.wijcalendar":t.proxy(this._onWeekNumberClicked,this),"mouseenter.wijcalendar":t.proxy(this._onWeekNumberMouseEnter,this),"mouseleave.wijcalendar":t.proxy(this._onWeekNumberMouseLeave,this)})):this.element.find(".wijmo-wijcalendar-day-selectable").unbind().bind({"click.wijcalendar":t.proxy(this._onMyGridClicked,this),"mouseenter.wijcalendar":t.proxy(this._onMyGridMouseEnter,this),"mouseleave.wijcalendar":t.proxy(this._onMyGridMouseLeave,this)}))},n.prototype._isSelectable=function(e){var t=this.options;return t.showOtherMonthDays&&e&r.otherMonth||!(e&(r.outOfRange|r.disabled|r.otherMonth))},n.prototype._getCellClassName=function(e,t,n){var i=this.options,s="",o=i.wijCSS.stateDefault,u=!!i.selectionMode.day||!!i.selectionMode.days;return n=n||!1,!n&&!i.disabledState&&!i.disabled&&u&&this._isSelectable(e)&&(s+=" wijmo-wijcalendar-day-selectable"),e&r.weekEnd&&(s+=" "+i.wijCSS.datepickerWeekEnd),e&r.otherMonth&&(s+=" "+i.wijCSS.datepickerOtherMonth,o+=" "+i.wijCSS.prioritySecondary),e&r.outOfRange&&(s+=" wijmo-wijcalendar-outofrangeday",o+=" "+i.wijCSS.prioritySecondary),e&r.gap?s+=" wijmo-wijcalendar-gap":(e&r.disabled&&(s+=" "+i.wijCSS.datepickerUnselectable,o+=" "+i.wijCSS.stateDisabled),e&r.today&&(s+=" "+i.wijCSS.datepickerDaysCellOver+" "+i.wijCSS.datepickerToday,o+=" "+i.wijCSS.stateHighlight),e&r.selected&&(e&(r.outOfRange|r.disabled))===0&&(s+=" "+i.wijCSS.datepickerCurrentDay,o+=" "+i.wijCSS.stateActive),e&r.gap&&(s+=" wijmo-wijcalendar-gap"),e&r.custom&&(s+=" wijmo-wijcalendar-customday")),{cssCell:s,cssText:o}},n.prototype._onNavButtonClicked=function(e){if(this._isAnimating())return!1;var n=1,r=t(e.currentTarget).attr("id"),i=this.getDisplayDate(),s=i;if(this._myGrid===undefined)n=r.indexOf("quick")>=0?this.options.quickNavStep:1,n=r.indexOf("next")>=0?n:-n,n=n*this.options.monthRows*this.options.monthCols,s=o.addMonths(i,n);else{n=r.indexOf("next")>=0?1:-1;switch(this._myGrid.gridType){case"month":s=o.addYears(i,n);break;case"year":s=o.addYears(i,n*10);break;case"decade":s=o.addYears(i,n*100)}}return this._slideToDate(s),!1},n.prototype._getMonthGroupHtml=function(){var e=this.getDisplayDate(),t,n,r,i=this.options.wijCSS,u,a;if(this._isSingleMonth())return t=this._getMonthView(e),t.showPreview=this.options.allowPreview&&!this.element.data("preview.wijcalendar"),t.getHtml();n=100/this.options.monthCols+"%",r=new s;for(u=0;u<this.options.monthRows;u++){for(a=0;a<this.options.monthCols;a++)r.writeBeginTag("div"),r.writeAttribute("class",i.datepickerGroup+(a===0?" "+i.datepickerGroupFirst:"")+(a===this.options.monthCols-1?" "+i.datepickerGroupLast:"")),r.writeAttribute("style","width:"+n),r.writeTagRightChar(),t=this._getMonthView(e),t.showPreview=!1,r.write(t.getHtml()),r.writeEndTag("div"),e=o.addMonths(e,1);r.writeBeginTag("div"),r.writeAttribute("class",i.datepickerRowBreak),r.writeTagRightChar(),r.writeEndTag("div")}return r.toString()},n.prototype._getCalendarHtml=function(){this._createMonthViews();var e=new s;return e.write(this._getMonthGroupHtml()),e.toString()},n.prototype._customizeDayCell=function(e){e.attr("state")===undefined&&e.attr("state","normal");if(e.attr("daytype")===undefined)return;if(e.attr("date")===undefined)return;var t=parseInt(e.attr("daytype"),10),n=new Date(e.attr("date")),r=e.attr("state")==="hover";this.options.customizeDate(e,n,t,r)},n.prototype._customize=function(e){var n=this.options,r=this,i=t(e);return t.isFunction(n.customizeDate)?(t.each(i.find(".wijmo-wijcalendar-day-selectable"),function(e,n){r._customizeDayCell(t(n))}),i):i},n.prototype._createCalendar=function(){return this._customize(t(t.parseHTML(this._getCalendarHtml())))},n.prototype._createMonthGroup=function(){return this._customize(t(this._getMonthGroupHtml()))},n.prototype._getMonthID=function(e){return e.getFullYear()+"_"+(e.getMonth()+1)},n.prototype._createMonthViews=function(){this._monthViews={};var e="",t=this.getDisplayDate(),n,r,i,s;for(n=0;n<this.options.monthRows;n++)for(r=0;r<this.options.monthCols;r++)e=this._getMonthID(t),this._monthViews[e]=new u(this,t),n===0&&(r===0&&(this._monthViews[e].isFirst=!0),r===this.options.monthCols-1&&(this._monthViews[e].isLast=!0)),t=o.addMonths(t,1);t=this.getDisplayDate(),e=this._getMonthID(t),i=this._monthViews[e],i&&(this._groupStartDate=i.getStartDate()),s=this.options.monthRows*this.options.monthCols,s>1&&(t=o.addMonths(t,s-1),e=this._getMonthID(t),i=this._monthViews[e]),i&&(this._groupEndDate=i.getEndDate())},n.prototype._getMonthView=function(e){var t=this._getMonthID(e);return this._monthViews[t]},n.prototype._getId=function(){return this.element.attr("id")},n.prototype._getChildElement=function(e){var t=this.element.find("[id*='"+e+"']");return t.length===0?undefined:t},n.prototype._refreshDayCell=function(e){var n=t(e),i=this.options,s,o,u,a;n.attr("state")===undefined&&n.attr("state","normal");if(n.attr("daytype")===undefined)return;if(n.attr("date")===undefined)return;s=parseInt(n.attr("daytype"),10),o=new Date(n.attr("date")),u=n.attr("state")==="hover",n.attr("class",this._getCellClassName(s,o,undefined).cssCell),n.removeAttr("aria-selected"),s&r.selected&&n.attr("aria-selected",!0);if(t.isFunction(i.customizeDate)&&this._customizeDayCell(n))return;a=n.find("a"),a.length>0&&(a.toggleClass(this.options.wijCSS.stateHover,u),a.toggleClass(this.options.wijCSS.stateActive,(s&r.selected)!==0))},n.prototype._isSingleMonth=function(){return this.options.monthCols*this.options.monthRows===1},n.prototype._splitString=function(e,t,n){if(n===undefined)return e.split(t);var r=[],i=e.split(t),s;for(s=0;s<i.length;s++)s>=n?r[n-1]=r[n-1]+t+i[s]:r.push(i[s]);return r},n.prototype._getNavButtonHtml=function(e,t,n,r){var i=new s;return i.writeBeginTag("a"),i.writeAttribute("id",e),i.writeAttribute("class",t),i.writeAttribute("role","button"),i.writeAttribute("href","#"),r&&(i.writeAttribute("title",r),i.writeAttribute("aria-label",r)),i.writeTagRightChar(),i.writeBeginTag("span"),i.writeAttribute("class",n),i.writeTagRightChar(),r&&i.write(r),i.writeEndTag("span"),i.writeEndTag("a"),i.toString()},n.prototype._getTitleText=function(e){if(this._myGrid!==undefined)return this._myGrid.getTitle();var n=e||this.getDisplayDate(),r=this.options.titleFormat||"MMMM yyyy";return t.isFunction(this.options.title)?this.options.title(n,r)||this._formatDate(r,n):this._formatDate(r,n)},n.prototype._refreshTitle=function(){this.element.find("."+this.options.wijCSS.datepickerTitle).html(this._getTitleText(undefined))},n.prototype._fillTitle=function(e,t){var n=this.options.wijCSS;e.writeBeginTag("div"),e.writeAttribute("class",n.datepickerTitle+" wijmo-wijcalendar-title"+" "+n.stateDefault+" "+n.cornerAll),e.writeTagRightChar(),e.write(this._getTitleText(t)),e.writeEndTag("div")},n.prototype._getHeaderHtml=function(e,t,n){var r=!!this.element.data("preview.wijcalendar"),i=this.options.wijCSS,o=r?"none":this._isSingleMonth()?this.options.navButtons:"default",u=this.element.is("."+i.datepickerRtl),a=new s;return o==="quick"?(a.writeBeginTag("div"),a.writeAttribute("class",i.header+" wijmo-wijcalendar-header "+i.helperClearFix+" "+i.cornerAll),a.writeAttribute("role","heading"),a.writeTagRightChar(),!t||a.write(this._getNavButtonHtml("quickprev","wijmo-wijcalendar-navbutton "+i.datepickerPrev+" "+i.cornerAll,i.icon+" ui-icon-seek-"+(u?"next":"prev")+" "+(u?this.options.wijCSS.iconArrowRight:this.options.wijCSS.iconArrowLeft),this.options.quickPrevTooltip.replace("#",this.options.quickNavStep))),a.writeBeginTag("div"),a.writeAttribute("class",i.datepickerHeader+" wijmo-wijcalendar-header-inner"),a.writeTagRightChar(),!t||a.write(this._getNavButtonHtml("prev","wijmo-wijcalendar-navbutton "+i.datepickerPrev+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(u?"e":"w")+" "+(u?this.options.wijCSS.iconArrowRight:this.options.wijCSS.iconArrowLeft),this.options.prevTooltip)),this._fillTitle(a,e),!n||a.write(this._getNavButtonHtml("next","wijmo-wijcalendar-navbutton "+i.datepickerNext+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(u?"w":"e")+" "+(u?this.options.wijCSS.iconArrowLeft:this.options.wijCSS.iconArrowRight),this.options.nextTooltip)),a.writeEndTag("div"),!n||a.write(this._getNavButtonHtml("quicknext","wijmo-wijcalendar-navbutton "+i.datepickerNext+" "+i.cornerAll,i.icon+" ui-icon-seek-"+(u?"prev":"next")+" "+(u?this.options.wijCSS.iconArrowLeft:this.options.wijCSS.iconArrowRight),this.options.quickNextTooltip.replace("#",this.options.quickNavStep))),a.writeEndTag("div")):(a.writeBeginTag("div"),a.writeAttribute("class",i.datepickerHeader+" "+i.header+" "+i.datepickerHeader+" "+i.helperClearFix+" "+i.cornerAll),a.writeAttribute("role","heading"),a.writeTagRightChar(),o!=="none"&&!!t&&a.write(this._getNavButtonHtml("prev","wijmo-wijcalendar-navbutton "+i.datepickerPrev+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(u?"e":"w")+" "+(u?this.options.wijCSS.iconArrowRight:this.options.wijCSS.iconArrowLeft),this.options.prevTooltip)),this._fillTitle(a,e),o!=="none"&&!!n&&a.write(this._getNavButtonHtml("next","wijmo-wijcalendar-navbutton "+i.datepickerNext+" "+i.cornerAll,i.icon+" ui-icon-circle-triangle-"+(u?"w":"e")+" "+(u?this.options.wijCSS.iconArrowLeft:this.options.wijCSS.iconArrowRight),this.options.nextTooltip)),a.writeEndTag("div")),a.toString()},n.prototype._formatDate=function(e,t){return o.getTicks(t)?Globalize.format(t,e,this._getCulture(null)):"&nbsp;"},n}(e.wijmoWidget);e.wijcalendar=i,i.prototype.options=t.extend(!0,{},e.wijmoWidget.prototype.options,{initSelector:":jqmData(role='wijcalendar')",wijCSS:{datepickerInline:"ui-datepicker-inline",datepicker:"ui-datepicker",datepickerCalendar:"ui-datepicker-calendar",datepickerMulti:"ui-datepicker-multi",datepickerRtl:"datepicker-rtl",datepickerOtherMonth:"ui-datepicker-other-month",prioritySecondary:"ui-priority-secondary",effectsWrapper:"ui-effects-wrapper",datepickerNextHover:"ui-datepicker-next-hover",datepickerPrevHover:"ui-datepicker-prev-hover",datepickerNext:"ui-datepicker-next",datepickerPrev:"ui-datepicker-prev",datepickerTitle:"ui-datepicker-title",datepickerWeekDay:"ui-datepicker-week-day",datepickerWeekEnd:"ui-datepicker-week-end",datepickerUnselectable:"ui-datepicker-unselectable",datepickerDaysCellOver:"ui-datepicker-days-cell-over",datepickerToday:"ui-datepicker-today",stateHighlight:"ui-state-highlight",datepickerCurrentDay:"ui-datepicker-current-day",datepickerGroup:"ui-datepicker-group",datepickerGroupFirst:"ui-datepicker-group-first",datepickerGroupLast:"ui-datepicker-group-last",datepickerRowBreak:"ui-datepicker-row-break",datepickerHeader:"ui-datepicker-header",uiIconGripDottedVertical:"ui-icon-grip-dotted-vertical",uiDatepickerWeekCol:"ui-datepicker-week-col"},wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body ui-body-c",stateDefault:"ui-btn-up-c"},culture:"",monthCols:1,monthRows:1,titleFormat:"MMMM yyyy",showTitle:!0,displayDate:undefined,dayRows:6,dayCols:7,weekDayFormat:"short",showWeekDays:!0,showWeekNumbers:!1,calendarWeekRule:"firstDay",minDate:new Date(1900,0,1),maxDate:new Date(2099,11,31),showOtherMonthDays:!0,showDayPadding:!1,selectionMode:{day:!0,days:!0},allowPreview:!1,allowQuickPick:!0,toolTipFormat:"dddd, MMMM dd, yyyy",prevTooltip:"Previous",nextTooltip:"Next",quickPrevTooltip:"Quick Previous",quickNextTooltip:"Quick Next",prevPreviewTooltip:"",nextPreviewTooltip:"",navButtons:"default",quickNavStep:12,direction:"horizontal",duration:250,easing:"easeInQuad",popupMode:!1,autoHide:!0,customizeDate:null,title:null,beforeSlide:null,afterSlide:null,beforeSelect:null,afterSelect:null,selectedDatesChanged:null}),t.wijmo.registerWidget("wijcalendar",i.prototype);var s=function(){function e(){this._html=[]}return e.prototype.writeTagLeftChar=function(){this._html[this._html.length]="<"},e.prototype.writeTagRightChar=function(){this._html[this._html.length]=">"},e.prototype.write=function(e){this._html[this._html.length]=" "+e+" "},e.prototype.writeBeginTag=function(e){this._html[this._html.length]="<"+e},e.prototype.writeEndTag=function(e){this._html[this._html.length]="</"+e+">"},e.prototype.writeFullBeginTag=function(e){this._html[this._html.length]="<"+e+">"},e.prototype.writeSelfClosingTagEnd=function(){this._html[this._html.length]="/>"},e.prototype.writeAttribute=function(e,t){if(t===undefined||t===null)return;this._html[this._html.length]=" "+e+'="',this._html[this._html.length]=t,this._html[this._html.length]='"'},e.prototype.clean=function(){this._html=[]},e.prototype.toString=function(){return this._html.join("")},e}();e.htmlTextWriter=s;var o={addDays:function(e,t){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()+t);return t&&n.getDate()===e.getDate()&&(n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n.setTime(n.getTime()+t*24*3600*1e3)),n},addMonths:function(e,t){return new Date(e.getFullYear(),e.getMonth()+t,1)},addYears:function(e,t){return this.addMonths(e,t*12)},getDate:function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},getTicks:function(e){return e.valueOf()},isSameDate:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},isSameMonth:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()},getDaysInMonth:function(e){return(new Date(e.getFullYear(),e.getMonth()+1,0)).getDate()},getWeekStartDate:function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()-(e.getDay()-t+7)%7)},getDayOfYear:function(e){var t=new Date(e.getFullYear(),0,1),n=this.getTicks(e)-this.getTicks(t),r=n/864e5;return Math.floor(r)+1},getFirstDayWeekOfYear:function(e,t){var n=this.getDayOfYear(e)-1,r=e.getDay()-n%7,i;return r=(r-t+14)%7,i=(n+r)/7,Math.floor(i)+1},getDayOfWeek:function(e,t){return(e.getDay()-t+7)%7},getWeekOfYearFullDays:function(e,t,n,r){var i=this.getDayOfYear(e)-1,s=this.getDayOfWeek(e,n)-i%7;return s=(n-s+14)%7,s&&s>=r&&(s-=7),s=i-s,s>=0?Math.floor(s/7)+1:this.getWeekOfYearFullDays(this.addDays(e,-(i+1)),t,n,r)},getWeekOfYear:function(e,t,n){switch(t){case"firstDay":return this.getFirstDayWeekOfYear(e,n);case"firstFullWeek":return this.getWeekOfYearFullDays(e,t,n,7);case"firstFourDayWeek":return this.getWeekOfYearFullDays(e,t,n,4)}return this.getFirstDayWeekOfYear(e,n)},getDateToken:function(e){return e.getFullYear()+"_"+e.getMonth()+"_"+e.getDate()}},u=function(){function e(e,t){this.calendar=e;if(t===undefined||o.isSameDate(t,new Date(1900,0,1)))t=new Date;this.displayDate=t,this.id=this.calendar._getId()+"_"+this.calendar._getMonthID(t),this.isFirst=!1,this.isLast=!1,this.showPreview=!1,this.culture=this.calendar._getCulture(),this._calcDates(this.displayDate)}return e.prototype._calcDates=function(e){var t=o.getDaysInMonth(e);this._startDateInMonth=new Date(e.getFullYear(),e.getMonth(),1),this._endDateInMonth=o.addDays(this._startDateInMonth,t-1),this._startDate=o.getWeekStartDate(this._startDateInMonth,this.culture.calendar.firstDay),this._endDate=o.addDays(this._startDate,this.calendar.options.dayRows*this.calendar.options.dayCols-1)},e.prototype._isFirstMonth=function(){var e=this.calendar.getDisplayDate();return o.isSameMonth(this._startDateInMonth,e)},e.prototype._isLastMonth=function(){var e=this.calendar.getDisplayDate();return e=new Date(e.getFullYear(),e.getMonth(),1),e=o.addMonths(e,this.calendar.options.monthCols*this.calendar.options.monthRows-1),o.isSameMonth(this._startDateInMonth,e)},e.prototype.getStartDate=function(){return this._startDate},e.prototype.getEndDate=function(){return this._endDate},e.prototype._getMonthDate=function(){return this._startDateInMonth===undefined,this._startDateInMonth},e.prototype._setMonthDate=function(e){this._calcDates(e)},e.prototype._getWeekDayText=function(e,t){t=t||"short";var n=this.culture.calendar.days,r="";switch(t){case"full":r=n.names[e];break;case"firstLetter":r=n.names[e].substring(0,1);break;case"abbreviated":r=n.namesAbbr[e];break;default:r=n.namesShort[e]}return r},e.prototype._getRowCount=function(){var e=this.calendar.options;return e.showWeekDays?e.dayRows+1:e.dayRows},e.prototype._getColCount=function(){var e=this.calendar.options;return e.showWeekNumbers?e.dayCols+1:e.dayCols},e.prototype._getDayType=function(e){var t=this.calendar.options,n=r.general,i=e.getDay(),s=i===6||i===0,u=e<t.minDate||e>t.maxDate,a=e<this._startDateInMonth||e>this._endDateInMonth,f=u||this.calendar._getDisabledDates().contains(e),l=this.calendar._getSelectedDates().contains(e),c=new Date,h=o.isSameDate(e,c),p=!1;return s&&(n|=r.weekEnd),h&&(n|=r.today),f&&(n|=r.disabled),a&&(n|=r.otherMonth),u&&(n|=r.outOfRange),l&&(n|=r.selected),p&&(n|=r.custom),a&&!t.showOtherMonthDays&&(n|=r.gap),n},e.prototype._refreshDate=function(e){if(e<this._startDate||e>this._endDate)return;var n=this.calendar.options,r=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),i=Date.UTC(this._startDate.getFullYear(),this._startDate.getMonth(),this._startDate.getDate()),s=Math.floor(Math.abs(r-i)/864e5),o=Math.floor(s/this.calendar.options.dayCols),u=Math.floor(s%this.calendar.options.dayCols),a,f,l,c;n.showWeekNumbers&&u++,n.showWeekDays&&o++,a=t("#"+this.id,this.calendar.element).get(0),a&&o<a.rows.length&&(f=a.rows[o],u<f.cells.length&&(l=f.cells[u],c=this._getDayType(e),t(l).attr("daytype",c.toString()),this.calendar._refreshDayCell(l)))},e.prototype._fillDayCell=function(e,t,n){var i=this.calendar.options,s=null,o=t.getDate().toString(),u=this.calendar._formatDate(i.toolTipFormat||"dddd, MMMM dd, yyyy",t),a=this._getDayType(t),f=this.calendar._isSelectable(a),l=this.calendar._getCellClassName(a,t,n);o=i.showDayPadding&&o.length===1?"0"+o:o,e.writeBeginTag("td"),e.writeAttribute("daytype",a.toString()),f&&(e.writeAttribute("title",u),e.writeAttribute("aria-label",u)),e.writeAttribute("date",t.toDateString()),e.writeAttribute("class",l.cssCell),e.writeAttribute("role","gridcell"),f||e.writeAttribute("aria-disabled","true"),e.writeTagRightChar(),a&r.gap?e.write("&#160;"):s&&s.content?e.write(s.content):(e.writeBeginTag("a"),e.writeAttribute("class",l.cssText),e.writeAttribute("href","#"),e.writeAttribute("onclick","return false;"),e.writeTagRightChar(),e.write(o),e.writeEndTag("a")),e.writeEndTag("td")},e.prototype.getHtml=function(e){e=!!e;var t=this.calendar.options,n=t.wijCSS,r=!!this.calendar.element.data("preview.wijcalendar"),i=new s,u,a,f,l,c,h,p,d,v,m,g,y;!e&&t.showTitle&&i.write(this.calendar._getHeaderHtml(this._startDateInMonth,this.isFirst,this.isLast)),!e&&!r&&this.showPreview&&(i.writeBeginTag("div"),i.writeAttribute("class","wijmo-wijcalendar-prevpreview-button"),i.writeAttribute("role","button"),i.writeAttribute("aria-haspopup","true"),i.writeAttribute("id","prevPreview"),i.writeTagRightChar(),i.writeBeginTag("a"),i.writeAttribute("class",n.icon+" "+n.uiIconGripDottedVertical),i.writeAttribute("href","#"),i.writeAttribute("title",t.prevPreviewTooltip),i.writeAttribute("aria-label",t.prevPreviewTooltip),i.writeAttribute("onclick","return false;"),i.writeTagRightChar(),i.write("&#160;"),i.writeEndTag("a"),i.writeEndTag("div")),i.writeBeginTag("table"),i.writeAttribute("id",this.id),i.writeAttribute("class",n.datepickerCalendar+" wijmo-wijcalendar-table"),i.writeAttribute("role","grid"),i.writeAttribute("summary",this.calendar._getTitleText(this._startDateInMonth)),i.writeAttribute("onselectstart","return false;"),i.writeTagRightChar();if(t.showWeekDays){i.writeFullBeginTag("thead"),i.writeBeginTag("tr"),i.writeTagRightChar(),t.showWeekNumbers&&(i.writeBeginTag("th"),i.writeAttribute("id",this.id+"_ms"),i.writeAttribute("class",n.uiDatepickerWeekCol+" wijmo-wijcalendar-monthselector"+(t.selectionMode.month?" wijmo-wijcalendar-selectable":"")),i.writeAttribute("role","columnheader"),i.writeTagRightChar(),!!t.selectionMode.month&&!r?(i.writeBeginTag("a"),i.writeAttribute("class",n.icon+" "+n.uiIconTriangle1Se),i.writeAttribute("style","display: block;"),i.writeSelfClosingTagEnd()):i.write("Wk"),i.writeEndTag("th")),f=this._startDate.getDay(),l=this._startDate;for(u=0;u<t.dayCols;u++)c=f===6||f===0,h=u+(t.showWeekNumbers?1:0),p=this._getWeekDayText(f,t.weekDayFormat),d=this._getWeekDayText(f,"full"),i.writeBeginTag("th"),i.writeAttribute("id",this.id+"_cs_"+h),i.writeAttribute("class",n.datepickerWeekDay+(c?" "+n.datepickerWeekEnd:"")+(t.selectionMode.weekDay?" wijmo-wijcalendar-selectable":"")),i.writeAttribute("role","columnheader"),i.writeTagRightChar(),i.writeBeginTag("span"),i.writeAttribute("title",d),i.writeAttribute("aria-label",d),i.writeTagRightChar(),i.write(p),i.writeEndTag("span"),i.writeEndTag("th"),f=(f+1)%7,l=o.addDays(l,1);i.writeEndTag("tr"),i.writeEndTag("thead")}i.writeFullBeginTag("tbody"),v=this._startDate,m=this._startDateInMonth;for(u=0;u<t.dayRows;u++){i.writeBeginTag("tr"),i.writeTagRightChar(),t.showWeekNumbers&&(g=u+(t.showWeekDays?1:0),i.writeBeginTag("td"),i.writeAttribute("id",this.id+"_rs_"+g),i.writeAttribute("class",n.uiDatepickerWeekCol+" wijmo-wijcalendar-week-num"+(t.selectionMode.weekNumber?" wijmo-wijcalendar-selectable":"")),i.writeAttribute("role","rowheader"),i.writeTagRightChar(),y=o.getWeekOfYear(m,t.calendarWeekRule,this.culture.calendar.firstDay),i.write(y),i.writeEndTag("td"),m=o.addDays(m,t.dayCols));for(a=0;a<t.dayCols;a++)this._fillDayCell(i,v,r),v=o.addDays(v,1);i.writeEndTag("tr")}return i.writeEndTag("tbody"),i.writeEndTag("table"),!e&&!r&&this.showPreview&&(i.writeBeginTag("div"),i.writeAttribute("class","wijmo-wijcalendar-nextpreview-button"),i.writeAttribute("role","button"),i.writeAttribute("aria-haspopup","true"),i.writeAttribute("id","nextPreview"),i.writeTagRightChar(),i.writeBeginTag("a"),i.writeAttribute("class",n.icon+" "+n.uiIconGripDottedVertical),i.writeAttribute("href","#"),i.writeAttribute("title",t.nextPreviewTooltip),i.writeAttribute("aria-label",t.nextPreviewTooltip),i.writeAttribute("onclick","return false;"),i.writeTagRightChar(),i.write("&#160;"),i.writeEndTag("a"),i.writeEndTag("div")),i.toString()},e}();e.wijMonthView=u;var a=function(){function e(e,t){this._calendar=e,this._optionName=t?t:"selectedDates",this._normalize()}return e.prototype.getDates=function(){return this._calendar.options[this._optionName]===undefined&&(this._calendar.options[this._optionName]=[]),this._calendar.options[this._optionName]},e.prototype.setDates=function(e){this._calendar.options[this._optionName]=e,this._normalize()},e.prototype.getCount=function(){return this.getDates().length},e.prototype.clear=function(){this.setDates([])},e.prototype.add=function(e){this.addRange(e,e)},e.prototype.remove=function(e){this.removeRange(e,e)},e.prototype.indexOf=function(e){return this.getCount()?this._findRangeBound(e,!0,!1):-1},e.prototype.contains=function(e){return this.indexOf(e)!==-1},e.prototype.removeRange=function(e,t){if(!this.getCount())return;var n=this._findRangeBound(e,!1,!0),r=this._findRangeBound(t,!1,!1),i,s,o;if(n<0||r<0)return;if(n>r)return;i=this.getDates();if(i[r]>t)return;s=n?i.slice(0,n):[],o=r>=i.length-1?[]:i.slice(r+1),this.setDates(s.concat(o))},e.prototype.addRange=function(e,t){this.removeRange(e,t);var n=this.getDates(),r=this._findRangeBound(e,!1,!0),i=r?n.slice(0,r):[],s=n.slice(r),u=[],a;e=o.getDate(e),t=o.getDate(t);for(a=e;a<=t;a=o.addDays(a,1))u[u.length]=a;this.setDates(i.concat(u.concat(s)))},e.prototype._findRangeBound=function(e,t,n){var r=this.getDates(),i=0,s=r.length,u;while(i<s){u=i+s>>1;if(o.isSameDate(e,r[u]))return u;e<r[u]?s=u:i=u+1}return t?-1:n?i:s},e.prototype._parseDate=function(e){var t;e?typeof e=="string"&&(t=e):e=new Date;if(t){t=t.replace(/-/g,"/");try{e=new Date(t),isNaN(e)&&(e=new Date)}catch(n){e=new Date}}return e},e.prototype._normalize=function(){var e=this._calendar.options[this._optionName],n=this,r;t.isArray(e)&&(r=t.map(e,function(e,t){return n._parseDate(e)}),this._calendar.options[this._optionName]=r.sort(function(e,t){return e.getTime()-t.getTime()}))},e}();e.wijDateCollection=a;var f=function(){function e(e){this.gridType="month",this.calendar=e,e&&(this.culture=e._getCulture())}return e.prototype.select=function(e,t){var n=this.calendar.getDisplayDate();switch(this.gridType){case"month":n.setMonth(t);break;case"year":n.setFullYear(t);break;case"decade":n.setFullYear(t)}this.calendar.options.displayDate=n},e.prototype.getSelectedIndex=function(){var e=this.calendar.getDisplayDate(),t=e.getFullYear(),n=Math.floor(t/10)*10-1,r=Math.floor(t/100)*100-10;switch(this.gridType){case"month":return e.getMonth();case"year":return t-n;case"decade":return Math.floor((t-r)/10)}return 0},e.prototype.getTitle=function(){var e=this.calendar.getDisplayDate(),t=e.getFullYear(),n=Math.floor(t/10)*10-1,r=Math.floor(t/100)*100-10;switch(this.gridType){case"month":return t.toString();case"year":return n+1+" - "+(n+10);case"decade":return r+10+" - "+(r+109)}return""},e.prototype.getHtml=function(e,t){e===undefined?e=this.calendar.getDisplayDate():typeof e=="boolean"&&(t=e,e=this.calendar.getDisplayDate()),t=!!t;var n=this.calendar.options,r=3,i=4,o=new s,u=n.wijCSS,a,f,l,c,h,p,d,v,m,g,y,b,w,E;n.showTitle&&!t&&o.write(this.calendar._getHeaderHtml(null,!0,!0)),a=100/r+"%",a="30%",o.writeBeginTag("table"),o.writeAttribute("class",u.datepickerCalendar+" wijmo-wijcalendar-mygrid"),o.writeAttribute("role","grid"),o.writeAttribute("onselectstart","return false;"),o.writeTagRightChar(),f=e.getFullYear(),l=e.getFullYear()*12,c=Math.floor(f/10)*10-1,h=Math.floor(f/100)*100-10,p=this.culture.calendar.months;for(d=0;d<r;d++){o.writeBeginTag("tr"),o.writeAttribute("height",a),o.writeTagRightChar();for(v=0;v<i;v++){m=d*4+v,g=!1,y=!1,b="",w=null;switch(this.gridType){case"month":e.getMonth()===m&&(g=!0),w=m,b=p.namesAbbr[m],y=l+m<n.minDate.getFullYear()*12+n.minDate.getMonth()||l+m>n.maxDate.getFullYear()*12+n.maxDate.getMonth();break;case"year":if(m===0||m===11)y=!0;w=c+m,w<n.minDate.getFullYear()||w>n.maxDate.getFullYear()?y=!0:g=f===w,b=w.toString();break;case"decade":if(m===0||m===11)y=!0;w=h+m*10,w+10<n.minDate.getFullYear()||w>n.maxDate.getFullYear()?y=!0:g=f>=w&&f<w+10,b=w.toString()+"-<br/>"+(w+9).toString()}E=u.datepickerWeekDay,y?E=E+" "+u.datepickerOtherMonth+" "+u.prioritySecondary+" "+u.datepickerUnselectable:!n.disabledState&&!n.disabled&&(E+=" wijmo-wijcalendar-day-selectable"),E+=" "+u.stateDefault+(y?" "+u.stateDisabled:"")+(g?" "+u.stateActive+" "+u.stateHighlight:""),o.writeBeginTag("td"),o.writeAttribute("class",E),o.writeAttribute("role","gridcell"),o.writeAttribute("index",m.toString()),o.writeAttribute("value",w.toString()),o.writeAttribute("other",y.toString()),o.writeTagRightChar(),o.writeBeginTag("a"),o.writeAttribute("href","#"),o.writeTagRightChar(),o.write(b),o.writeEndTag("a"),o.writeEndTag("td")}o.writeEndTag("tr")}return o.writeEndTag("table"),o.toString()},e}();e.wijMyGrid=f})(wijmo||(wijmo={}));