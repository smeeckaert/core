var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){var t=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype._create=function(){var e=this,n=e.options,r=e._getDefFill(),i=n.seriesStyles;$.each(n.seriesList,function(e,t){if(t.type==="bar")return $.extend(!0,n.axis,{x:{compass:"west"},y:{compass:"south"}}),!0;t.type==="pie"&&t.pieSeriesList&&(t.data=t.pieSeriesList)}),$.extend(!0,{compass:"east"},n.hint),n.is100Percent&&(n.is100Percent=!1),n.yAxes&&$.isArray(n.yAxes)&&n.yAxes.length>0&&(n.axis.y=n.yAxes),e._handleChartStyles(),i=n.seriesStyles,$.each(n.seriesList,function(t,n){if(e._isStockSeries(n)){var r=i[t],s=n.type,o=r.fill,u=$.extend({},r);r&&(r.highLow||(r.highLow=u),s==="hloc"?(r.open||(r.open=u),r.close||(r.close=u)):(r.fallingClose||(r.fallingClose=u),r.raisingClose||(r.raisingClose=u)))}}),n.seriesStyles=i,e._isContainsStock()&&(e.isContainsStock=!0,e._handleXData()),t.prototype._create.call(this),e.chartElement.addClass(n.wijCSS.compositechart)},n.prototype._setOption=function(e,n){e!=="is100Percent"&&t.prototype._setOption.call(this,e,n)},n.prototype._supportStacked=function(){return!0},n.prototype.destroy=function(){var e=this,n=e.chartElement,r=n.data("fields"),i=r&&r.aniBarsAttr;n.removeClass(e.options.wijCSS.compositechart),t.prototype.destroy.call(this),e._destroyRaphaelArray(i),n.data("fields",null)},n.prototype._isBarChart=function(){return!0},n.prototype._clearChartElement=function(){var e=this,n=e.options,r=e.chartElement,i=r.data("fields");i&&i.allElements&&($.each(i.allElements,function(t,n){t==="scatters"&&n.length&&$.each(n,function(e,t){t.length&&($.each(t,function(e,n){n&&n.remove&&n.remove(),t[e]=null}),n[e]=null)}),e._destroyRaphaelArray(n)}),i.allElements=null),t.prototype._clearChartElement.call(this),i&&i.ctracers&&(i.ctracers=null),e.element.removeData("plotInfos"),n.seriesTransition.enabled||i&&i.aniBarsAttr&&(i.aniBarsAttr=null)},n.prototype._bindData=function(){var e=this,t=e.options,n=t.dataSource,r=t.seriesList,i=t.data,s;$.each(r,function(t,r){var o=r.data,u,a,f,l=r.dataSource||n,c=r.type,h,p,d,v=[];l&&o&&(c==="pie"?(h=o.label,p=o.value,d=o.offset,h&&h.bind&&(h=e._getBindData(l,h.bind)),p&&p.bind&&(p=e._getBindData(l,p.bind)),d&&d.bind&&(d=e._getBindData(l,d.bind)),h&&$.isArray(h)&&h.length&&p&&$.isArray(p)&&p.length&&($.each(p,function(e,t){var n,r=0;e>=0&&e<h.length&&(n=h[e]),d&&$.isArray(p)&&d.length&&e>=0&&e<d.length&&(r=typeof d[e]=="undefined"?0:d[e]),v.push({data:t,label:n,offset:r,legendEntry:!0})}),r.data=v)):(u=o.x,a=o.y,f=o.y1,u&&u.bind?o.x=e._getBindData(l,u.bind):i&&i.x&&i.x.bind&&(s===undefined&&(s=e._getBindData(l,i.x.bind)),o.x=s),a&&a.bind&&(o.y=e._getBindData(l,a.bind)),f&&f.bind&&(o.y1=e._getBindData(l,f.bind))))})},n.prototype.getElement=function(e,t,n){var r=this.chartElement,i=r.data("fields"),s=i.chartElements;switch(e){case"bar":case"column":return s.bars[t];case"line":case"area":return s.paths[t];case"linemarkers":return s.markersSet[t];case"pie":return this._getPie(s,t,n)}return null},n.prototype._getPie=function(e,t,n){if(n!==undefined)return e["sectors"+n]?e["sectors"+n][t]:null;var r=[];return $.each(e,function(e,t){/sectors/.test(e)&&e!=="sectors"&&$.each(t,function(e,t){r.push(t)})}),r.length===0&&(r=e.sectors),r[t]},n.prototype._paintLegendIcon=function(e,n,r,i,s,o,u,a,f,l){var c=this,h=this.options,p=f.type,d,v,m=3,g=!1,y,b;return p==="line"||p==="area"||p==="spline"||p==="bezier"?(d=c.canvas.path(Raphael.format("M{0},{1}L{2},{3}",e,n+i/2,e+r,n+i/2)),s&&(h.legend.size&&h.legend.size.height&&(m=h.legend.size.height),d.attr($.extend(!0,{},s,{"stroke-width":m}))),g=!0,f.markers&&f.markers.visible&&(y=f.markers.type,b=f.markerStyle,b=$.extend({fill:s.stroke,stroke:s.stroke,opacity:1},b),s["stroke-dasharray"]&&d.attr({"stroke-width":1,"stroke-dasharray":s["stroke-dasharray"]}),y||(y="circle"),v=this.canvas.paintMarker(y,e+r/2,n+i/2,3),$.wijraphael.addClass($(v.node),Raphael.format("{0} {1} {2}",h.wijCSS.legend,h.wijCSS.legendDot,h.wijCSS.canvasObject)),v.attr(b),$(v.node).data("index",u).data("legendIndex",o),this.legendDots[o]=v)):p==="scatter"?(b=f.markerStyle,y=f.markerType,b=$.extend({fill:s.stroke,stroke:s.stroke,opacity:1},b),y||(y="circle"),d=c.canvas.paintMarker(y,e+r/2,n+i/2,3),d.attr(b),f.visible===!1&&($(l.node).data("dotOpacity",d.attr("opacity")||1),d.attr("opacity",.3)),g=!0):p==="bubble"?(b=f.markerStyle,b=$.extend({fill:s.stroke,stroke:s.stroke,opacity:1},b),f.markers&&(y=f.markers.type),y||(y="circle"),d=c.canvas.paintMarker(y,e+r/2,n+i/2,Math.min(r,i)/2),d.attr(b),g=!0):d=t.prototype._paintLegendIcon.call(this,e,n,r,i,s,o,u,a,f,l),g&&($.wijraphael.addClass($(d.node),a),$(d.node).data("legendIndex",o).data("index",u),c.legendIcons.push(d)),d},n.prototype._showHideStockSeries=function(e,t){$.each(e,function(e,n){n.hl&&n.hl[t](),n.o&&n.o[t](),n.c&&n.c[t](),n.path&&n.path[t](),n.h&&n.h[t](),n.l&&n.l[t](),n.oc&&n.oc[t]()})},n.prototype._showSerieEles=function(e){var t=e.type,n=e.eles,r=this.options.showChartLabels,i;switch(t){case"pie":n.sector&&(n.sector.show(),n.sector.shadow&&n.sector.shadow.show(),n.sector.tracker&&n.sector.tracker.show()),n.label&&n.label.show();break;case"line":case"spline":case"bezier":case"area":n.markers&&$.each(n.markers,function(e,t){i=$(t.node).data("wijchartDataObj");if(i&&i.lineSeries&&i.lineSeries.markers&&!i.lineSeries.markers.visible)return!0;t.show()}),n.dcl&&$.each(n.dcl,function(e,t){r&&t.show()}),n.path&&(i=$(n.path.node).data("wijchartDataObj"),i.visible&&(n.path.show(),n.path.shadow&&n.path.shadow.show(),n.path.area&&n.path.area.show(),n.path.tracker&&n.path.tracker.show(),$(n.path.node).data("wijchartDataObj")&&$(n.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(n.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!0})));break;case"bar":case"column":$.each(n,function(e,t){t.bar&&(t.bar.show(),t.bar.shadow&&t.bar.shadow.show(),t.bar.tracker&&t.bar.tracker.show(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!0)),t.dcl&&t.dcl.show(),t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.show()});break;case"scatter":$.each(n,function(e,t){t.show(),t.label&&t.label.show(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!0)});break;case"hloc":case"hl":case"candlestick":this._showHideStockSeries(n,"show");break;case"bubble":$.each(n,function(e,t){t.bubble&&(t.bubble.show(),t.bubble.tracker&&t.bubble.tracker.show()),t.dcl&&t.dcl.show(),t.symbol&&t.symbol.show()})}},n.prototype._hideSerieEles=function(e){var t=e.type,n=e.eles;switch(t){case"pie":n.sector&&(n.sector.hide(),n.sector.shadow&&n.sector.shadow.hide(),n.sector.tracker&&n.sector.tracker.hide()),n.label&&n.label.hide();break;case"line":case"spline":case"bezier":case"area":n.markers&&$.each(n.markers,function(e,t){t.hide()}),n.dcl&&$.each(n.dcl,function(e,t){t.hide()}),n.path&&(n.path.hide(),n.path.shadow&&n.path.shadow.hide(),n.path.area&&n.path.area.hide(),n.path.tracker&&n.path.tracker.hide(),$(n.path.node).data("wijchartDataObj")&&$(n.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(n.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!1}));break;case"bar":case"column":$.each(n,function(e,t){t.bar&&(t.bar.hide(),t.bar.shadow&&t.bar.shadow.hide(),t.bar.tracker&&t.bar.tracker.hide(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!1)),t.dcl&&t.dcl.hide(),t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.hide()});break;case"scatter":$.each(n,function(e,t){t.hide(),t.label&&t.label.hide(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!1)});break;case"hloc":case"hl":case"candlestick":this._showHideStockSeries(n,"hide");break;case"bubble":$.each(n,function(e,t){t.bubble&&(t.bubble.hide(),t.bubble.tracker&&t.bubble.tracker.hide()),t.dcl&&t.dcl.hide(),t.symbol&&t.symbol.hide()})}},n.prototype._indicatorLineShowing=function(e){var n;t.prototype._indicatorLineShowing.call(this,e),$.each(e,function(e,t){n=t.type,n==="column"||n==="bar"?t.bar.attr(t.hoverStyle):n==="marker"?t.marker.attr(t.markerHoverStyle):n==="scatter"&&(t.dot.attr(t.hoverStyle),t.dot.scale(1.5,1.5))})},n.prototype._removeIndicatorStyles=function(e){var t;$.each(e,function(e,n){t=n.type,t==="column"||t==="bar"?n.bar.attr(n.style):t==="marker"?(n.marker.attr(n.markerStyle),n.marker.transform("s1")):t==="scatter"&&(n.dot.attr(n.style),n.dot.scale(1,1))})},n.prototype._paintTooltip=function(){var e=this,n=e.chartElement,r=n.data("fields")||{},i=r.ctracers||[];t.prototype._paintTooltip.call(this),e.tooltip&&$.each(i,function(t,n){n.trackers&&n.trackers.length&&t===0&&e.tooltip.setOptions({relatedElement:n.trackers[0]})})},n.prototype._isContainsStock=function(){var e=!1,t=this,n=t.options,r=n.seriesList;return $.each(r,function(t,n){var r=n.type;if(r==="hloc"||r==="hl"||r==="candlestick")return e=!0,!1}),e},n.prototype._handleXData=function(){},n.prototype._isStockSeries=function(e){var t=e.type;return t==="hloc"||t==="hl"||t==="candlestick"},n.prototype._paintChartArea=function(){var e=this,n=e.options,r=n.data;if(e._isSeriesDataEmpty())return;$.each(n.seriesList,function(t,n){var r=n.data;e._isStockSeries(n)&&(r.y=[].concat(r.high).concat(r.low))}),t.prototype._paintChartArea.call(this),$.each(n.seriesList,function(t,n){e._isStockSeries(n)&&delete n.data.y})},n.prototype._isSeriesDataEmpty=function(){var e=this,t=e.options.seriesList;return!t||t.length===0?!0:($.each(t,function(e,t){var n=t.type;if(n==="hloc"||n==="candlestick"){if(!t.data||!t.data.x||!t.data.high||!t.data.low||!t.data.open||!t.data.close)return!0}else if(n==="hl"){if(!t.data||!t.data.x||!t.data.high||!t.data.low)return!0}else{if(n==="pie"&&(!t.data||!t.label||t.label.length===0))return!0;if(!t.data||(!t.data.x||!t.data.y)&&!t.data.xy)return!0}}),!1)},n.prototype._validateSeriesData=function(e){var t=this.options.type,n=e.data;if(t==="hl"){if(n.x===undefined&&n.high===undefined&&n.low===undefined)return!1}else if(n.x===undefined&&n.high===undefined&&n.low===undefined&&n.open===undefined&&n.close===undefined)return!1;return!0},n.prototype._isStockChart=function(){return this.isContainsStock?!0:!1},n.prototype._calculateStockParameters=function(e,t){if(e.id==="x"){var n=t.unitMinor,r=t.autoMin,i=t.autoMax,s=this._getStockAdjustment(e);this.timeUtil&&this.timeUtil.getCount&&(e.max=this.timeUtil.getCount()-1),s===0?s=n:n<s&&n!==0&&(s=Math.floor(s/n)*n),r&&(e.min-=s),i&&(e.max+=s),this._calculateMajorMinor(t,e)}},n.prototype._getStockAdjustment=function(e){var t=this,n=t.options,r=e.max,i=e.min,s,o=n.seriesList;return $.each(o,function(e,t){s?s=Math.max(t.data.x.length):s=t.data.x.length}),(r-i)/s},n.prototype._calculateMajorMinor=function(n,r){var i=this,s=i.options,o=r.bounds||i.canvasBounds,u=n.autoMajor,a=n.autoMinor,f=r.max,l=r.min,c=r.isTime,h=r.tinc,p=r.annoFormatString,d=null,v=null,m=null,g=null,y=null,b=null,w=null,E=null,S=null,x=f-l,T=0,N=0,C=0,k=0;if(!i.isContainsStock){t.prototype._calculateMajorMinor.call(this,n,r);return}if(u){S=$.extend(!0,{},s.textStyle,n.textStyle,n.labels.style);if(r.id==="x")l<0&&(l=0),f>i.timeUtil.getCount()-1&&(f=i.timeUtil.getCount()-1),f=i.timeUtil.getOATime(f),l=i.timeUtil.getOATime(l),i.formatString?p=i.formatString:(p=p||e.ChartDataUtil.getTimeDefaultFormat(f,l),i.formatString=p),d=Globalize.format($.fromOADate(f),p,i._getCulture()),v=Globalize.format($.fromOADate(l),p,i._getCulture()),y=i._text(-1e3,-1e3,d).attr(S),b=i._text(-1e3,-1e3,v).attr(S),m=y.wijGetBBox(),g=b.wijGetBBox(),y.wijRemove(),y=null,b.wijRemove(),b=null;else{w=e.ChartDataUtil.nicePrecision(x),E=w+1;if(E<0||E>15)E=0;y=i._text(-1e3,-1e3,$.round(f,E).toString()).attr(S),b=i._text(-1e3,-1e3,$.round(l,E).toString()).attr(S),m=y.wijGetBBox(),g=b.wijGetBBox(),y.wijRemove(),y=null,b.wijRemove(),b=null}m.width<g.width&&(m.width=g.width),m.height<g.height&&(m.height=g.height),i._isVertical(n.compass)?(N=o.endY-o.startY-r.vOffset-r.axisTextOffset,k=N/m.height,Number.POSITIVE_INFINITY===k?C=0:C=parseInt(k.toString(),10)):(T=o.endX-o.startX-r.vOffset-r.axisTextOffset,k=T/m.width,Number.POSITIVE_INFINITY===k?C=0:C=parseInt(k.toString(),10)),k=x,C>0&&(x/=C,r.tprec=e.ChartDataUtil.nicePrecision(x),k=e.ChartDataUtil.niceNumber(2*x,-w,!0),k<x&&(k=e.ChartDataUtil.niceNumber(x,-w+1,!1)),k<x&&(k=e.ChartDataUtil.niceTickNumber(x))),n.unitMajor=k}a&&n.unitMajor&&!isNaN(n.unitMajor)&&(n.unitMinor=n.unitMajor/2)},n.prototype._getTickText=function(e){var t=this,n=t.formatString;return t.isContainsStock?Globalize.format(t.timeUtil.getTime(e),n,t._getCulture()):e},n.prototype._AdjustAxisBounds=function(t,n){var r=this,i=r.options,s,o,u,a,f=t.max,l=t.min,c=f-l,h=e.ChartDataUtil.nicePrecision(c),p=h+1,d=t.bounds,v=$.extend(!0,{},i.textStyle,n.textStyle,n.labels.style);s=r._text(-1e3,-1e3,$.round(f,p).toString()).attr(v),o=r._text(-1e3,-1e3,$.round(l,p).toString()).attr(v),u=s.wijGetBBox(),a=o.wijGetBBox(),t.isStartAxis||(d.startY+=a.height),t.isLastAxis||(d.endY-=u.height/2)},n.prototype._initYAxisHeight=function(){var e=this,t=e.options,n=t.axis,r=n.y,i=e.canvasBounds,s=i.endX-i.startX,o=i.endY-i.startY,u=e.axisInfo,a=u.y,f=0,l=-1,c=0,h;$.isArray(r)&&($.each(r,function(e,t){t.height&&!isNaN(t.height)?f+=t.height:t.height==="auto"&&(l=e),a[e].height=t.height}),l>-1&&(a[l].height=o-f),$.each(a,function(t,n){var s=n.height;if(s===undefined)return!0;s>0&&(n.isPartAxis=!0,n.isLastAxis=parseInt(t)===r.length-1,n.isStartAxis=parseInt(t)===0),h?n.bounds={startY:h.endY,endY:h.endY+s}:n.bounds={startY:i.startY,endY:i.startY+s},n.bounds.startX=i.startX,n.bounds.endX=i.endX,e._AdjustAxisBounds(n,r[t]),n.bounds&&(h=$.extend({},n.bounds))}))},n.prototype._getDataExtreme=function(e){var n=this;return n._initYAxisHeight(),t.prototype._getDataExtreme.call(this,e)},n.prototype._paintPlotArea=function(){var t=this,n=t.options,r="seriesList",i="seriesStyles",s="seriesHoverStyles",o=n[i],u=n[s],a=t.canvasBounds,f={},l=0,c=-1,h=[],p=$.isArray(n.axis.y),d={canvas:t.canvas,tooltip:t.tooltip,bounds:a,widgetName:t.widgetName,seriesTransition:n.seriesTransition,showChartLabels:n.showChartLabels,textStyle:n.textStyle,chartLabelStyle:n.chartLabelStyle,chartLabelFormatString:n.chartLabelFormatString,shadow:n.shadow,hint:n.hint,animation:n.animation,disabled:n.disabled,culture:t._getCulture(),widget:this,wijCSS:n.wijCSS,mouseDown:function(e,n){t._trigger("mouseDown",e,n)},mouseUp:function(e,n){t._trigger("mouseUp",e,n)},mouseOver:function(e,n){t._trigger("mouseOver",e,n)},mouseOut:function(e,n){t._trigger("mouseOut",e,n)},mouseMove:function(e,n){t._trigger("mouseMove",e,n)},click:function(e,n){t._trigger("click",e,n)}},v=t.chartElement.data("fields"),m,g,y,b=t._isContainsStock();v&&(v.ctracers=[]),b&&t._handleXData(),$.each(n[r],function(e,t){var a=t.type,h={},d=a,v={},m=$.extend({},o[l]),g=$.extend({},u[l]),y=t.yAxis;if(!a||a.length===0)return!0;if(d==="spline"||d==="bezier")d="line";h=f[d],h||(a==="pie"?h=[]:h={},f[d]=h,t.hint&&(h.hint=t.hint,n.hint.content||(n.hint.content=t.hint.content),n.hint.title||(n.hint.title=t.hint.title)));if(a==="pie")return $.each(t.data,function(t,n){m=$.extend({},o[l]),g=$.extend({},u[l]),v[r]||(v[r]=[]),v[i]||(v[i]=[]),v[s]||(v[s]=[]),n.pieID=e+1,v[r].push(n),v[i].push(m),v[s].push(g),c===-1&&(c=l),l++}),v.sIndex=c,v.radius=t.radius,v.center=t.center,v.label=t.label,c=-1,h.push(v),!0;a==="column"?h.horizontal=!1:a==="bar"?h.horizontal=!0:a==="spline"?t.fitType="spline":a==="bezier"&&(t.fitType="bezier"),d==="stock"&&t.data.high&&t.data.low&&(t.data.y=[].concat(t.data.high).concat(t.data.low)),p&&(h.yAxis=y||0);if(a==="line"||a==="spline"||a==="bezier")delete m.fill,delete g.fill;h[r]||(h[r]=[]),h[i]||(h[i]=[]),h[s]||(h[s]=[]),a==="scatter"&&(h.showChartLabels=!!t.showChartLabels),t.sIndex=l,h[r].push(t),h[i].push(m),h[s].push(g),l++}),$.each(f,function(r,i){var s=i.yAxis,o=n.chartLabel;s!==undefined&&t.axisInfo.y[s].bounds&&(d.bounds=t.axisInfo.y[s].bounds);switch(r){case"pie":var u;$.each(i,function(n,i){var s=i.center,o=i.radius||50,u=s?{startX:s.x-o,startY:s.y-o,endX:s.x+o,endY:s.y+o}:{startX:a.startX+10,startY:a.startY+10,endX:a.startX+10+2*o,endY:a.startY+10+2*o};m=$.extend(!0,{},d,{bounds:u,radius:o},i),y=new e.PieChartRender(t.chartElement,m),y.render(),t.chartElement.data("fields").aniSectorAttrs=null,t.chartElement.data("fields").aniLabelAttrs=null,t._savechartData(r,i.sIndex)});break;case"bar":case"column":m=$.extend(!0,{},d,{stacked:n.stacked,axis:n.axis,clusterOverlap:n.clusterOverlap,clusterWidth:n.clusterWidth,clusterSpacing:n.clusterSpacing,is100Percent:n.is100Percent,clusterRadius:n.clusterRadius,isYTime:t.axisInfo.y[0].isTime,isXTime:t.axisInfo.x.isTime,yAxisInfo:t.axisInfo.y,yAxisIndex:s},i),y=new e.BarChartRender(t.chartElement,m),y.render(),h=[],$.each(i.seriesList,function(e,t){h.push(t.sIndex)}),t._savechartData(r,h);break;case"line":case"spline":case"bezier":case"area":g=t._getyAxisGroup(i),$.each(g,function(i,s){t.aniPathsAttr||(t.aniPathsAttr=[]),m=$.extend(!0,{},d,{axis:n.axis,isXTime:t.axisInfo.x.isTime,isYTime:t.axisInfo.y[0].isTime,type:r==="area"?"area":"line",hole:n.hole},s),m.aniPathsAttr=t.aniPathsAttr,m.chartLabelEles=t.chartLabelEles,m.axis.y=n.axis.y[i]||n.axis.y,y=new e.LineChartRender(t.chartElement,m),y.render(),h=[],$.each(s.seriesList,function(e,t){h.push(t.sIndex)}),t._savechartData(r,h,!0)});break;case"scatter":g=t._getyAxisGroup(i),$.each(g,function(i,s){m=$.extend(!0,{},d,{axis:n.axis,isXTime:t.axisInfo.x.isTime,isYTime:t.axisInfo.y[0].isTime,zoomOnHover:n.zoomOnHover},s),m.axis.y=n.axis.y[i]||n.axis.y,y=new e.ScatterChartRender(t.chartElement,m),y.render(),h=[],$.each(s.seriesList,function(e,t){h.push(t.sIndex)}),t._savechartData(r,h)});break;case"hloc":case"hl":case"candlestick":break;case"bubble":g=t._getyAxisGroup(i),o||(o={visible:n.showChartLabels,style:n.chartLabelStyle}),$.each(g,function(i,s){m=$.extend(!0,{},d,{axis:n.axis,isXTime:t.axisInfo.x.isTime,isYTime:t.axisInfo.y[0].isTime,xAxisInfo:t.axisInfo.x,yAxisInfo:t.axisInfo.y,chartLabel:o,minimumSize:n.minimumSize||5,maximumSize:n.maximumSize||20,sizingMethod:n.sizingMethod||"diameter"},s),m.axis.y=n.axis.y[i]||n.axis.y,m.yAxisInfo=t.axisInfo.y[i]||t.axisInfo.y[0],y=new e.BubbleChartRender(t.chartElement,m),y.render(),h=[],$.each(s.seriesList,function(e,t){h.push(t.sIndex)}),t._savechartData(r,h)})}}),t.chartElement.data("fields").seriesEles=null,t._bindtooltip()},n.prototype._savechartData=function(e,t,n){var r=this,i=r.chartElement.data("fields"),s=i.seriesEles,o=i.allElements||{},u,a=t;$.isArray(a)&&(a=0),$.each(s,function(n,i){$.isArray(t)?(r.seriesEles[t[a]]={eles:i,type:e},a++):(r.seriesEles[a]={eles:i,type:e},a++)}),n||(u=i.ctracers||[],u.push({trackers:i.trackers,type:e}),i.ctracers=u),i&&i.chartElements&&$.each(i.chartElements,function(e,t){r._copyElements(o,e,t)}),i.allElements=o},n.prototype._copyElements=function(e,t,n){var r;n&&$.isArray(n)?(r=e[t]||[],e[t]=r.concat(n)):n&&(r=e[t]||[],r.concat([n]))},n.prototype._getyAxisGroup=function(e){var t={};return $.each(e.seriesList,function(n,r){var i=r.yAxis||0;t[i]||(t[i]={seriesList:[],seriesStyles:[],seriesHoverStyles:[]}),t[i].seriesList.push(r),t[i].seriesStyles.push(e.seriesStyles[n]),t[i].seriesHoverStyles.push(e.seriesHoverStyles[n])}),t},n.prototype._bindtooltip=function(){var e=this,t=e.widgetName,n=e.chartElement.data("fields");n&&n.ctracers&&$.each(n.ctracers,function(e,t){var n=t.type;n!=="hloc"&&t.trackers&&t.trackers.toFront()}),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker","mouseover."+t,$.proxy(e._tooltipMouseOver,e)),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker","mouseout."+t,$.proxy(e._tooltipMouseOut,e)),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker","mousemove."+t,$.proxy(e._tooltipMouseMove,e))},n.prototype._tooltipMouseOver=function(e){var t=e.target,n=this,r=n.tooltip,i=n.options.hint,s=null,o=i.title,u=i.content,a=i.style,f=$.isFunction(o),l=$.isFunction(u),c,h,p,d;p=$(n.canvas.canvas.parentNode).offset();if(n.indicatorLine)return;$(t).data("owner")&&(t=$(t).data("owner")),t=$(t),c=t.data("wijchartDataObj");if(n.tooltip){s=r.getOptions();if(f||l)f&&(s.title=$.proxy(o,c)),l&&(s.content=$.proxy(u,c));if(c.type==="line"||c.type==="marker"){c.type==="marker"&&(c=c.lineSeries);if(c.path.removed)return;if(n.hoverLine!==c||n.hoverLine===null)n.isNewLine=!0,n.hoverLine&&(n.hoverLine.path.removed||(n.hoverLine.path.wijAttr(n.hoverLine.lineStyle),n.hoverPoint&&!n.hoverPoint.isSymbol&&(n.hoverPoint.marker.wijAttr(n.hoverPoint.markerStyle),n.hoverPoint.marker.transform("s1")))),c.lineHoverStyle&&c.path.wijAttr(c.lineHoverStyle),n.hoverLine=c,n.hoverPoint=null,n.hoverVirtualPoint=null}else c.type==="scatter"||i.relativeTo==="element"?(n._clearHoverState(),c.type==="scatter"?h=c.dot.getBBox():t[0]&&t[0].raphael&&t[0].raphaelid&&(d=n.canvas.getById(t[0].raphaelid),d&&(h=d.getBBox())),s.style.stroke=a.stroke||t.attr("stroke"),h&&n.tooltip.showAt({x:h.x+h.width/2,y:h.y},e)):(n._clearHoverState(),s.style.stroke=a.stroke||t.attr("stroke"),n.tooltip.showAt({x:e.pageX-p.left,y:e.pageY-p.top},e))}},n.prototype._tooltipMouseMove=function(e){var t=this,n=e.target,r,i=t.options.hint,s=$(t.canvas.canvas.parentNode).offset();$(n).data("owner")&&(n=$(n).data("owner")),n=$(n),r=n.data("wijchartDataObj"),t.tooltip&&!this.indicatorLine&&r.type!=="line"&&r.type!=="marker"&&r.type!=="scatter"&&i.relativeTo!=="element"&&t.tooltip.showAt({x:e.pageX-s.left,y:e.pageY-s.top},e)},n.prototype._tooltipMouseOut=function(e){var t=this,n=e.target,r;$(n).data("owner")&&(n=$(n).data("owner")),n=$(n),r=n.data("wijchartDataObj"),r.type!=="line"&&r.type!=="marker"&&!t.indicatorLine&&t.tooltip&&t.tooltip.hide()},n.prototype._mouseMoveInsidePlotArea=function(e,n){var r=this,i=r.tooltip,s=r.options.hint,o,u,a=0,f,l,c,h,p=null,d=null,v=null,m=s.title,g=s.content,y=$.isFunction(m),b=$.isFunction(g),w=0,E;i&&(v=i.getOptions());if(r.hoverLine&&!r.indicatorLine){E=r.hoverLine,r.isNewLine&&(s.enable&&i&&i.hide(),r.isNewLine=!1),o=E.lineMarkers,u=E.virtualMarkers,a=-1,f={x:0,y:0};if(o&&o.length){$.each(o,function(e,t){if(t.removed)return!0;var r=t.wijGetBBox(),i=r.x+r.width/2,s=Math.abs(i-n.left);if(e===0||s<w)w=s,a=e,f={x:i,y:r.y+r.height/2}});if(r.hoverPoint&&r.hoverPoint.index===a)return;if(a>-1){if(o[a].removed)return;l=$(o[a].node).data("wijchartDataObj"),l&&(r.hoverPoint&&!r.hoverPoint.isSymbol&&(r.hoverPoint.removed||(r.hoverPoint.marker.wijAttr(r.hoverPoint.markerStyle),r.hoverPoint.marker.transform("s1"))),l.isSymbol||l.marker.removed||l.marker.wijAttr(l.markerHoverStyle)),r.hoverPoint=l,r.hoverVirtualPoint=u[a]}}else{$.each(u,function(e,t){var r=Math.abs(t.x-n.left);if(e===0||r<w)w=r,a=e,f={x:t.x,y:t.y}});if(r.hoverVirtualPoint&&r.hoverVirtualPoint.index===a)return;a>-1&&(r.hoverPoint=null,r.hoverVirtualPoint=u[a])}if(i){d=r.hoverVirtualPoint,c=d.valX,h=d.valY;if(y||b)y&&(v.title=function(){var e={pointIndex:a,lineIndex:E.index,x:c,y:h,label:E.label,data:d,fmt:m},t=$.proxy(e.fmt,e),n=t();return n}),b&&(v.content=function(){var e={pointIndex:a,lineIndex:E.index,x:c,y:h,label:E.label,data:d,fmt:g},t=$.proxy(e.fmt,e),n=t();return n});p=$.extend({stroke:E.path.attr("stroke")},s.style),v.style.stroke=p.stroke,i.showAt(f)}}t.prototype._mouseMoveInsidePlotArea.call(this,e,n)},n.prototype._mouseDownInsidePlotArea=function(e,n){t.prototype._mouseDownInsidePlotArea.call(this,e,n),this._clearHoverState(!0)},n.prototype._mouseMoveOutsidePlotArea=function(e,n){var r=this;r._clearHoverState(),t.prototype._mouseMoveOutsidePlotArea.call(this,e,n)},n.prototype._clearHoverState=function(e){var t=this,n=t.tooltip,r=t.options.hint;t.hoverLine&&(r.enable&&n&&!e&&n.hide(),t.hoverLine.path.removed||(t.hoverLine.path.wijAttr(t.hoverLine.lineStyle),t.hoverPoint&&!t.hoverPoint.isSymbol&&(t.hoverPoint.marker.wijAttr(t.hoverPoint.markerStyle),t.hoverPoint.marker.transform("s1")))),t.hoverLine=null,t.hoverPoint=null,t.hoverVirtualPoint=null},n.prototype._getTooltipText=function(e,t){return""},n.prototype._calculateParameters=function(e,n){var r=this,i=!1,s,o;t.prototype._calculateParameters.call(this,e,n);if(r.isContainsStock){r._calculateStockParameters(e,n);return}$.each(r.options.seriesList,function(e,t){if(t.type==="column"||t.type==="bar")return i=!0,!1});if(!i)return;e.id==="x"&&(s=n.unitMinor,o=r._getBarAdjustment(e),o===0?o=s:s<o&&s!==0&&(o=Math.floor(o/s)*s),e.min-=o,e.max+=o,r._calculateMajorMinor(n,e))},n.prototype._getBarAdjustment=function(e){var t=0,n=this.options,r=e.max,i=e.min,s=0;return $.each(n.seriesList,function(e,n){if(n.type==="pie")return!0;if(n.data.x===undefined||n.data.y===undefined)return!0;s=n.data.x.length,t<s&&(t=s)}),t>1?(r-i)/t*n.clusterWidth*.0125:t===1?(i===0&&r===1&&(i=-1,e.min=i),(r-i)*.0125):0},n}(e.WijChartCore);e.WijCompositeChart=t,t.prototype.widgetEventPrefix="wijcompositechart",t.prototype.options=$.extend(!0,{},e.WijChartCore.prototype.options,{initSelector:":jqmData(role='wijcompositechart')",wijCSS:{compositechart:"wijmo-wijcompositechart",barLabel:"wijbarchart-label",barElement:"wijbarchart",barTracker:"bartracker",bubbleElement:"wijbubblechart-bubble",bubbleTracker:"bubbletracker",bubbleLabel:"wijbubblechart-label",bubbleSymbol:"wijbubblechart-symbol",scatterElement:"wijscatterchart",pieLabel:"wijpiechart-label",pieElement:"wijpiechart",pieTracker:"pietracker",lineLabel:"wijlinechart-label",lineElement:"wijlinechart",areaElement:"wijlinechart-area",lineTracker:"linetracker",canvasMarker:"wijchart-canvas-marker"},stacked:!1,clusterOverlap:0,clusterWidth:85,clusterRadius:0,clusterSpacing:0,seriesList:[],animation:{enabled:!0,duration:400,easing:">"},seriesTransition:{enabled:!0,duration:400,easing:">"},mouseDown:null,mouseUp:null,mouseOver:null,mouseOut:null,mouseMove:null,click:null}),$.wijmo.registerWidget("wijcompositechart",t.prototype)})(wijmo||(wijmo={}));