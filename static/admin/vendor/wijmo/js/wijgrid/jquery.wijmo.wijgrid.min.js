var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var wijmo;(function(b){var c=jQuery;var a=(function(e){__extends(d,e);function d(){e.apply(this,arguments);this._dataOffset=0;this._scrollingState={x:null,y:null,index:0};this._windowResizeTimer=0}d.prototype._createWidget=function(f,g){var h=f&&(b).data.util.isClassInstance(f.data)&&!((typeof wijdatasource==="function")&&(f.data instanceof wijdatasource))&&f.data;if(h){delete f.data}e.prototype._createWidget.apply(this,arguments);if(h){this.option("data",h)}};d.prototype._create=function(){var g=this;if(!this.element.is("table")){throw"invalid markup"}this._windowResizeTimer=0;this._dataOffset=0;this._scrollingState={x:null,y:null,index:0};this._initialized=false;this._destroyed=false;this._rendered=false;this._eventUID=undefined;this._dataViewWrapper=undefined;this._originalHtml=undefined;this._originalAttr=undefined;this._originalCssText=undefined;this._autoHeight=undefined;this._autoWidth=undefined;this._renderCounter=0;this.$superPanelHeader=undefined;this.$topPagerDiv=undefined;this.$bottomPagerDiv=undefined;this.$groupArea=undefined;this.__uid=undefined;this._wijDataView=undefined;this.outerDiv=undefined;this.sketchTable=undefined;this.cellFormatter=undefined;this.rowStyleFormatter=undefined;this.cellStyleFormatter=undefined;this._eventUID=b.grid.getUID();this._spinnerIsActivated=false;this.options=c.extend(true,{},this.options);if(window.wijmoApplyWijTouchUtilEvents){c=window.wijmoApplyWijTouchUtilEvents(c)}if(c.isFunction(window.wijmoASPNetParseOptions)){window.wijmoASPNetParseOptions(this.options)}this._initialized=false;this._destroyed=false;var h=this.element[0].style.height,f=this.element[0].style.width;this._dataViewWrapper=new b.grid.dataViewWrapper(this);this._originalHtml=this.element.html();this._originalAttr={};this._originalCssText=this.element[0].style.cssText;this.element.addClass("wijmo-wijgrid-root");this.element.wrap('<div class="'+this.options.wijCSS.widget+" wijmo-wijgrid "+this.options.wijCSS.content+" "+this.options.wijCSS.cornerAll+'"></div>');this.outerDiv=this.element.parent();if(h){this.outerDiv.css("height",this.element[0].style.height)}if(h!==""&&h!=="auto"){this._autoHeight=false}else{this._autoHeight=true}if(f){this.outerDiv.css("width",this.element[0].style.width)}if(f!==""&&f!=="auto"){this._autoWidth=false}else{this._autoWidth=true}this.element.css({height:"",width:""});if(this.options.disabled){this.disable()}this.cellFormatter=new b.grid.cellFormatterHelper();this.rowStyleFormatter=new b.grid.rowStyleFormatterHelper(this);this.cellStyleFormatter=new b.grid.cellStyleFormatterHelper(this);this._field("viewRenderBounds",{start:0,end:0});if(this._allowVirtualScrolling()){this._field("viewRenderBounds").start=this._scrollingState.index;if(this._serverSideVirtualScrolling()){this._dataOffset=this._scrollingState.index}}if(this.element.wijAddVisibilityObserver){this.element.wijAddVisibilityObserver(function(){if(g._initialized&&!g._destroyed){g.setSize()}},"wijgrid")}this._renderCounter=0};d.prototype._destroy=function(){var g,f=this;try{this._view().dispose();this._detachEvents(true);if(g=this._field("resizer")){g.dispose()}if(g=this._field("frozener")){g.dispose()}if(g=this._field("selectionui")){g.dispose()}if(g=this._field("dragndrop")){g.dispose()}this._dataViewWrapper.dispose();b.grid.remove$dataByPrefix(this.element,this._data$prefix);if(this.element.wijRemoveVisibilityObserver){this.element.wijRemoveVisibilityObserver()}this.element.insertBefore(this.outerDiv);this.outerDiv.remove();this.element.html(this._originalHtml);c.each(this._originalAttr,function(h,i){if(i===undefined){f.element.removeAttr(h)}else{f.element.attr(h,i)}});this.element.removeClass("wijmo-wijgrid-root");this.element[0].style.cssText=this._originalCssText}finally{this._destroyed=true}};d.prototype._init=function(){this.$superPanelHeader=null;this.$topPagerDiv=null;this.$bottomPagerDiv=null;this.$groupArea=null;this._field("closestCulture",Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"));if(!this.options.data){if(!this._field("thead")){this._field("thead",b.grid.readTableSection(this.element,1))}if(!this._field("tfoot")){this._field("tfoot",b.grid.readTableSection(this.element,3))}}this._initialized=this._initialized||false;this.ensureControl(true)};d.prototype._setOption=function(h,j){var k=this["_preset_"+h],g=this.options[h],i,f;if(k!==undefined){j=k.apply(this,[j,g])}i=(j!==g);e.prototype._setOption.apply(this,[h,j]);if(i){f=this["_postset_"+h];if(f!==undefined){f.apply(this,[j,g])}}};d.prototype.columns=function(){return this._field("columns")||[]};d.prototype.currentCell=function(h,f){var j,g=this._view(),i=this._rows();if(arguments.length===0){j=this._field("currentCell");if(!j){this._field("currentCell",j=b.grid.cellInfo.outsideValue)}return j}else{j=(arguments.length===1)?(h)._clone():new b.grid.cellInfo(h,f);if(!j.isEqual(b.grid.cellInfo.outsideValue)){if(!j._isValid()){throw"invalid arguments"}j._clip(this._getDataCellsRange());if(j.rowIndex()>=0){if(!(g._getRowInfo(i.item(j.rowIndex())).type&b.grid.rowType.data)){return}}}j._setGridView(this);this._changeCurrentCell(null,j);return this._field("currentCell")}};d.prototype.data=function(){return this._dataViewWrapper.dataView().getSource()};d.prototype.dataView=function(){return this._dataViewWrapper.dataView()};d.prototype.doRefresh=function(f){if(!c.isPlainObject(f)){f={}}var m,h=this,i=b.grid.EXPANDO,g=f&&f.virtualScrollData;if(!this._initialized){try{this._prepareColumnOptions(true,true)}catch(j){throw j}finally{this._ownerise(true);this._initialized=true}}else{}if(!g){this._rebuildLeaves();var l=this._dataViewWrapper.data();var k=this._dataViewWrapper.dataView();c.each(this._field("leaves"),function(){this._totalsValue=(l.totals)?l.totals[this.dataKey]:undefined});this.sketchTable=[];if(l.data&&l.data.length){m=this._field("leaves");c.each(l.data,function(n,o){h.sketchTable.push(h._buildSketchRow(o,m))})}else{if(l.emptyData){m=this._field("visibleLeaves");c.each(l.emptyData,function(n,o){h.sketchTable.push(h._buildSketchRowEmptyDataItem(o,m,n===l.emptyData.length-1))})}}}this._onRendering(f);if(!g){this._refresh(f)}else{this._refreshVirtual(f)}this._onRendered(f);if(f&&c.isFunction(f.afterRefresh)){f.afterRefresh.apply(this,[f])}};d.prototype.beginEdit=function(){return this._beginEditInternal(null)};d.prototype.endEdit=function(){return this._endEditInternal(null)};d.prototype.ensureControl=function(g,f){this._loading();if(!c.isPlainObject(f)){f={data:null,afterRefresh:null,beforeRefresh:null}}f._wijgridMarker=true;if(this._initialized){this._convertWidgetsToOptions()}else{this._prepareColumnOptions(this._dataViewWrapper.isDataLoaded(),false);if(!this._dataViewWrapper.isOwnDataView()){(new b.grid.settingsManager(this)).MapDVToWG()}}this._ownerise(true);if(this._initialized){if(f&&c.isFunction(f.beforeRefresh)){f.beforeRefresh.apply(this)}}this._field("allowVirtualScrolling",null);if(g===true){this._dataViewWrapper.load(f)}else{this.doRefresh(f);this._loaded()}};d.prototype.getCellInfo=function(g){var f=null;if(g&&(g=this._findUntilOuterDiv(g,{td:true,th:true}))){f=this._view().getAbsoluteCellInfo(g)}return f};d.prototype.getFilterOperatorsByDataType=function(f){return(new b.grid.filterOperatorsCache(this)).getByDataType(f||"string")};d.prototype.pageCount=function(){if(this._customPagingEnabled()){return Math.ceil(this.options.totalRows/this.options.pageSize)||1}return this.options.allowPaging?(this._dataViewWrapper.dataView()).pageCount():1};d.prototype._serverShaping=function(){return false};d.prototype._pageIndexForDataView=function(){return this.options.pageIndex};d.prototype.setSize=function(k,h){var i=this._view(),j={type:"",hScrollValue:null,vScrollValue:null},l=this.outerDiv,m=this._field("frozener"),g=this._field("visibleLeaves"),f=[];if(i&&i.getScrollValue){j=i.getScrollValue()}if(k||(k===0)){this._autoWidth=false;l.width(k)}if(h||(h===0)){this._autoHeight=false;l.height(h)}c.each(g,function(o,n){var p=i.getHeaderCell(o),q=i.getJoinedCols(o);c(p).css("width","");c.each(q,function(s,r){c(r).css("width","")})});this._view().updateSplits(j);if(m){m.refresh()}};d.prototype.selection=function(){var f=this._field("selection");if(!f){this._field("selection",f=new b.grid.selection(this))}return f};d.prototype._onDataViewCurrentPositionChanged=function(i,g){var f=this._dataViewWrapper.currentPosition(),j=new b.grid.cellInfo(this.currentCell().cellIndex(),this._dataViewDataRowIndexToGrid(f),null),h=this.selection();if(j.rowIndex()<0){j.cellIndex(-1)}else{if(j.cellIndex()<0){j.cellIndex(0)}}j=this.currentCell(j);h.beginUpdate();h.clear();if(j&&j._isValid()){h._selectRange(new b.grid.cellInfoRange(j,j),false,false,0,null)}h.endUpdate()};d.prototype._resetDataProperties=function(){this.options.pageIndex=0;var f=this._field("viewRenderBounds");f.start=f.end=0};d.prototype._onDataViewLoading=function(){this._activateSpinner();this._trigger("dataLoading")};d.prototype._onDataViewReset=function(f){(new b.grid.settingsManager(this)).MapDVToWG();this._trigger("dataLoaded");this.doRefresh(f);this._loaded()};d.prototype._onDataViewLoaded=function(){};d.prototype._loading=function(){this._activateSpinner();this._trigger("loading")};d.prototype._loaded=function(){this._deactivateSpinner();this._trigger("loaded")};d.prototype._buildSketchRow=function(q,j){var g,k,l,n,o,h,f=[],p=b.data.Expando.getFrom(q.values,false),m=p?p[b.grid.EXPANDO]:null;for(g=0,k=j.length;g<k;g++){l=j[g];if(b.grid.validDataKey(l.dataKey)){n=(m&&m.cellsAttributes)?m.cellsAttributes[l.dataKey]:{};o=this._dataViewWrapper.getValue(q.values,l.dataKey);f.push({value:this._parse(l,o),__attr:n||{},__style:{}})}}(f).originalRowIndex=q.originalRowIndex;(f).rowType=b.grid.rowType.data;if(q.originalRowIndex%2!==0){(f).rowType|=b.grid.rowType.dataAlt}(f).__style={};(f).__attr=(m&&m.rowAttributes)?m.rowAttributes:{};return f};d.prototype._buildSketchRowEmptyDataItem=function(g,m,l){var h,f,k=[],j=m.length;for(h=0,f=g.length;h<f;h++){k.push({html:g[h],__attr:{colSpan:(j>0&&l)?j:1},__style:{}})}(k).rowType=b.grid.rowType.emptyDataRow;(k).__style={};(k).__attr={};return k};d.prototype._prepareColumnOptions=function(j,i){b.grid.traverse(this.options.columns,function(l){l.isBand=(c.isArray(l.columns)||(l.clientType==="c1band"));l._originalDataKey=l.dataKey;l._originalHeaderText=l.headerText});new b.grid.bandProcessor().getVisibleHeight(this.options.columns,true);var k=[],h=this._originalHeaderRowData(),g=this._originalFooterRowData(),f=(this.options.columnsAutogenerationMode||"").toLowerCase();if(j){b.grid.columnsGenerator.generate(f,this._dataViewWrapper.getFieldsInfo(),this.options.columns)}b.grid.setTraverseIndex(this.options.columns);b.grid.traverse(this.options.columns,function(l){l.isBand=(c.isArray(l.columns)||(l.clientType==="c1band"));b.grid.shallowMerge(l,b.c1basefield.prototype.options);if(!l.isBand){b.grid.shallowMerge(l,b.c1field.prototype.options);l.groupInfo=l.groupInfo||{};b.grid.shallowMerge(l.groupInfo,b.c1field.prototype.options.groupInfo);if(!l.clientType){l.clientType="c1field"}}else{l.clientType="c1band"}if(l.isLeaf&&!l.isBand){k.push(l)}});this._field("leaves",k);if(j){c.each(k,c.proxy(function(n,l){var m=(typeof(l.dataKey)==="number")?l.dataKey:n;if(f==="merge"||l.dynamic===true){if(l.headerText===undefined){if(this._dataViewWrapper.isBoundedToDOM()&&h&&(m<h.length)){l.headerText=c.trim(h[m])}else{if(b.grid.validDataKey(l.dataKey)){l.headerText=""+l.dataKey}}}}if(this._dataViewWrapper.isBoundedToDOM()&&g&&(m<g.length)){l._footerTextDOM=c.trim(g[m])}},this))}};d.prototype._rebuildLeaves=function(){var f=[],h=[],g;if(this.options.showRowHeader){g=b.grid.createDynamicField({clientType:"c1basefield",dataIndex:-1,travIdx:-1,parentVis:true,allowMoving:false,allowSizing:false,allowSort:false,isRowHeader:true});g.owner=this;f.push(g)}c.each(this.options.columns,function(i,j){f.push(j)});this._columnsHeadersTable(new b.grid.bandProcessor().generateSpanTable(f,h));this._field("leaves",h);this._onLeavesCreated()};d.prototype._onLeavesCreated=function(){var k=this._field("leaves"),i=this._dataViewWrapper.getFieldsInfo(),j,h=0,f=0,g=this;this._field("visibleLeaves",c.grep(k,function(l,m){l.leavesIdx=m;if(b.grid.validDataKey(l.dataKey)){l.dataIndex=h++}else{l.dataIndex=-1}if(!l.isBand){j=i[l.dataKey];if(j){l._underlyingDataType=j.type;l._underlyingDataFormatString=j.format}if(c.isFunction(l.dataParser)){l.dataParser=new l.dataParser()}}if(l.parentVis){l.visLeavesIdx=f++;return true}return false}))};d.prototype._allowVirtualScrolling=function(){var f=this._field("allowVirtualScrolling");if(!f){f=this._field("allowVirtualScrolling",!this.options.allowPaging&&this.options.allowVirtualScrolling&&(this.options.staticRowIndex<0)&&(this.options.scrollMode!=="none")&&!this._hasMerging())}return f};d.prototype._dragndrop=function(g){if(typeof g==="undefined"){g=false}var f=this._field("dragndrop");if(!f&&g){this._field("dragndrop",f=new b.grid.uiDragndrop(this))}return f};d.prototype._headerRows=function(){return this._view().headerRows()};d.prototype._filterRow=function(){return this._view().filterRow()};d.prototype._rows=function(){return this._view().bodyRows()};d.prototype._localizeFilterOperators=function(g){var f=this,h=new b.grid.filterOperatorsCache(this);c.each(g,function(j,l){if(l.name){var k=h.getByName(l.name);if(k){k.displayName=l.displayName}}})};d.prototype._selectionui=function(f){var g=this._field("selectionui");if(!g&&f){this._field("selectionui",g=new b.grid.uiSelection(this))}return g};d.prototype._postset_allowColMoving=function(h,g){var f=this;c.each(this.columns(),function(i,j){if(h){f._dragndrop(true).attach(j)}else{f._dragndrop(true).detach(j)}});c.each(this._field("groupedWidgets"),function(i,j){if(h){f._dragndrop(true).attach(j)}else{f._dragndrop(true).detach(j)}})};d.prototype._postset_allowSorting=function(g,f){this.ensureControl(false)};d.prototype._postset_columns=function(g,f){this._initialized=false;this.ensureControl(true)};d.prototype._postset_allowPaging=function(g,f){this.ensureControl(true)};d.prototype._postset_culture=function(g,f){throw"read-only"};d.prototype._postset_customFilterOperators=function(g,f){var h=this._dataViewWrapper.dataView()};d.prototype._postset_data=function(g,f){this._ownerise(false);b.grid.traverse(this.options.columns,function(j,i){if(j.dynamic){var h=c.inArray(j,i);if(h>=0){i.splice(h,1)}}else{j.dataKey=j._originalDataKey;j.headerText=j._originalHeaderText}});this._initialized=false;if(this._dataViewWrapper){this._dataViewWrapper.dispose()}this._dataViewWrapper=new b.grid.dataViewWrapper(this);this.ensureControl(true)};d.prototype._postset_disabled=function(i,h){var g=this,f=this._view();b.grid.iterateChildrenWidgets(this.outerDiv,function(j,k){if(k!==g){k.option("disabled",i)}});if(f){f.ensureDisabledState()}};d.prototype._postset_groupIndent=function(g,f){this.ensureControl(false)};d.prototype._postset_groupAreaCaption=function(h,g){var f=this._field("groupedColumns");if(this.$groupArea&&(!f||!f.length)){this.$groupArea.html(h||"&nbsp;")}};d.prototype._postset_highlightCurrentCell=function(g,f){var h=this.currentCell();if(h&&h._isValid()){this._highlightCellPosition(h,g)}};d.prototype._preset_pageIndex=function(j,h){if(isNaN(j)){throw"out of range"}var g=this.pageCount(),i=function(k){if(k>g-1){k=g-1}if(k<0){k=0}return k},f;j=i(j);if(this.options.allowPaging&&j!==h){f={newPageIndex:j};if(!this._onPageIndexChanging(f)){j=h}else{j=i(f.newPageIndex)}}return j};d.prototype._postset_pageIndex=function(h,g){if(this.options.allowPaging){var f={newPageIndex:h};if(this._customPagingEnabled()){this._convertWidgetsToOptions();this._onPageIndexChanged(f)}else{this.ensureControl(true,{afterRefresh:function(){this._onPageIndexChanged(f)}})}}};d.prototype._preset_pageSize=function(g,f){if(isNaN(g)){throw"out of range"}if(g<=0){g=1}return g};d.prototype._postset_pageSize=function(g,f){this._resetDataProperties();if(this.options.allowPaging&&!this._customPagingEnabled()){this.ensureControl(true)}};d.prototype._postset_pagerSettings=function(g,f){this.ensureControl(false)};d.prototype._postset_scrollMode=function(g,f){this.ensureControl(false)};d.prototype._postset_selectionMode=function(i,g){var h=this.selection(),j=this.currentCell(),f=this.selection().selectedCells().length();h.beginUpdate();h.clear();if(j&&j._isValid()&&f){h._selectRange(new b.grid.cellInfoRange(j,j),false,false,0,null)}h.endUpdate();this._view().toggleDOMSelection(i==="none")};d.prototype._postset_showFilter=function(g,f){this.ensureControl(false)};d.prototype._postset_showGroupArea=function(g,f){this.ensureControl(false)};d.prototype._postset_showRowHeader=function(g,f){this.ensureControl(false)};d.prototype._postset_staticRowIndex=function(){if(this.options.scrollMode!=="none"){this.ensureControl(false)}};d.prototype._postset_staticColumnIndex=function(){if(this.options.scrollMode!=="none"){this.ensureControl(false)}};d.prototype._postset_allowVirtualScrolling=function(g,f){this.ensureControl(false)};d.prototype._preset_allowVirtualScrolling=function(g,f){if(isNaN(g)||g<0){throw"out of range"}return g};d.prototype._activateSpinner=function(){if(!this._spinnerIsActivated){var g=this.options.wijCSS,f=this.outerDiv.append('<div class="wijmo-wijgrid-overlay '+g.overlay+'"></div><span class="wijmo-wijgrid-loadingtext '+g.content+" "+g.cornerAll+'"><span class="'+g.icon+' ui-icon-clock"></span>'+this.options.loadingText+"</span>").find("> .wijmo-wijgrid-loadingtext");f.position({my:"center",at:"center center",of:this.outerDiv,collision:"none"});this._spinnerIsActivated=true}};d.prototype._customPagingEnabled=function(){return this.options.allowPaging&&this.options.totalRows>=0};d.prototype._deactivateSpinner=function(){if(this._spinnerIsActivated){try{this.outerDiv.find("> .wijmo-wijgrid-overlay, > .wijmo-wijgrid-loadingtext").remove()}finally{this._spinnerIsActivated=false}}};d.prototype._columnWidgetsFactory=function(f,i){var g,h=i.clientType;if(!h&&i.isBand){h="c1band"}i=c.extend({},i,{disabled:this.options.disabled});try{c.data(f[0],"wijgridowner",this);switch(h){case"c1basefield":g=f.c1basefield(i);break;case"c1band":g=f.c1band(i);break;default:g=f.c1field(i)}}finally{c.removeData(f[0],"wijgridowner")}return g};d.prototype._convertWidgetsToOptions=function(){if(this._initialized&&this._mergeWidgetsWithOptions){this._ownerise(false);this._widgetsToOptions();this._ownerise(true)}};d.prototype._field=function(f,g){return b.grid.dataPrefix(this.element,this._data$prefix,f,g)};d.prototype._removeField=function(f){var g=this._data$prefix+f;this.element.removeData(g)};d.prototype._prepareTotalsRequest=function(g){var i=this._field("leaves"),f,h;if(!i||!this.options.showFooter){return[]}f=c.map((i),function(k,j){if(!k.isBand&&b.grid.validDataKey(k.dataKey)&&k.aggregate&&k.aggregate!=="none"){if(g){return[{column:k,aggregate:k.aggregate}]}else{return[{dataKey:k.dataKey,aggregate:k.aggregate}]}}return null});return f};d.prototype._widgetsToOptions=function(){var f=b.grid.flatten(this.options.columns);c.each(this.columns(),function(i,h){delete h.options.columns;var g=f[h.options.travIdx];c.extend(true,g,h.options);g.filterValue=h.options.filterValue;g.filterOperator=h.options.filterOperator})};d.prototype._recreateColumnWidgets=function(){c.each(this.columns(),function(i,p){p.destroy()});var k=[],m=this._headerRows(),o,l,n,j,h,f,g;if(m&&m.length()){o=[];b.grid.traverse(this.options.columns,function(i){if(i.parentVis){o.push(i)}});for(l=0,n=o.length;l<n;l++){j=o[l];h=m.item(j.thY);f=b.grid.rowAccessor.getCell(h,j.thX);g=this._columnWidgetsFactory(c(f),j);k.push(g.data(b.grid.widgetName(g)))}}this._field("columns",k)};d.prototype._ownerise=function(f){if(f){var g=this;b.grid.traverse(this.options.columns,function(l){l.owner=g;var k,j,h;if((k=l.groupInfo)){k.owner=l;if(k.expandInfo){for(j=0,h=k.expandInfo.length;j<h;j++){k.expandInfo[j].owner=k}}}})}else{b.grid.traverse(this.options.columns,function(l){delete l.owner;var k,j,h;if((k=l.groupInfo)){delete k.owner;if(k.expandInfo){for(j=0,h=k.expandInfo.length;j<h;j++){delete k.expandInfo[j].owner}}}})}};d.prototype._ensureRenderBounds=function(g){var f=this._totalRowsCount();if(g.start<0){g.start=0}g.start=Math.min(g.start,f-1);if(g.end<0){g.end=0}g.end=Math.min(g.end,f-1);return g};d.prototype._refresh=function(f){new b.grid.grouper().group(this,this.sketchTable,this._field("leaves"));new b.grid.merger().merge(this.sketchTable,this._field("visibleLeaves"));var g=this._field("viewRenderBounds");this._ensureRenderBounds(g);if(this.options.scrollMode!=="none"){this._field("view",new b.grid.fixedView(this,this._field("viewRenderBounds")))}else{this._field("view",new b.grid.flatView(this,this._field("viewRenderBounds")))}this._render();this._ownerise(false);this._recreateColumnWidgets();this._ownerise(true);if(this.options.allowPaging){if(this.$topPagerDiv){this.$topPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5)}if(this.$bottomPagerDiv){this.$bottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5)}}};d.prototype._refreshVirtual=function(f){var h=f.virtualScrollData,g={top:0,bottom:0};if(h.data){g=this._processVirtualData(h)}this._updateRowInfos(h,g);this._renderVirtualIntoView(h)};d.prototype._updateRowInfos=function(l,h){var f=this._field("viewRenderBounds"),n=this._view(),j=l.newBounds,p=this._view().bodyRows(),m,k,o,g;switch(l.mode){case"reset":break;case"overlapBottom":m={start:j.start-f.start,end:f.end-f.start};o=j.start-f.start;for(k=m.start;k<=m.end;k++){g=n._getRowInfo(p.item(k));g.sectionRowIndex-=o;g.dataItemIndex+=h.top;n._setRowInfo(g.$rows,g)}break;case"overlapTop":m={start:f.start-f.start,end:j.end-f.start};o=f.start-j.start;for(k=m.start;k<=m.end;k++){g=n._getRowInfo(p.item(k));g.sectionRowIndex+=o;g.dataItemIndex+=h.top;n._setRowInfo(g.$rows,g)}break}};d.prototype._renderVirtualIntoView=function(m){var k=this._field("viewRenderBounds"),g=this._view(),l=function(i){return(i.rowType&b.grid.rowType.data)?i.originalRowIndex:-1},h,j,n,f;switch(m.mode){case"reset":g._clearBody();for(j=m.newBounds.start;j<=m.newBounds.end;j++){n=this.sketchTable[j-this._dataOffset];g._insertBodyRow(n,-1,l(n),j)}g._rebuildOffsets();break;case"overlapBottom":h={start:m.newBounds.start,end:k.end};for(j=0;j<h.start-k.start;j++){g._removeBodyRow(0,false)}for(j=h.end+1;j<=m.newBounds.end;j++){n=this.sketchTable[j-this._dataOffset];g._insertBodyRow(n,-1,l(n),j)}break;case"overlapTop":h={start:k.start,end:m.newBounds.end};for(j=0;j<k.end-m.newBounds.end;j++){g._removeBodyRow(h.end-h.start+1,false)}f=0;for(j=m.newBounds.start;j<k.start;j++){n=this.sketchTable[j-this._dataOffset];g._insertBodyRow(n,f++,l(n),j)}break;default:break}};d.prototype._processVirtualData=function(n){var o=this._dataViewWrapper,f=o.dataView().getSource(),g,p=this._field("leaves"),m,j,h,l=0,r={top:0,bottom:0},q,k=this._serverSideVirtualScrollingMargin();switch(n.mode){case"reset":this.sketchTable.splice(0,this.sketchTable.length);o._unsafeSplice(0,f.length);this._dataOffset=n.request.index;for(m=0;m<n.data.length;m++){o._unsafePush(g=n.data[m]);this.sketchTable.push(this._buildSketchRow(o._wrapDataItem(g,m),p))}break;case"overlapBottom":for(m=0;m<n.data.length;m++){o._unsafePush(g=n.data[m]);this.sketchTable.push(this._buildSketchRow(o._wrapDataItem(g,f.length-1),p))}r.bottom=n.data.length;break;case"overlapTop":for(m=n.data.length-1;m>=0;m--){o._unsafeSplice(0,0,g=n.data[m]);this.sketchTable.splice(0,0,this._buildSketchRow(o._wrapDataItem(g,m),p))}this._dataOffset=n.request.index;r.top=n.data.length;break}j=this._ensureRenderBounds({start:n.newBounds.start,end:n.newBounds.end});h={start:this._dataOffset,end:this._dataOffset+f.length-1};l=(h.end-j.end)-k;if(l>0){r.bottom-=l;o._unsafeSplice(f.length-l,l);this.sketchTable.splice(this.sketchTable.length-l,l)}l=(j.start-h.start)-k;if(l>0){r.top-=l;o._unsafeSplice(0,l);this.sketchTable.splice(0,l);this._dataOffset+=l}for(m=0;m<this.sketchTable.length;m++){this.sketchTable[m].originalRowIndex=m}o._refreshSilent();return r};d.prototype._needToCreatePagerItem=function(){return this.options.allowPaging===true};d.prototype._render=function(){var f=this._view(),i=this.options,h=this.options.wijCSS,g;f.render();g=this.outerDiv;if(i.scrollMode!=="none"){g=this.outerDiv.find("div.wijmo-wijgrid-scroller:first")}this.$superPanelHeader=null;if(this.$topPagerDiv){if(this.$topPagerDiv.data("wijmo-wijpager")){this.$topPagerDiv.wijpager("destroy")}this.$topPagerDiv.remove()}this.$topPagerDiv=null;if(this._needToCreatePagerItem()&&((i.pagerSettings.position==="top")||(i.pagerSettings.position==="topAndBottom"))){if(!this.$topPagerDiv){g.prepend(this.$superPanelHeader=c('<div class="wijmo-wijsuperpanel-header"></div>'));this.$superPanelHeader.prepend(this.$topPagerDiv=c('<div class="wijmo-wijgrid-header '+h.header+" "+h.cornerTop+'"></div>'))}}if(i.showGroupArea){this._processGroupArea(g)}else{this.$groupArea=null}if(this.$bottomPagerDiv){if(this.$bottomPagerDiv.data("wijmo-wijpager")){this.$bottomPagerDiv.wijpager("destroy")}this.$bottomPagerDiv.remove()}this.$bottomPagerDiv=null;if(this._needToCreatePagerItem()&&((i.pagerSettings.position==="bottom")||(i.pagerSettings.position==="topAndBottom"))){if(!this.$bottomPagerDiv){g.append(this.$bottomPagerDiv=c('<div class="wijmo-wijgrid-footer wijmo-wijsuperpanel-footer '+h.stateDefault+" "+h.cornerBottom+'"></div>'))}}};d.prototype._processGroupArea=function(h){var f=this,g=this._field("groupedColumns"),i=[];this.$groupArea=c('<div class="'+this.options.wijCSS.content+" "+this.options.wijCSS.helperClearFix+'"></div>');if(g.length>0){c.each(g,function(j,l){var k=c('<a href="#"></a>').appendTo(f.$groupArea);try{c.data(k[0],"wijgridowner",f);k.c1groupedfield(c.extend({},{allowMoving:l.allowMoving,allowSort:l.allowSort,dataIndex:l.dataIndex,headerText:l.headerText,isBand:l.isBand,isLeaf:l.isLeaf,linearIdx:l.linearIdx,parentIdx:l.parentIdx,sortDirection:l.sortDirection,travIdx:l.travIdx,groupedIndex:l.groupedIndex},{disabled:f.options.disabled}))}finally{c.removeData(k[0],"wijgridowner")}i.push(k.data("wijmo-c1groupedfield"))})}else{this.$groupArea.addClass("wijmo-wijgrid-group-area").css("padding",0).html(this.options.groupAreaCaption||"&nbsp;")}this._field("groupedWidgets",i);if(!this.$superPanelHeader){h.prepend(this.$superPanelHeader=c('<div class="wijmo-wijsuperpanel-header"></div>'))}this.$superPanelHeader.prepend(this.$groupArea);this._dragndrop(true).attachGroupArea(this.$groupArea)};d.prototype._attachEvents=function(){var f=this._view(),h=f.focusableElement(),g=this;h.bind("keydown."+this.widgetName,c.proxy(this._onKeyDown,this));h.bind("keypress."+this.widgetName,c.proxy(this._onKeyPress,this));c.each(f.subTables(),function(i,j){var k=j.element();if(k){if(k.tHead){c(k.tHead).bind("click."+g.widgetName,c.proxy(g._onClick,g))}if(k.tBodies.length){c(k.tBodies[0]).bind("click."+g.widgetName,c.proxy(g._onClick,g)).bind("dblclick."+g.widgetName,c.proxy(g._onDblClick,g)).bind("mousemove."+g.widgetName,c.proxy(g._onMouseMove,g)).bind("mouseout."+g.widgetName,c.proxy(g._onMouseOut,g))}}});c(window).bind("resize."+this.widgetName+"."+this._eventUID,c.proxy(this._onWindowResize,this))};d.prototype._detachEvents=function(i){var f=this._view(),h=this,g;this._windowResizeTimer=0;c(window).unbind("resize."+this.widgetName+"."+this._eventUID);if(f){g=f.focusableElement();g.unbind("keydown."+this.widgetName);g.unbind("keypress."+this.widgetName);c.each(f.subTables(),function(){var j=this.element();if(j){if(j.tHead){c(j.tHead).unbind("."+h.widgetName)}if(j.tBodies.length){c(j.tBodies[0]).unbind("."+h.widgetName)}}})}};d.prototype._handleSort=function(k,g){var j=this.options.columns,f=k.travIdx,i,h;if(k&&this.options.allowSorting){i=((k.sortDirection==="none")?"ascending":((k.sortDirection==="ascending")?"descending":"ascending"));h={column:k,sortDirection:i,sortCommand:k.dataKey+" "+(i==="ascending"?"asc":"desc")};if(this._onColumnSorting(h)){k.sortDirection=h.sortDirection;if(g){k.sortOrder=this._customSortOrder++}else{this._customSortOrder=1000;c.each(this.columns(),function(l,m){m.options.sortOrder=0;if(m.options.travIdx!==f&&!(m.options.groupInfo&&m.options.groupInfo.position!=="none")){m.options.sortDirection="none"}});b.grid.traverse(j,function(l){l.sortOrder=0;if(l.travIdx!==f&&!(l.groupInfo&&l.groupInfo.position!=="none")){l.sortDirection="none"}})}h={column:k,sortDirection:k.sortDirection,sortCommand:k.dataKey+" "+(k.sortDirection==="ascending"?"asc":"desc")};if(this._customPagingEnabled()){this._convertWidgetsToOptions();this._onColumnSorted(h)}else{this.ensureControl(true,{afterRefresh:function(){this._onColumnSorted(h)}})}}}};d.prototype._pagerSettings2PagerWidgetSettings=function(){return c.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageIndexChanging:c.proxy(this._onPagerWidgetPageIndexChanging,this),pageIndexChanged:c.proxy(this._onPagerWidgetPageIndexChanged,this)})};d.prototype._handleDragnDrop=function(j,n,i,f,m){var l=b.grid.getColumnByTravIdx(this.options.columns,j),h=b.grid.getColumnByTravIdx(this.options.columns,n),g=f?"groupArea":"columns",k=m?"groupArea":"columns";if(m){if(this._onColumnGrouping({drag:l.found,drop:h?h.found:null,dragSource:g,dropSource:k,at:i})){this.ensureControl(true,{beforeRefresh:function(){if(!h){l.found.groupedIndex=0}else{switch(i){case"left":l.found.groupedIndex=h.found.groupedIndex-0.5;break;case"right":l.found.groupedIndex=h.found.groupedIndex+0.5;break}}if(!f){c.extend(true,l.found,{groupInfo:{position:"header"}})}},afterRefresh:function(){this._onColumnGrouped({drag:l.found,drop:h?h.found:null,dragSource:g,dropSource:k,at:i})}})}}else{if(this._onColumnDropping({drag:l.found,drop:h.found,at:i})){this.ensureControl(false,{beforeRefresh:function(){l.at.splice(l.found.linearIdx,1);switch(i){case"left":if(l.at===h.at&&l.found.linearIdx<h.found.linearIdx){h.at.splice(h.found.linearIdx-1,0,l.found)}else{h.at.splice(h.found.linearIdx,0,l.found)}break;case"right":if(l.at===h.at&&l.found.linearIdx<h.found.linearIdx){h.at.splice(h.found.linearIdx,0,l.found)}else{h.at.splice(h.found.linearIdx+1,0,l.found)}break;case"center":h.found.columns.push(l.found);break}b.grid.setTraverseIndex(this.options.columns)},afterRefresh:function(){this._onColumnDropped({drag:l.found,drop:h.found,at:i})}})}}};d.prototype._handleFilter=function(i,l,k){var f=(new b.grid.filterOperatorsCache(this)).getByName(l),j,h,g;if(f){if(f.arity>1){j=this._parse(i.options,k);h=(j!==null&&(b.grid.getDataType(i.options)==="string"||!isNaN(j)))}else{h=true}if(h){g={column:i.options,operator:f.name,value:j};if(this._onColumnFiltering(g)){i.options.filterValue=g.value;i.options.filterOperator=g.operator;this._resetDataProperties();if(this._customPagingEnabled()){this._convertWidgetsToOptions();this._onColumnFiltered({column:i.options})}else{this.ensureControl(true,{afterRefresh:function(){this._onColumnFiltered({column:i.options})}})}}}}};d.prototype._handleUngroup=function(h){var g=b.grid.getColumnByTravIdx(this.options.columns,h),f;if(g&&g.found){f=g.found;if(this._onColumnUngrouping({column:f})){this.ensureControl(false,{beforeRefresh:function(){delete f.groupedIndex;c.extend(true,f,{groupInfo:{position:"none"}})},afterRefresh:function(){this._onColumnUngrouped({column:f})}})}}};d.prototype._onVirtualScrolling=function(j,g,k,f,i,h){this.ensureControl(true,{virtualScrollData:{newBounds:j,request:g,mode:k,data:h},afterRefresh:function(l){var m=this._field("viewRenderBounds");c.extend(m,l.virtualScrollData.newBounds);this._view()._adjustRowsHeights();i(f)}})};d.prototype._handleVirtualScrolling=function(f,j){var h=this._field("viewRenderBounds"),i=this._ensureRenderBounds({start:f,end:f+this.options.pageSize-1}),k=this._ensureRenderBounds({start:this._dataOffset,end:this._dataOffset+this._dataViewWrapper.dataView().count()-1}),g=null,l;if(i.start>h.end||i.end<h.start){l="reset"}else{if(i.start>h.start){l="overlapBottom"}else{if(i.start<h.start){l="overlapTop"}else{}}}if(this._serverSideVirtualScrolling()){switch(l){case"reset":g={index:f,maxCount:this.options.pageSize};break;case"overlapBottom":if(i.end>k.end){g={index:k.end+1,maxCount:this.options.pageSize}}break;case"overlapTop":if(i.start<k.start){g={index:Math.max(0,k.start-this.options.pageSize),maxCount:0};g.maxCount=k.start-g.index}break}}if(l!=="none"){this._onVirtualScrolling(i,g,l,f,j)}};d.prototype._serverSideVirtualScrolling=function(){return false};d.prototype._serverSideVirtualScrollingMargin=function(){return this.options.pageSize*2};d.prototype._onColumnDropping=function(f){return this._trigger("columnDropping",null,f)};d.prototype._onColumnDropped=function(f){this._trigger("columnDropped",null,f)};d.prototype._onColumnGrouping=function(f){return this._trigger("columnGrouping",null,f)};d.prototype._onColumnGrouped=function(f){this._trigger("columnGrouped",null,f)};d.prototype._onColumnUngrouping=function(f){return this._trigger("columnUngrouping",null,f)};d.prototype._onColumnUngrouped=function(f){this._trigger("columnUngrouped",null,f)};d.prototype._onColumnFiltering=function(f){return this._trigger("filtering",null,f)};d.prototype._onColumnFiltered=function(f){this._trigger("filtered",null,f)};d.prototype._onFilterOperatorsListShowing=function(f){this._trigger("filterOperatorsListShowing",null,f)};d.prototype._onColumnSorting=function(f){return this._trigger("sorting",null,f)};d.prototype._onColumnSorted=function(f){this._trigger("sorted",null,f)};d.prototype._onCurrentCellChanged=function(f){var h=this.options,g=this._field("currentCell");this._dataViewWrapper.currentPosition(this._gridDataRowIndexToDataView(g.rowIndex()));if(h.scrollMode!=="none"&&g&&!g.isEqual(b.grid.cellInfo.outsideValue)){(this._view()).scrollTo(g)}this._trigger("currentCellChanged");if(f&&((f.type||"").toLowerCase()==="click")&&this._editBySingleClick()){this._beginEditInternal(f)}};d.prototype._onPageIndexChanging=function(f){return this._trigger("pageIndexChanging",null,f)};d.prototype._onPageIndexChanged=function(f){this._trigger("pageIndexChanged",null,f)};d.prototype._onPagerWidgetPageIndexChanging=function(g,f){f.handled=true};d.prototype._onPagerWidgetPageIndexChanged=function(g,f){this._setOption("pageIndex",f.newPageIndex)};d.prototype._onRendering=function(f){var g=this._view();this._rendered=false;if(f.virtualScrollData){this.selection().clear();if(this.options.highlightCurrentCell){this._highlightCellPosition(this.currentCell(),false)}}else{if(g){g.dispose()}this._detachEvents(false);this.element.detach();this.element.empty();this.outerDiv.empty();this.outerDiv.append(this.element);if(this._field("selectionui")){this._field("selectionui").dispose();this._field("selectionui",null)}if(this._field("resizer")){this._field("resizer").dispose();this._field("resizer",null)}if(this._field("frozener")){this._field("frozener").dispose();this._field("frozener",null)}}this._trigger("rendering")};d.prototype._onRendered=function(f){var g=this._view(),i,j,h=this.selection().selectedCells().length()>0;this._rendered=true;this._setAttr(g.focusableElement(),"tabIndex",0);i=this.currentCell();if(i._isValid()&&(i=this.currentCell(i))){i._isEdit(false)}else{i=this.currentCell(this._getFirstDataRowCell(0))}this._field("selection",null);i=this.currentCell();if(i._isValid()&&(h||this.options.showSelectionOnRender)){this.selection()._startNewTransaction(i);this.selection()._selectRange(new b.grid.cellInfoRange(i,i),false,false,0,null)}if(!f.virtualScrollData){this._attachEvents();this._selectionui(true);j=new b.grid.uiResizer(this);c.each(this.columns(),function(l,k){var m=k.options;if(m.visible&&m.parentVis&&m.isLeaf){j.addElement(k)}});this._field("resizer",j);g.updateSplits(this._scrollingState);if(this.options.scrollMode!=="none"){this._field("frozener",new b.grid.uiFrozener(this))}}this._renderCounter++;this._trigger("rendered")};d.prototype._onClick=function(j){if(!this._canInteract()||!j.target){return}var m=this._view(),i=this._findUntilOuterDiv(j.target,{td:true,th:true}),k,f,g=0,l,n;if(i){if(c(j.target).hasClass("wijmo-wijgrid-grouptogglebtn")){this._onGroupBtnClick(j);j.stopPropagation();return false}k=c(i).closest("tr");if(!k.length){return}f=m.getAbsoluteCellInfo(i);if(k.hasClass("wijmo-wijgrid-datarow")||k.hasClass("wijmo-wijgrid-headerrow")){if(f.cellIndex()<0||f.rowIndex()<0){if(f.rowIndex()>=0){f=new b.grid.cellInfo(0,f.rowIndex());g=2}else{f=this._getFirstDataRowCell(f.cellIndex());g=1}}this._changeCurrentCell(j,f,!c(j.target).is(":focus"));l=this.currentCell();n=this.selection();if(!j.shiftKey||(!n._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")){n._startNewTransaction(l)}n.beginUpdate();if(j.shiftKey&&j.ctrlKey){n._clearRange(new b.grid.cellInfoRange(l,l),g)}else{n._selectRange(new b.grid.cellInfoRange(n._anchorCell(),l),j.ctrlKey,j.shiftKey,g,null)}n.endUpdate()}var h={cell:f};this._trigger("cellClicked",null,h)}};d.prototype._onDblClick=function(f){if(!this._editBySingleClick()){this._beginEditInternal(f)}};d.prototype._onGroupBtnClick=function(k){if(!this._canInteract()){return}var f=c(k.target).closest("tr"),g=b.grid.groupHelper,h=g.getGroupInfo(f[0]),i,j;if(h){i=g.getColumnByGroupLevel(this._field("leaves"),h.level);if(i){j=i.groupInfo.expandInfo[h.index];if(j.isExpanded){j.collapse()}else{j.expand(k.shiftKey)}this._view().ensureHeight()}}};d.prototype._onKeyDown=function(k){if(!this._canInteract()){return true}var f=(k.target).tagName.toLowerCase(),g=false,j,l,i,h=b.grid.getKeyCodeEnum();if((f==="input"||f==="option"||f==="select"||f==="textarea")&&(c(k.target).closest("tr.wijmo-wijgrid-datarow").length===0)){return true}if(this.options.allowEditing){if((k.which===h.ESCAPE||k.which===113)&&(this.currentCell()._isValid()&&this.currentCell()._isEdit())){this._endEditInternal(k);return false}else{if(k.which===113){this._beginEditInternal(k);return false}}}if(!this.options.allowKeyboardNavigation||(k.which===h.TAB)){return true}switch(k.which){case h.LEFT:case h.RIGHT:case h.DOWN:case h.UP:case h.PAGE_DOWN:case h.PAGE_UP:case h.HOME:case h.END:case h.TAB:j=this._getNextCurrencyPos(this._getDataCellsRange(),this.currentCell(),k.keyCode,k.shiftKey);g=this._canMoveToAnotherCell(k.target,k.which);break}if(g){this._changeCurrentCell(k,new b.grid.cellInfo(j.cellIndex,j.rowIndex),true);l=this.currentCell();i=this.selection();if(!k.shiftKey||(!i._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")){i._startNewTransaction(l)}i.beginUpdate();i._selectRange(new b.grid.cellInfoRange(i._anchorCell(),l),false,k.shiftKey,0,null);i.endUpdate();return false}return true};d.prototype._onKeyPress=function(j){if(this._canInteract()&&this.options.allowEditing){var g=j.which,k=this.currentCell(),f,i,h;if(g&&k._isValid()&&!k._isEdit()){f=(j.target).tagName.toLowerCase();if(f!=="input"&&f!=="option"&&f!=="select"&&f!=="textarea"){i=c(j.target).closest(".wijmo-wijgrid-table");if(i.length){h=c.map(this._view().subTables(),function(m,l){return m.element()});if(c.inArray(i[0],h)>=0){if(c.wij.charValidator.isPrintableChar(String.fromCharCode(g))){this._beginEditInternal(j);return false}}}}}}};d.prototype._onMouseMove=function(k){var n=this._view(),i=this._field("frozener"),j,h,o,l,m,f,g=b.grid.renderState;if(!this.options.highlightOnHover||!this._canInteract()||(i&&i.inProgress())){return}j=this._findUntilOuterDiv(k.target,{td:true,th:true});if(j){h=c(j).closest("tr");if(!h.length||!(h.hasClass("wijmo-wijgrid-datarow")||h.hasClass("wijmo-wijgrid-headerrow"))){return}o=n.getAbsoluteCellInfo(j);l=this._field("hoveredRow");if(o.rowIndex()!==l){if(l!==undefined){m=this._rows().item(l);if(m){f=n._getRowInfo(m);n._changeRowRenderState(f,g.hovered,false);this.rowStyleFormatter.format(f)}}l=o.rowIndex();this._field("hoveredRow",l);if(l>=0){m=this._rows().item(l);if(m){f=n._getRowInfo(m);n._changeRowRenderState(f,g.hovered,true);this.rowStyleFormatter.format(f)}}}}};d.prototype._onMouseOut=function(j){if(!this._canInteract()){return}if(c(j.relatedTarget).closest(".wijmo-wijgrid-data").length===0){var h=this._field("hoveredRow"),g,i,f=this._view();if(h>=0){g=this._rows().item(h);if(g){i=f._getRowInfo(g);f._changeRowRenderState(i,b.grid.renderState.hovered,false);this.rowStyleFormatter.format(i)}}}};d.prototype._onWindowResize=function(g){var f=this;if(this._windowResizeTimer>0){window.clearTimeout(this._windowResizeTimer);this._windowResizeTimer=0}if(this._windowResizeTimer!==-1){this._windowResizeTimer=window.setTimeout(function(){f._windowResizeTimer=-1;try{if(!f._destroyed&&f._initialized&&f.element.parent().length){f.setSize()}}finally{f._windowResizeTimer=0}},50)}};d.prototype._fieldResized=function(j,g,i){if(g<0){g=0}if(i<=0){i=1}var h={column:j.options,oldWidth:g,newWidth:i};if(this._trigger("columnResizing",null,h)!==false){if(isNaN(h.newWidth)||h.newWidth<0){h.newWidth=1}j.option("width",h.newWidth);var f={column:j.options};this._trigger("columnResized",null,f)}};d.prototype._changeCurrentCell=function(f,i,k){var m=this.currentCell(),l=this._getDataCellsRange(),j,g,h=this.options.highlightCurrentCell,n;if((l._isValid()&&l._containsCellInfo(i))||(i.isEqual(b.grid.cellInfo.outsideValue))){if(m.cellIndex()!==i.cellIndex()||m.rowIndex()!==i.rowIndex()){j={cellIndex:i.cellIndex(),rowIndex:i.rowIndex(),oldCellIndex:m.cellIndex(),oldRowIndex:m.rowIndex()};if(this._trigger("currentCellChanging",null,j)){g=false;if(!this.options.allowEditing||!m._isEdit()||(g=this._endEditInternal(null))){if(l._containsCellInfo(m)){if(h){this._highlightCellPosition(m,false)}if(n=m.tableCell()){c(n).removeAttr("tabIndex")}}m=i._clone();m._setGridView(this);if(h){this._highlightCellPosition(m,true)}if(n=m.tableCell()){c(n).attr("tabIndex",0);if(k&&!m._isEdit()){c(n).focus()}}this._field("currentCell",m);this._onCurrentCellChanged(f)}}}else{if(h){this._highlightCellPosition(m,true)}if(n=m.tableCell()){c(n).attr("tabIndex",0)}}}else{}};d.prototype._highlightCellPosition=function(i,n){if(i&&i._isValid()){var m=i.cellIndexAbs(),k=i.rowIndexAbs(),h=b.grid.renderState,l=this._view(),g,j,f;j=l.getHeaderCell(m);if(j){g=l._getRowInfo(this._headerRows().item(i.column().thY));j=c(j);f=l._changeCellRenderState(j,h.current,n);this.cellStyleFormatter.format(j,m,i.column(),g,f)}j=l.getJoinedRows(k,0);if(j){g=l._getRowInfo(j);l._changeRowRenderState(g,h.current,n);this.rowStyleFormatter.format(g)}j=l.getCell(m,k);if(j){j=c(j);f=l._changeCellRenderState(j,h.current,n);this.cellStyleFormatter.format(j,m,i.column(),g,f)}}};d.prototype._beginEditInternal=function(h){if(this._canInteract()&&this.options.allowEditing){var g=this.currentCell().column(),f;if(g&&!g.readOnly){f=new b.grid.cellEditorHelper().currentCellEditStart(this,h);if(f){}return f}}return false};d.prototype._endEditInternal=function(g){if(this._canInteract()&&this.options.allowEditing){var f=new b.grid.cellEditorHelper().currentCellEditEnd(this,g);if(f&&!this._allowVirtualScrolling()){this._view().ensureHeight(this.currentCell().rowIndex())}return f}return false};d.prototype._onViewInsertEmptyRow=function(j,f,g,h,i){return null};d.prototype._onViewCreateEmptyCell=function(h,f,g){return null};d.prototype._onViewCellRendered=function(i,h,f,g){};d.prototype._onViewRowRendered=function(f){};d.prototype._getDataParser=function(f){return f.dataParser||b.data.defaultParsers[f.dataType]||b.data.defaultParsers.string};d.prototype._parse=function(g,i){var j=this._dataViewWrapper.dataView(),h=b.grid.getDataType(g),f=b.grid.getDataType(g);if(c.isFunction(i)){i=i()}i=b.data.convert(i,h,f,{culture:this._field("closestCulture"),format:g.dataFormatString||g._underlyingDataFormatString,nullString:this.options.nullString,parser:g.dataParser});return i};d.prototype._toStr=function(g,i){var j=this._dataViewWrapper.dataView(),h=b.grid.getDataType(g),f="string";i=b.data.convert(i,h,f,{culture:this._field("closestCulture"),format:g.dataFormatString||g._underlyingDataFormatString,nullString:this.options.nullString,parser:g.dataParser});return i};d.prototype._funcOptions=function(){return["cellStyleFormatter","rowStyleFormatter","afterCellEdit","afterCellUpdate","beforeCellEdit","beforeCellUpdate","cellClicked","columnDragging","columnDragged","columnDropping","columnDropped","columnResizing","columnResized","columnGrouping","columnGrouped","columnUngrouping","columnUngrouped","currentCellChanging","currentCellChanged","filtering","filtered","filterOperatorsListShowing","groupAggregate","groupText","invalidCellValue","pageIndexChanging","pageIndexChanged","selectionChanged","sorting","sorted","dataLoading","dataLoaded","loading","loaded","rendering","rendered"]};d.prototype._canInteract=function(){return !this.options.disabled};d.prototype._canMoveToAnotherCell=function(l,k){var g=l.tagName.toLowerCase(),f,m,j,i;switch(g){case"input":if(c(l).hasClass("wijgridinput")){var h=l;if(h.type==="text"){f=h.value.length;m=new b.grid.domSelection(h).getSelection();j=b.grid.getKeyCodeEnum();i=((k===j.UP||k===j.DOWN||k===j.PAGE_DOWN||k===j.PAGE_UP)||(m.length===0&&((m.start===0&&(k===j.LEFT||k===j.HOME))||(m.end>=f&&(k===j.RIGHT||k===j.END)))));return i}return true}return false;case"textarea":case"select":return false}return true};d.prototype._editBySingleClick=function(){var f=(this.options.editingInitOption||"").toLowerCase();switch(f){case"click":case"doubleclick":break;case"auto":default:f=this._isMobile?"click":"doubleclick";break}return f==="click"};d.prototype._getDataToAbsOffset=function(){var f=0,h=0,g=this._headerRows();if(this.options.showRowHeader){f++}if(g){h+=g.length()}if(this._filterRow()){h++}return{x:f,y:h}};d.prototype._gridDataRowIndexToDataView=function(h){var g=-1,f=b.grid.rowType,i;if(h<0){return g}i=this._view()._getRowInfo(this._rows().item(h));return(i.type&b.grid.rowType.data)?i.dataItemIndex:-1};d.prototype._dataViewDataRowIndexToGrid=function(l){var g=b.grid.rowType,h=this._view(),k=this._rows(),j,f,m;if(l<0){return -1}for(j=0,f=k.length();j<f;j++){m=h._getRowInfo(k.item(j));if((m.type&g.data)&&(m.dataItemIndex===l)){return m.sectionRowIndex}}return -1};d.prototype._getDataCellsRange=function(){var h=0,f=0,g=this._field("visibleLeaves").length-1,i=(this._rendered)?this._rows().length()-1:this.sketchTable.length-1;if(this.options.showRowHeader){g--}if(g<0||i<0){h=f=g=i=-1}return new b.grid.cellInfoRange(new b.grid.cellInfo(h,f,null),new b.grid.cellInfo(g,i,null))};d.prototype._getDataItem=function(f){return this.dataView().item(f)};d.prototype._getFirstDataRowCell=function(k){var l,g,j,h=this._view(),i=this._rows(),f=b.grid.rowType;for(l=0,g=i.length();l<g;l++){j=h._getRowInfo(i.item(l));if(j.type&f.data){return new b.grid.cellInfo(k,l)}}return b.grid.cellInfo.outsideValue};d.prototype._getNextCurrencyPos=function(j,i,l,f){var h=i.cellIndex(),m=i.rowIndex(),k,g=b.grid.getKeyCodeEnum();switch(l){case g.PAGE_UP:if(this._reverseKey&&m===j.topLeft().rowIndex()){m=j.bottomRight().rowIndex()}else{m-=this._pageSizeKey;if(m<(k=j.topLeft().rowIndex())){m=k}}break;case g.PAGE_DOWN:if(this._reverseKey&&m===j.bottomRight().rowIndex()){m=j.topLeft().rowIndex()}else{m+=this._pageSizeKey;if(m>(k=j.bottomRight().rowIndex())){m=k}}break;case g.END:h=(this._reverseKey&&h===j.bottomRight().cellIndex())?j.topLeft().cellIndex():j.bottomRight().cellIndex();break;case g.HOME:h=(this._reverseKey&&h===j.topLeft().cellIndex())?j.bottomRight().cellIndex():j.topLeft().cellIndex();break;case g.LEFT:if(h>j.topLeft().cellIndex()){h--}else{if(this._reverseKey){h=j.bottomRight().cellIndex()}}break;case g.UP:if(m>j.topLeft().rowIndex()){m--}else{if(this._reverseKey){m=j.bottomRight().rowIndex()}}break;case g.RIGHT:if(h<j.bottomRight().cellIndex()){h++}else{if(this._reverseKey){h=j.topLeft().cellIndex()}}break;case g.ENTER:case g.DOWN:if(m<j.bottomRight().rowIndex()){m++}else{if(this._reverseKey){m=j.topLeft().rowIndex()}}break;case g.TAB:if(false){if(f){h--;if(h<j.topLeft().cellIndex()){h=j.bottomRight().cellIndex();m--;if(m<j.topLeft().rowIndex()){m=j.bottomRight().rowIndex()}}}else{h++;if(h>j.bottomRight().cellIndex()){h=j.topLeft().cellIndex();m++;if(m>j.bottomRight().rowIndex()){m=j.topLeft().rowIndex()}}}}break}return{cellIndex:h,rowIndex:m}};d.prototype._findUntilOuterDiv=function(k,f){var i=k,g,j,h=null;for(;i;i=i.parentNode){j=i.nodeName.toLowerCase();if(j){if(i===this.outerDiv[0]){g=i;break}if(f[j]){h=i}}}return g?h:null};d.prototype._getStaticIndex=function(h){var f,g=this._getDataCellsRange();if(this._hasSpannedCells()){return -1}if(h){f=Math.min(this.options.staticRowIndex,g.bottomRight().rowIndex())}else{f=Math.min(this.options.staticColumnIndex,g.bottomRight().cellIndex())}if(f<-1){f=-1}return f};d.prototype._getStaticOffsetIndex=function(f){var g=0;if(f){if(this.options.showRowHeader===true){g++}}else{g=this._columnsHeadersTable().length;if(this.options.showFilter){g++}}return g};d.prototype._getRealStaticColumnIndex=function(){var k,g,i=this._getStaticOffsetIndex(true),j=this._getStaticIndex(false),f,h;f=j+i;if(j>=0){k=this._field("visibleLeaves");g=k.length;h=f;for(;f<g;f++){if(k[f].parentIdx===-1){if(f>h){f--}break}}if(f>=g){f=g-1}}return f};d.prototype._getRealStaticRowIndex=function(){var f=this._getStaticOffsetIndex(false);return this._getStaticIndex(true)+f};d.prototype._hasMerging=function(){var k=this._field("leaves"),j,g,h,f=false;if(k){for(j=0,g=k.length;(j<g)&&!f;j++){h=k[j];f=f||(h.parentVis&&(h.rowMerge!=="none"))}}return f};d.prototype._hasGrouping=function(){var k=this._field("leaves"),j,g,h,f=false;for(j=0,g=k.length;(j<g)&&!f;j++){h=k[j];f=h.groupInfo&&(h.groupInfo.position!=="none")}return f};d.prototype._hasSpannedCells=function(){return this._hasGrouping()||this._hasMerging()};d.prototype._columnsHeadersTable=function(f){if(arguments.length){this._field("columnsHeadersTable",f)}return this._field("columnsHeadersTable")};d.prototype._view=function(){return this._field("view")};d.prototype._originalFooterRowData=function(){var f=this._field("tfoot");return(f&&f.length)?f[0]:null};d.prototype._originalHeaderRowData=function(){var f=this._field("thead");return(f&&f.length)?f[0]:null};d.prototype._setAttr=function(f,h,i){var g=this;if(f===this.element){if(arguments.length===2){c.each(h,function(l,j){if(!(l in g._originalAttr)){g._originalAttr[l]=f.attr(l)}});return f.attr(h)}else{if(!(h in this._originalAttr)){this._originalAttr[h]=f.attr(h)}return f.attr(h,i)}}else{return(arguments.length===3)?f.attr(h,i):f.attr(h)}return this};d.prototype._totalRowsCount=function(){return this.sketchTable.length};d.prototype._trackScrollingPosition=function(f,g){this._scrollingState.x=f;this._scrollingState.y=g};d.prototype._trackScrollingIndex=function(f){this._scrollingState.index=f};d.prototype._uid=function(){if(this.__uid===undefined){this.__uid=b.grid.getUID()}return"wijgrid"+this.__uid};return d})(b.wijmoWidget);b.wijgrid=a;a.prototype.widgetEventPrefix="wijgrid";a.prototype._data$prefix="wijgrid";a.prototype._customSortOrder=1000;a.prototype._reverseKey=false;a.prototype._pageSizeKey=10;a.prototype._mergeWidgetsWithOptions=true;a.prototype.options=c.extend(true,{},b.wijmoWidget.prototype.options,{wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},allowColMoving:false,allowColSizing:false,allowEditing:false,allowKeyboardNavigation:true,allowPaging:false,allowSorting:false,allowVirtualScrolling:false,alwaysParseData:true,cellStyleFormatter:undefined,columns:[],columnsAutogenerationMode:"merge",culture:"",customFilterOperators:[],data:null,editingInitOption:"auto",ensureColumnsPxWidth:false,filterOperatorsSortMode:"alphabeticalCustomFirst",groupAreaCaption:"Drag a column here to group by that column.",groupIndent:10,highlightCurrentCell:false,highlightOnHover:true,loadingText:"Loading...",nullString:"",pageIndex:0,pageSize:10,pagerSettings:{mode:"numeric",pageButtonCount:10,position:"bottom"},readAttributesFromData:false,rowStyleFormatter:undefined,scrollMode:"none",selectionMode:"singleRow",showFilter:false,showFooter:false,showGroupArea:false,showSelectionOnRender:true,showRowHeader:false,staticColumnIndex:-1,staticRowIndex:-1,totalRows:-1,afterCellEdit:null,afterCellUpdate:null,beforeCellEdit:null,beforeCellUpdate:null,cellClicked:null,columnDragging:null,columnDragged:null,columnDropping:null,columnDropped:null,columnGrouping:null,columnGrouped:null,columnResizing:null,columnResized:null,columnUngrouping:null,columnUngrouped:null,currentCellChanging:null,currentCellChanged:null,filterOperatorsListShowing:null,filtering:null,filtered:null,groupAggregate:null,groupText:null,invalidCellValue:null,pageIndexChanging:null,pageIndexChanged:null,selectionChanged:null,sorting:null,sorted:null,dataLoading:null,dataLoaded:null,loading:null,loaded:null,rendering:null,rendered:null});c.wijmo.registerWidget("wijgrid",a.prototype)})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var wijmo;(function(b){var c=jQuery;var a=(function(e){__extends(d,e);function d(){e.apply(this,arguments)}d.prototype._create=function(){var f=c.data(this.element[0],"wijgridowner");this._field("owner",f);b.grid.widgetName(this.element[0],this.widgetFullName);this._destroyed=false;this.element.addClass(f.options.wijCSS.widget+" wijmo-c1basefield "+f.options.wijCSS.stateDefault);if(this.options.disabled){this.disable()}if(f.options.allowColMoving){f._dragndrop(true).attach(this)}};d.prototype._init=function(){this.element.wrapInner("<div class='wijmo-wijgrid-innercell'></div>");this._refreshHeaderCell()};d.prototype.destroy=function(){try{e.prototype.destroy.apply(this,arguments)}finally{this._destroyed=true}};d.prototype._destroy=function(){if(this._isDestroyed()){return}var f=this._owner();if(f&&f._dragndrop(false)){f._dragndrop(false).detach(this)}b.grid.remove$dataByPrefix(this.element,this._data$prefix);this.element.removeClass(f.options.wijCSS.widget+" wijmo-c1basefield "+f.options.wijCSS.stateDefault).html(this.element.find(".wijmo-wijgrid-headertext").html())};d.prototype._field=function(f,g){return b.grid.dataPrefix(this.element,this._data$prefix,f,g)};d.prototype._removeField=function(f){var g=this._data$prefix+f;this.element.removeData(g)};d.prototype._setOption=function(h,j){var l=this["_preset_"+h],g=this.options[h],i,f;if(l!==undefined){j=l.apply(this,[j,g])}i=(j!==g);e.prototype._setOption.apply(this,[h,j]);if(i){if(this.options.groupedIndex!==undefined){var k=this._owner()._field("groupedWidgets")[this.options.groupedIndex];if(k&&(h in k.options)){k._setOption(h,j)}}f=this["_postset_"+h];if(f!==undefined){f.apply(this,[j,g])}}};d.prototype._postset_allowMoving=function(g,f){};d.prototype._preset_clientType=function(g,f){throw"read-only"};d.prototype._postset_headerText=function(g,f){this._refreshHeaderCell()};d.prototype._postset_visible=function(g,f){this._owner().ensureControl(false)};d.prototype._postset_width=function(i,f){var g=this._owner();if(g){this.options.ensurePxWidth=true;var h=b.grid.getColumnByTravIdx(g.options.columns,this.options.travIdx);if(h){h.found.width=i;h.found.ensurePxWidth=true}g.setSize()}};d.prototype._owner=function(){return this._field("owner")};d.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing};d.prototype._canDrag=function(){return this.options.allowMoving===true};d.prototype._canDropTo=function(f){if(b.grid.isChildOf(this._owner().options.columns,f,this)){return false}return true};d.prototype._createHeaderContent=function(f){return f.html(this.options.headerText||"")};d.prototype._decorateHeaderContent=function(f){return f.wrapInner('<span class="wijmo-wijgrid-headertext" />')};d.prototype._refreshHeaderCell=function(){var f=this.element.children(".wijmo-wijgrid-innercell").empty();this._createHeaderContent(f);this._decorateHeaderContent(f)};d.prototype._isDestroyed=function(){return this._destroyed};return d})(b.wijmoWidget);b.c1basefield=a;a.prototype._data$prefix="c1basefield";a.prototype.options=c.extend(true,{},b.JQueryUIWidget.prototype.options,{allowMoving:true,allowSizing:true,cellFormatter:undefined,dataKey:undefined,ensurePxWidth:undefined,footerText:undefined,headerText:undefined,textAlignment:undefined,visible:true,width:undefined});c.wijmo.registerWidget("c1basefield",a.prototype)})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var wijmo;(function(a){var b=jQuery;var c=(function(d){__extends(e,d);function e(){d.apply(this,arguments)}e.prototype._create=function(){d.prototype._create.apply(this,arguments);var f=this._owner();this.element.addClass(f.options.wijCSS.widget+" wijmo-c1field")};e.prototype._destroy=function(){if(this._isDestroyed()){return}var f=this._owner();this.element.find("*").unbind("."+this.widgetName);if(this.$filterEditor){this.$filterEditor.closest("td").find("*").unbind("."+this.widgetName);switch(this._getInputEditorType(this.options)){case"date":if(this.$filterEditor.data("wijmo-wijinputdate")){this.$filterEditor.wijinputdate("destroy")}break;case"mask":if(this.$filterEditor.data("wijmo-wijinputmask")){this.$filterEditor.wijinputmask("destroy")}break;case"numberCurrency":case"numberNumber":case"numberPercent":if(this.$filterEditor.data("wijmo-wijinputnumber")){this.$filterEditor.wijinputnumber("destroy")}break}this.$filterEditor=null}this.element.removeClass(f.options.wijCSS.widget+" wijmo-c1field").find(".wijmo-wijgrid-headertext > span."+f.options.wijCSS.icon).remove();this._removeDropDownFilterList();d.prototype._destroy.apply(this,arguments)};e.prototype._init=function(){d.prototype._init.apply(this,arguments);this.$filterEditor=null;var f=this._owner();this.filterRow=f._filterRow();if(f.options.showFilter&&this.options.showFilter&&(this.options.dataIndex>=0)){this._prepareFilterCell()}};e.prototype._postset_aggregate=function(g,f){this._owner().ensureControl(false)};e.prototype._postset_allowSort=function(g,f){this._refreshHeaderCell()};e.prototype._postset_dataType=function(g,f){throw"read-only"};e.prototype._postset_dataParser=function(g,f){this._owner().ensureControl(false)};e.prototype._postset_dataFormatString=function(g,f){this._owner().ensureControl(false)};e.prototype._postset_filterOperator=function(g,f){this._owner().ensureControl(true)};e.prototype._postset_filterValue=function(g,f){this._owner().ensureControl(true)};e.prototype._postset_groupInfo=function(g,f){this._owner().ensureControl(true)};e.prototype._postset_rowMerge=function(g,f){this._owner().ensureControl(false)};e.prototype._postset_showFilter=function(g,f){this._owner().ensureControl(false)};e.prototype._postset_sortDirection=function(g,f){this.options.sortOrder=0;this._owner().ensureControl(true)};e.prototype._postset_width=function(g,f){d.prototype._postset_width.apply(this,arguments)};e.prototype._canDropTo=function(f){if(d.prototype._canDropTo.apply(this,arguments)){if(this.options.groupedIndex!==undefined&&(f instanceof b.wijmo.c1groupedfield)){return false}return true}return false};e.prototype._canSort=function(){var f=this._owner();return(f&&f.options.allowSorting&&this.options.allowSort&&(this.options.dataIndex>=0))};e.prototype._decorateHeaderContent=function(h){if(this._canSort()){var f=this._owner(),g=h.wrapInner('<a class="wijmo-wijgrid-headertext" href="#" role="button" />').children("a");g.bind("click."+this.widgetName,this,b.proxy(this._onHrefClick,this));switch(this.options.sortDirection){case"ascending":g.append(b('<span class="'+f.options.wijCSS.icon+" "+f.options.wijCSS.iconArrowUp+'">ascending</span>'));break;case"descending":g.append(b('<span class="'+f.options.wijCSS.icon+" "+f.options.wijCSS.iconArrowDown+'">descending</span>'));break}}else{d.prototype._decorateHeaderContent.apply(this,arguments)}};e.prototype._prepareFilterCell=function(){var l=this.options.visLeavesIdx,i=null,g=null,j,k,h=this,f;if(l>=0){i=this._owner();if(this.filterRow){g=b(a.grid.rowAccessor.getCell(this.filterRow,l))}else{throw"exception"}this.$filterEditor=g.find("input");g.bind(((b.support).selectstart?"selectstart":"mousedown"),function(m){m.stopPropagation()});j=i._parse(this.options,a.grid.filterHelper.getSingleValue(this.options.filterValue));if(j===null||j==="undefined"){switch(a.grid.getDataType(this.options)){case"boolean":j=false;break;case"number":case"currency":case"datetime":j=0;break;default:j=""}}k={culture:i.options.culture,disabled:i.options.disabled,decimalPlaces:(function(m){var n=/^(n|p|c){1}(\d*)$/.exec(m);if(n){if(n[2]){return parseInt(n[2],10)}}return 2})(this.options.dataFormatString)};switch(f=this._getInputEditorType(this.options)){case"date":this.$filterEditor.wijinputdate(b.extend(k,{date:j,dateFormat:this.options.dataFormatString||undefined}));break;case"mask":this.$filterEditor.wijinputmask({text:j+""});break;case"numberCurrency":this.$filterEditor.wijinputnumber(b.extend(k,{type:"currency",value:j}));break;case"numberNumber":this.$filterEditor.wijinputnumber(b.extend(k,{value:j}));break;case"numberPercent":this.$filterEditor.wijinputnumber(b.extend(k,{type:"percent",value:j*100}));break;default:throw a.grid.stringFormat('Unsupported editor type: "{0}"',f)}g.find(".wijmo-wijgrid-filter-trigger").attr({role:"button","aria-haspopup":"true"}).bind("mouseenter."+this.widgetName,function(m){if(!h.options.disabled){b(this).addClass(i.options.wijCSS.stateHover)}}).bind("mouseleave."+this.widgetName,function(m){if(!h.options.disabled){b(this).removeClass(i.options.wijCSS.stateHover+" "+i.options.wijCSS.stateActive)}}).bind("mouseup."+this.widgetName,this,function(m){if(!h.options.disabled){b(this).removeClass(i.options.wijCSS.stateActive)}}).bind("mousedown."+this.widgetName,{column:this},this._onFilterBtnClick).bind("click."+this.widgetName,function(m){m.preventDefault()})}};e.prototype._onFilterBtnClick=function(m){var i=m.data.column,j=8,l,k,n,o,p,r,g,f,h,q;if(i.options.disabled){return false}if(i.$dropDownFilterList){i._removeDropDownFilterList();return false}m.target.focus();l=i._owner();k=a.grid.filterHelper.getSingleOperatorName(i.options.filterOperator).toLowerCase();n=l.getFilterOperatorsByDataType(a.grid.getDataType(i.options));o={operators:n,column:i.options};l._onFilterOperatorsListShowing(b.extend(true,{},o));p=[];if(o.operators){b.each(o.operators,function(t,s){p.push({label:s.displayName||s.name,value:s.name,selected:s.name.toLowerCase()===k})})}i.$dropDownFilterList=b('<div class="wijmo-wijgrid-filterlist"></div').appendTo(document.body).wijlist({autoSize:true,maxItemsCount:j,selected:function(u,t){var v,s;switch(s=i._getInputEditorType(i.options)){case"date":v=i.$filterEditor.wijinputdate("option","date")||new Date();break;case"mask":v=i.$filterEditor.wijinputmask("option","text");break;case"numberCurrency":case"numberNumber":case"numberPercent":v=i.$filterEditor.wijinputnumber("option","value");if(s==="numberPercent"){v/=100}break}i._removeDropDownFilterList();l._handleFilter(i,t.item.value,v)}});if(b.ui&&b.fn.zIndex){q=l.outerDiv.zIndex();if(q){q++}}i.$dropDownFilterList.css("z-index",Math.max(q||0,100));i.$dropDownFilterList.wijlist("setItems",p).wijlist("renderList");f=i.$dropDownFilterList.width()|150;i.$dropDownFilterList.width(p.length>j?f+20:f).wijlist("refreshSuperPanel").position({of:b(this),my:"left top",at:"left bottom"});(i.$dropDownFilterList).$button=b(this);h=(i.$dropDownFilterList).eventUID=a.grid.getUID();b(document).bind("mousedown."+i.widgetName+"."+h,{column:i},i._onDocMouseDown)};e.prototype._onDocMouseDown=function(i){var f=b(i.target),g=f.parents(".wijmo-wijgrid-filterlist:first"),h=f.is(".wijmo-wijgrid-filter-trigger")?f:f.parents(".wijmo-wijgrid-filter-trigger:first");if((h.length&&(h[0]===i.data.column.$dropDownFilterList.$button[0]))||(g.length&&(g[0]===i.data.column.$dropDownFilterList[0]))){}else{i.data.column._removeDropDownFilterList()}};e.prototype._onHrefClick=function(f){if(f.data.options.disabled){return false}if(f.data.options.allowSort){f.data._owner()._handleSort(f.data.options,f.ctrlKey)}return false};e.prototype._removeDropDownFilterList=function(){if(this.$dropDownFilterList){var f=(this.$dropDownFilterList).eventUID;this.$dropDownFilterList.remove();this.$dropDownFilterList=null;b(document).unbind("mousedown."+this.widgetName+"."+f,this._onDocMouseDown)}};e.prototype._getInputEditorType=function(f){switch(a.grid.getDataType(f)){case"number":return(f.dataFormatString&&f.dataFormatString.indexOf("p")===0)?"numberPercent":"numberNumber";case"currency":return"numberCurrency";case"datetime":return"date";default:return"mask"}};return e})(a.c1basefield);a.c1field=c;c.prototype.options=b.extend(true,{},a.c1basefield.prototype.options,{aggregate:"none",allowSort:true,dataType:undefined,dataParser:undefined,dataFormatString:undefined,filterOperator:"nofilter",filterValue:undefined,groupInfo:{expandInfo:[],groupSingleRow:true,collapsedImageClass:b.wijmo.wijCSS.iconArrowRight,expandedImageClass:b.wijmo.wijCSS.iconArrowRightDown,position:"none",outlineMode:"startExpanded",headerText:undefined,footerText:undefined},readOnly:false,rowMerge:"none",showFilter:true,sortDirection:"none",valueRequired:false});b.wijmo.registerWidget("c1field",b.wijmo.c1basefield,c.prototype)})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var wijmo;(function(a){var b=jQuery;var c=(function(d){__extends(e,d);function e(){d.apply(this,arguments)}e.prototype._create=function(){d.prototype._create.apply(this,arguments);var f=this._owner();this.element.addClass(f.options.wijCSS.widget+" wijmo-c1band")};e.prototype._canDropTo=function(f){if(d.prototype._canDropTo.apply(this,arguments)){return !(f instanceof b.wijmo.c1groupedfield)}return false};return e})(a.c1basefield);a.c1band=c;c.prototype.options=b.extend(true,{},a.c1basefield.prototype.options,{columns:[]});b.wijmo.registerWidget("c1band",b.wijmo.c1basefield,c.prototype)})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var wijmo;(function(a){var b=jQuery;var c=(function(d){__extends(e,d);function e(){d.apply(this,arguments)}e.prototype._create=function(){var f=b.data(this.element[0],"wijgridowner");this._field("owner",f);a.grid.widgetName(this.element[0],this.widgetFullName);this._destroyed=false;this.element.addClass("wijmo-wijgrid-group-button "+f.options.wijCSS.stateDefault+" "+f.options.wijCSS.cornerAll);if(this.options.disabled){this.disable()}if(f.options.allowColMoving){f._dragndrop(true).attach(this)}};e.prototype._init=function(){this._refreshHeaderCell()};e.prototype.destroy=function(){try{d.prototype.destroy.apply(this,arguments)}finally{this._destroyed=true}};e.prototype._destroy=function(){if(this._isDestroyed()){return}this.element.find("*").unbind("."+this.widgetName);var f=this._owner();if(f&&f._dragndrop(false)){f._dragndrop(false).detach(this)}a.grid.remove$dataByPrefix(this.element,this._data$prefix)};e.prototype._field=function(f,g){return a.grid.dataPrefix(this.element,this._data$prefix,f,g)};e.prototype._removeField=function(f){var g=this._data$prefix+f;this.element.removeData(g)};e.prototype._setOption=function(h,j){var k=this["_preset_"+h],g=this.options[h],i,f;if(k!==undefined){j=k.apply(this,[j,g])}i=(j!==g);d.prototype._setOption.apply(this,[h,j]);if(i){f=this["_postset_"+h];if(f!==undefined){f.apply(this,[j,g])}}};e.prototype._postset_headerText=function(h,g,f){this._refreshHeaderCell()};e.prototype._postset_allowSort=function(h,g,f){this._refreshHeaderCell()};e.prototype._owner=function(){return this._field("owner")};e.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing};e.prototype._canDrag=function(){return this.options.allowMoving===true};e.prototype._canDropTo=function(f){if(!(f instanceof b.wijmo.c1groupedfield)){return false}if(a.grid.isChildOf(this._owner().options.columns,f,this)){return false}return true};e.prototype._canSort=function(){var f=this._owner();return(f&&f.options.allowSorting&&this.options.allowSort&&(this.options.dataIndex>=0))};e.prototype._refreshHeaderCell=function(){var g=this._owner().options.wijCSS,f=b('<span class="wijmo-wijgrid-group-button-close '+g.stateDefault+" "+g.cornerAll+'"><span class="'+g.icon+" "+g.iconClose+'"></span></span>').bind("click."+this.widgetName,this,this._onCloseClick);this.element.html(this.options.headerText||"").prepend(f).bind("click."+this.widgetName,this,b.proxy(this._onHrefClick,this));if(this._canSort()){switch(this.options.sortDirection){case"ascending":this.element.append(b('<span class="wijmo-wijgrid-group-button-sort '+g.icon+" "+g.iconArrowUp+'"></span>'));break;case"descending":this.element.append(b('<span class="wijmo-wijgrid-group-button-sort '+g.icon+" "+g.iconArrowDown+'"></span>'));break}}};e.prototype._onCloseClick=function(g){var f=g.data.options;if(!f.disabled){g.data._owner()._handleUngroup(g.data.options.travIdx)}return false};e.prototype._onHrefClick=function(g){var h=g.data._owner(),f=g.data.options,i;if(!f.disabled&&f.allowSort){i=a.grid.search(h.columns(),function(j){return j.options.travIdx===f.travIdx});i=(!i.found)?a.grid.getColumnByTravIdx(h.options.columns,f.travIdx).found:i.found.options;if(i){h._handleSort(i,g.ctrlKey)}}return false};e.prototype._isDestroyed=function(){return this._destroyed};return e})(a.wijmoWidget);a.c1groupedfield=c;c.prototype._data$prefix="c1groupedfield";c.prototype.options=b.extend(true,{},a.JQueryUIWidget.prototype.options,{wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},allowMoving:true,allowSort:true,headerText:undefined,sortDirection:"none"});b.wijmo.registerWidget("c1groupedfield",c.prototype)})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var j=jQuery;var o=(function(){function p(){}p.prototype.generateSpanTable=function(q,s){this._height=this._width=this._inc=this._shift=0;this._table=[];this._traverseList=[];this._savedXPos=[];var r=this._generateSpanTable(q,s,true);return r};p.prototype._generateSpanTable=function(q,v,t){var u,s,r=this;this._height=this.getVisibleHeight(q,t);v=v||[];b.grid.traverse(q,function(w){if(w.isLeaf){v.push(w)}r._traverseList.push(w)});this._width=v.length;for(u=0;u<this._height;u++){this._table[u]=[];for(s=0;s<this._width;s++){this._table[u][s]={column:null,colSpan:0,rowSpan:0}}}this._setTableValues(q,0,0);return this._table};p.prototype.getVisibleHeight=function(s,t){var v,r,w,u,q=0;if(j.isArray(s)){for(v=0,r=s.length;v<r;v++){u=this.getVisibleHeight(s[v],t);q=Math.max(q,u)}}else{w=(s.visible===undefined)?true:s.visible;s.parentVis=w&&t;if(s.isBand){for(v=0,r=s.columns.length;v<r;v++){u=this.getVisibleHeight(s.columns[v],s.parentVis);q=Math.max(q,u)}if(!s.parentVis){return q}s.isLeaf=(q===0);q++}else{s.isLeaf=true;if(s.parentVis){q=1}}}return q};p.prototype._getVisibleParent=function(q){while(q){q=this._traverseList[q.parentIdx];if(q&&(q.parentVis||q.parentVis===undefined)){return q}}return null};p.prototype._setTableValues=function(w,v,z){var s,u,t,r,A,q;if(j.isArray(w)){for(s=0,u=w.length;s<u;s++){this._setTableValues(w[s],v,z)}}else{if(w.travIdx===undefined){throw"undefined travIdx"}t=z+this._shift;if(w.parentVis){r=t+this._inc;this._table[v][r].column=w;this._savedXPos[w.travIdx]=r}if(w.isBand){for(s=0,u=w.columns.length;s<u;s++){this._setTableValues(w.columns[s],v+1,z)}}if(w.parentVis){if(this._shift-t===0){this._table[v][this._savedXPos[w.travIdx]].rowSpan=this._height-v;this._shift++}else{this._table[v][this._savedXPos[w.travIdx]].colSpan=this._shift-t}}else{if(!w.isBand&&this._height>0){q=this._getVisibleParent(w);A=(q)?q.isLeaf:false;if(A){this._inc++}if(v>=this._height){v=this._height-1}r=z+this._shift+this._inc;this._table[v][r].column=w;if(!A){if(q&&(this._savedXPos[q.travIdx]===r)){this._shiftTableElements(r,v)}this._inc++}}}}};p.prototype._shiftTableElements=function(q,r){var s;for(s=0;s<r;s++){this._table[s][q+1]=this._table[s][q];this._table[s][q]={column:null,colSpan:0,rowSpan:0};if(this._table[s][q+1].column){this._savedXPos[this._table[s][q+1].column.travIdx]++}}};return p})();d.bandProcessor=o;function h(p){var q=[];k(p,q);return q}d.getAllLeaves=h;function k(s,u){var r,q,t,p;if(s){for(r=0,q=s.length;r<q;r++){t=s[r];if(t.options){t=t.options}p=t.columns;if(p&&p.length){k(p,u)}else{u.push(t)}}}}function i(t,r){var s,q,u,p=null;if(t&&r>=0){for(s=0,q=t.length;s<q&&!p;s++){u=t[s];if(u.options){u=u.options}if(u.travIdx===r){return{found:u,at:t}}if(u.columns){p=this.getColumnByTravIdx(u.columns,r)}}}return p}d.getColumnByTravIdx=i;function m(p,s,q){if(s.options){s=s.options}if(q.options){q=q.options}if(q.isBand&&s.parentIdx>=0){if(s.parentIdx===q.travIdx){return true}if(s.parentIdx>q.travIdx){var r=this.flatten(p);while(true){s=r[s.parentIdx];if(s.travIdx===q.travIdx){return true}if(s.parentIdx===-1){break}}}}return false}d.isChildOf=m;function g(p){var q=[];f(p,q);return q}d.getLeaves=g;function f(r,t){var q,p,s;if(r){for(q=0,p=r.length;q<p;q++){s=r[q];if(s.isLeaf){t.push(s)}if(s.columns){f(s.columns,t)}}}}function n(p){return e(p,0,-1)}d.setTraverseIndex=n;function e(s,q,u){var r,p,t;if(s){for(r=0,p=s.length;r<p;r++){t=s[r];if(t.options){t=t.options}t.linearIdx=r;t.travIdx=q++;t.parentIdx=u;if(t.columns){q=e(t.columns,q,q-1)}}}return q}function c(q){var p=[];b.grid.traverse(q,function(r){p.push(r)});return p}d.flatten=c;function l(r,t){var q,p,s;if(r&&(j.isFunction(t))){for(q=0;q<r.length;q++){s=r[q];if(s.options){s=s.options}p=r.length;t(s,r);if(r.length!==p){q--;continue}if(s.columns){b.grid.traverse(s.columns,t)}}}}d.traverse=l})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(){function f(g){this._dvFilteringSettings=undefined;this._dvPagingSettings=undefined;this._dvSortingSettings=undefined;this._wgFilteringSettings=undefined;this._wgPagingSettings=undefined;this._wgSortingSettings=undefined;if(!g){throw"exception"}this._wijgrid=g;this._dataView=g._dataViewWrapper.dataView();this._filterCache=new b.grid.filterOperatorsCache(g)}f.prototype.compareSettings=function(){var j=true,k,h,l,g;j=((k=this.DVPagingSettings())===(h=this.WGPagingSettings()));if(!j&&k&&h){j=(k.pageSize===h.pageSize&&k.pageIndex===h.pageIndex)}if(j){j=((k=this.DVSortingSettings())===(h=this.WGSortingSettings()));if(!j&&k&&h&&((g=k.length)===h.length)){j=true;for(l=0;l<g&&j;l++){j=((k[l].dataKey===h[l].dataKey)&&(k[l].sortDirection===h[l].sortDirection))}}}if(j){k=this.DVFilteringSettings();h=this.WGFilteringSettings();j=b.grid.compareObj(k,h)}return j};f.prototype.DVFilteringSettings=function(){function h(j,k){var l;e.each(j,function(m,n){if(typeof(n)==="string"){l=n}else{if(e.isArray(n)){h(n,k)}else{k.filterValue.push(n.value);k.filterOperator.push({name:n.operator,condition:l})}}})}if(this._dvFilteringSettings===undefined){var i=[],g=this._dataView.filter();if(g){e.each(g,function(l,j){var k={dataKey:l};if(e.isArray(j)){k.filterValue=[];k.filterOperator=[];h(j,k)}else{if(e.isPlainObject(j)){k.filterValue=j.value;k.filterOperator=j.operator||"Equals"}else{k.filterValue=j;k.filterOperator="Equals"}}i.push(k)})}this._dvFilteringSettings=(i.length)?i:null}return this._dvFilteringSettings};f.prototype.DVPagingSettings=function(){if(this._dvPagingSettings===undefined){var h=b.grid.asPagedDataView(this._dataView);if(h){var g=h.pageSize();this._dvPagingSettings=(g>0)?{pageSize:h.pageSize(),pageIndex:h.pageIndex()}:null}}return this._dvPagingSettings};f.prototype.DVSortingSettings=function(){if(this._dvSortingSettings===undefined){var h=[];if(true){var g=b.data.sorting.compile(this._dataView.sort()).normalized;if(g){e.each(g,function(i,j){if(j!==null){h.push({dataKey:(typeof(j)==="string")?j:j.property,sortDirection:j.asc||j.asc===undefined?"ascending":"descending"})}})}}this._dvSortingSettings=(h.length)?h:null}return this._dvSortingSettings};f.prototype.WGFilteringSettings=function(){if(this._wgFilteringSettings===undefined){var i=[],h=this._wijgrid._field("leaves"),g=this;if(h){e.each(h,function(l,j){if(b.grid.validDataKey(j.dataKey)&&j.filterOperator){var m=(b.grid.deepExtend({},{foo:j.filterValue})).foo,k=(b.grid.deepExtend({},{foo:j.filterOperator})).foo,n=b.grid.filterHelper.verify(k,m,j.dataType,g._filterCache);if(n){i.push({dataKey:j.dataKey,filterValue:n.filterValue,filterOperator:n.filterOperator})}}})}this._wgFilteringSettings=(i.length)?i:null}return this._wgFilteringSettings};f.prototype.WGPagingSettings=function(){if(this._wgPagingSettings===undefined){this._wgPagingSettings=this._wijgrid.options.allowPaging?{pageSize:this._wijgrid.options.pageSize,pageIndex:this._wijgrid.options.pageIndex}:null}return this._wgPagingSettings};f.prototype.WGSortingSettings=function(){if(this._wgSortingSettings===undefined){var h=[],g=this._wijgrid._field("leaves");if(this._wijgrid.options.allowSorting){if(g){e.each(g,function(j,i){if(!i.isBand&&i.allowSort&&b.grid.validDataKey(i.dataKey)){if(i.groupInfo&&(i.groupInfo.position!=="none")&&(i.sortDirection==="none")){i.sortDirection="ascending"}if(i.sortDirection==="ascending"||i.sortDirection==="descending"){h.push({dataKey:i.dataKey,sortDirection:i.sortDirection,sortOrder:i.sortOrder||0})}}})}if(h.length){h.sort(function(j,i){return j.sortOrder-i.sortOrder});e.each(h,function(i,j){delete j.sortOrder})}}this._wgSortingSettings=(h.length)?h:null}return this._wgSortingSettings};f.prototype.MapWGToDV=function(){var g={},i,h;if(this._mapPagingParams()&&(i=this.WGPagingSettings())){g.pageIndex=i.pageIndex;g.pageSize=i.pageSize}else{g.pageSize=-1}if(this._mapSortingParams()){g.sort=[];if(i=this.WGSortingSettings()){g.sort=[];e.each(i,function(j,k){g.sort.push({property:k.dataKey,asc:k.sortDirection==="ascending"})})}}if(this._mapFilteringParams()){g.filter={};if(i=this.WGFilteringSettings()){g.filter=this._convertFilterToDV(i)}if(e.isEmptyObject(g.filter)){g.filter=null}}return g};f.prototype.MapDVToWG=function(){var l,j={},g=this._mapSortingParams(),k=this._mapPagingParams(),i=this._mapFilteringParams(),h=b.grid.asPagedDataView(this._dataView);e.each(this._wijgrid._field("leaves"),function(n,m){if(g){m.sortOrder=0;m.sortDirection="none"}if(i){m.filterOperator="nofilter";m.filterValue=undefined}j[m.dataKey]=m});if(k&&h){this._wijgrid.options.pageSize=h.pageSize();this._wijgrid.options.pageIndex=h.pageIndex()}if(g&&(l=this.DVSortingSettings())){e.each(l,function(m,p){var n;if((n=j[p.dataKey])){n.sortDirection=p.sortDirection;n.sortOrder=m}})}if(i&&(l=this.DVFilteringSettings())){e.each(l,function(n,p){var m;if((m=j[p.dataKey])){m.filterValue=p.filterValue;m.filterOperator=p.filterOperator;if(e.isPlainObject(m.filterOperator)){m.filterOperator=m.filterOperator.name}}})}};f.prototype._mapPagingParams=function(){return this._wijgrid.options.allowPaging&&!this._wijgrid._customPagingEnabled()&&!this._wijgrid._serverShaping()};f.prototype._mapSortingParams=function(){return this._wijgrid.options.allowSorting&&!this._wijgrid._serverShaping()};f.prototype._mapFilteringParams=function(){return !this._wijgrid._serverShaping()};f.prototype._convertFilterToDV=function(i){var g={},h=this;e.each(i,function(o,s){var k=s.dataKey,j=[],p="and",m,r,l,n,q;if(!e.isPlainObject(s)){return}r=s.filterOperator;l=s.filterValue;if(r==null){return}if(!e.isArray(r)){r=[r]}if(!e.isArray(l)){l=[l]}if(r.length!=l.length){throw"The number of filter operators must match the number of filter values"}if(r.length==0){return}e.each(r,function(v,u){if(typeof(u)==="string"){u={name:u}}if(!e.isPlainObject(u)||!u.name){throw"Invalid filter operator"}n=l[v];if(!e.isArray(n)){n=[n]}q=e.map(n,function(x){var y={property:k,operator:u.name,value:x};var z=h._filterCache.getByNameInt(u.name);if(z.isCustom){var A=e.extend(true,{},z.op);if(e.isFunction(A.operator)){(A).apply=A.operator}y.operator=A}return y});function t(){if(q.length>1){q.splice(0,0,"or")}else{q=q[0]}}function w(){if(p==null){p=m;j.splice(0,0,m)}}p=null;m=u.condition||"or";if(j.length<=1||p==m){if(q.length==1||j.length<=1||p=="or"){j=j.concat(q);w()}else{t();j.push(q);w()}}else{t();j=[j,q];w()}});e.each(j,function(t,u){if(e.isArray(u)&&u.length==2){j[t]=u[1]}});if(j.length==2&&typeof(j[0]==="string")){j.shift()}if(j.length==1){j=j[0]}g[k]=j});return g};return f})();d.settingsManager=c})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var g=jQuery;var f=(function(){function i(j){this._domSource=null;this._ignoreAllEvents=false;this._ignoreChangeEvent=false;this._ignoreCurrentChangedEvent=false;this._sharedDataItems=[];this._userData=null;this._totals={};this._changeTimer=0;this._toDispose=[];this._isOwnDataView=false;this._isWijdatasource=false;this._isDynamicWijdatasource=false;this._wijgrid=j;this._createDataViewWrapper()}i.prototype.data=function(){var k=this._getDataViewInst(),j=b.grid.asPagedDataView(k);return{data:this._sharedDataItems,totalRows:j!=null?j.totalItemCount():(k.getSource()||[]).length,totals:this._totals,emptyData:this.isBoundedToDOM()?this._domSource.emptyData:null}};i.prototype.dataView=function(){return this._getDataViewInst()};i.prototype.dispose=function(){var j=this._getDataViewInst();this._propChangeListener.dispose();g.each(this._toDispose,function(k,l){l.dispose()});if(j&&this._isOwnDataView){j.dispose()}this._wijgrid._wijDataView=null};i.prototype.ignoreChangeEvent=function(j){if(arguments.length){this._ignoreChangeEvent=(j===true)}else{return this._ignoreChangeEvent}};i.prototype.ignoreCurrentChangedEvent=function(j){if(arguments.length){this._ignoreCurrentChangedEvent=(j===true)}else{return this._ignoreCurrentChangedEvent}};i.prototype.isDataLoaded=function(){var j=this._getDataViewInst();return j.isLoaded()};i.prototype.isOwnDataView=function(){return this._isOwnDataView};i.prototype.getFieldsInfo=function(){var l=this._getDataViewInst(),k=l.getProperties(),j={};g.each(k,function(m,n){j[n.name]={name:n.name,type:n.type||"string"}});return j};i.prototype.isBoundedToDOM=function(){return this._domSource!==null};i.prototype.load=function(j){this._userData=j;var m=this._getDataViewInst();if(!m){this._createDataViewWrapper();m=this._getDataViewInst()}this._onDataViewLoading();var n=new b.grid.settingsManager(this._wijgrid);if(this._needToLoad(n)){var k=n.MapWGToDV(),l=false;if(this._isWijdatasource&&!this._isDynamicWijdatasource&&m.isLoaded()){l=true}m.refresh(k,l)}else{if(this.isDataLoaded()){this._onDataViewLoaded();this._onDataViewReset()}}};i.prototype.currentPosition=function(k){var j=this._getDataViewInst();if(!arguments.length){return j.currentPosition()}this.ignoreCurrentChangedEvent(true);try{j.currentPosition(k)}finally{this.ignoreCurrentChangedEvent(false)}};i.prototype.getValue=function(k,j){var l=this._getDataViewInst();if(typeof(j)==="number"){j=j+""}return l.getProperty(k,j)};i.prototype.setValue=function(k,j,l){var m=this._getDataViewInst();this.ignoreChangeEvent(true);try{if(typeof(j)==="number"){j=j+""}m.setProperty(k,j,l)}finally{this.ignoreChangeEvent(false)}};i.prototype._createDataViewWrapper=function(){var j,l=this._wijgrid.options.data,m=this._getDataViewInst(),k=false;if(m){return}if(!l){this._domSource=this._processDOM(this._wijgrid.element,this._wijgrid.options.readAttributesFromData);l=this._domSource.items}k=(typeof(wijdatasource)!=="undefined"&&(l instanceof wijdatasource));this._isOwnDataView=(g.isArray(l)||k);this._isWijdatasource=!!(this._isOwnDataView&&k);this._isDynamicWijdatasource=!!(this._isOwnDataView&&k&&l.dynamic);if(this._isOwnDataView){if(!this._domSource&&this._wijgrid.options.readAttributesFromData){this._moveAttributesToExpando(l)}m=b.grid.GridDataView.create(b.data.asDataView(l))}else{m=l}this._wijgrid._wijDataView=m;this._toDispose.push(m.isLoading.subscribe(g.proxy(this._onDataViewLoadingInternal,this)));this._toDispose.push(m.isLoaded.subscribe(g.proxy(this._onDataViewLoadedInternal,this)));this._toDispose.push(m.subscribe(g.proxy(this._onDataViewChangeInternal,this)));this._toDispose.push(m.currentPosition.subscribe(g.proxy(this._onDataViewCurrentChangedInternal,this)));this._propChangeListener=new b.grid.propChangeListener(g.proxy(this._onPropertyChanged,this))};i.prototype._getDataViewInst=function(){return this._wijgrid._wijDataView};i.prototype._needToLoad=function(j){var k=this._getDataViewInst();if(this._isDynamicWijdatasource||(this._isWijdatasource&&!k.isLoaded())){return true}if(this.isDataLoaded()||k.isLoading()){return !j.compareSettings()}return false};i.prototype._validateSettings=function(j){if(!this._isOwnDataView&&this._wijgrid.options.allowPaging&&((j.DVPagingSettings()||{}).pageSize!==(j.WGPagingSettings()||{}).pageSize)){throw"The pageSize option of the external dataView can't be changed."}};i.prototype._onDataViewLoadingInternal=function(j){if(this._ignoreAllEvents){return}if(j){if(!this._userData){this._onDataViewLoading()}}};i.prototype._onDataViewLoadedInternal=function(j){if(this._ignoreAllEvents){return}if(j){this._onDataViewLoaded()}};i.prototype._onDataViewChangeInternal=function(k){var j=this;if(this._ignoreAllEvents||this._ignoreChangeEvent){return}if(k.changes){if(k.length&&k[0].entityState()==="detached"){return}g.each(k.changes,function(l,m){switch(m.changeType){case"remove":j._propChangeListener.remove(m.index);break;case"add":j._propChangeListener.insert(m.index,m.element);break}})}this._onDataViewChange.apply(this,arguments)};i.prototype._onDataViewCurrentChangedInternal=function(){if(this._ignoreAllEvents||this._ignoreCurrentChangedEvent){return}this._onDataViewCurrentChanged.apply(this,arguments)};i.prototype._onDataViewReset=function(){this._sharedDataItems=[];this._totals={};var l,m=this._getDataViewInst(),j=m.count(),k;try{this._propChangeListener.removeAll();for(l=0;l<j;l++){k=m.item(l);this._propChangeListener.insert(l,k);this._sharedDataItems.push(this._wrapDataItem(k,l))}this._totals=this._getTotals(m,this._wijgrid._prepareTotalsRequest(true));this._wijgrid._onDataViewReset(this._userData)}finally{this._userData=null}};i.prototype._onPropertyChanged=function(k){var j=this;if(this._changeTimer>0){window.clearTimeout(this._changeTimer);this._changeTimer=0}if(this._changeTimer!=-1){this._changeTimer=window.setTimeout(function(){j._changeTimer=-1;if(!j._wijgrid._destroyed){j._onDataViewChange()}j._changeTimer=0},100)}};i.prototype._onDataViewChange=function(j){this._onDataViewReset()};i.prototype._onDataViewCurrentChanged=function(k,j){this._wijgrid._onDataViewCurrentPositionChanged(k,j)};i.prototype._onDataViewLoading=function(){this._wijgrid._onDataViewLoading()};i.prototype._onDataViewLoaded=function(){this._wijgrid._onDataViewLoaded()};i.prototype._getTotals=function(r,q){if(!q||q.length===0){return{}}var p,l,o,m,n=[],k={};for(p=0,l=q.length;p<l;p++){n.push(new b.grid.tally())}for(p=0,l=r.count();p<l;p++){for(o=0,m=n.length;o<m;o++){n[o].add(this._wijgrid._parse(q[o].column,this.getValue(p,q[o].column.dataKey)))}}for(p=0,l=n.length;p<l;p++){k[q[p].column.dataKey]=n[p].getValueString(q[p].column)}return k};i.prototype._processDOM=function(l,k){var j={items:[],emptyData:[],header:b.grid.readTableSection(l,b.grid.rowScope.head)};if(b.grid.getTableSectionLength(l,2)===1&&g(b.grid.getTableSectionRow(l,2,0)).hasClass("wijmo-wijgrid-emptydatarow")){j.emptyData=b.grid.readTableSection(l,b.grid.rowScope.body)}else{j.items=b.grid.readTableSection(l,b.grid.rowScope.body,k)}return j};i.prototype._moveAttributesToExpando=function(j){g.each(j,function(k,l){var n=(b).data.Expando.getFrom(l,true),m;m=n[b.grid.EXPANDO]={cellsAttributes:{},rowAttributes:{}};if(l.rowAttributes){m.rowAttributes=l.rowAttributes;delete l.rowAttributes}g.each(l,function(p,o){if(g.isArray(o)){m.cellsAttributes[p]=o[1];l[p]=o[0]}})})};i.prototype._wrapDataItem=function(j,k){return{values:j,originalRowIndex:k}};i.prototype._refreshSilent=function(){var j=this._getDataViewInst();if(j){try{this._ignoreAllEvents=true;j.refresh()}finally{this._ignoreAllEvents=false}}};i.prototype._unsafeReplace=function(j,k){var l=this._getDataViewInst();if(!(l instanceof b.grid.GridDataView)){"operation is not supported"}l._unsafeReplace(j,k)};i.prototype._unsafeSplice=function(j,l,k){var m=this._getDataViewInst();if(!(m instanceof b.grid.GridDataView)){"operation is not supported"}if(arguments.length===2){m._unsafeSplice(j,l)}else{m._unsafeSplice(j,l,k)}};i.prototype._unsafePush=function(j){var k=this._getDataViewInst();if(!(k instanceof b.grid.GridDataView)){"operation is not supported"}k._unsafePush(j)};return i})();d.dataViewWrapper=f;function c(i){return i&&("pageCount" in i)?i:null}d.asPagedDataView=c;function e(i){return i&&("commitEdit" in i)?i:null}d.asEditableDataView=e;var h=(function(){function i(j){this._subscriptions=[];this._callback=j}i.prototype.insert=function(k,l){var m=[],j=this;this._subscriptions.splice(k,0,m);g.each(l,function(n,o){if(j._isValidPropName(n)&&o&&g.isFunction(o.subscribe)){m.push(o.subscribe(j._callback))}})};i.prototype.remove=function(k){var j=this._subscriptions[k];if(j){g.each(j,function(l,m){m.dispose();j[l]=null})}this._subscriptions[k]=null;this._subscriptions.splice(k,1)};i.prototype.removeAll=function(){var j,k;while(j=this._subscriptions.length){this.remove(j-1)}this._subscriptions=[]};i.prototype.dispose=function(){this.removeAll()};i.prototype._isValidPropName=function(j){if(j&&(typeof(j)==="string")){return j.match("^entityState|jQuery")===null}return true};return i})();d.propChangeListener=h})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var f=jQuery;var e=(function(){function g(j,i,k,h,l){this.cr=new b.grid.cellRange(-1,-1);this.isExpanded=false;this._value=-1;this._sum=-1;this._position="none";this._hasHeaderOrFooter=true;if(j!==undefined){this.isExpanded=j}if(i!==undefined){this.cr=i}if(k!==undefined){this._sum=k}if(h!==undefined){this._position=h}if(l!==undefined){this._hasHeaderOrFooter=l}}g.prototype.isSubRange=function(h){return((this.cr.r1>=h.cr.r1)&&(this.cr.r2<=h.cr.r2))};g.prototype.toString=function(){return this.cr.r1+"-"+this.cr.r2};g.prototype.getHeaderImageClass=function(h){var i=this.owner;if(i){return h?i.expandedImageClass||b.c1field.prototype.options.groupInfo.expandedImageClass:i.collapsedImageClass||b.c1field.prototype.options.groupInfo.collapsedImageClass}return null};g.prototype.collapse=function(){var j,k,i,l,h;if((j=this.owner)&&(k=j.owner)&&(i=k.owner)){l=i._field("leaves");if(b.grid.groupHelper.isParentExpanded(l,this.cr,j.level)){if((j.position!=="footer")&&(j.outlineMode!=="none")){h=b.grid.groupHelper.getGroupedColumnsCount(l);this._collapse(i._rows(),l,this,h,i._field("viewRenderBounds").start)}}}};g.prototype.expand=function(l){var j,k,i,m,h;if((j=this.owner)&&(k=j.owner)&&(i=k.owner)){m=i._field("leaves");if(b.grid.groupHelper.isParentExpanded(m,this.cr,j.level)){h=b.grid.groupHelper.getGroupedColumnsCount(m);this._expand(i._rows(),m,this,h,l,true,i._field("viewRenderBounds").start)}}};g.prototype._collapse=function(l,s,t,u,q){var h=t.owner,m=t.cr.r1,v=t.cr.r2,p,r,o,k,n;switch(h.position){case"header":case"headerAndFooter":this._toggleRowVisibility(l.item(t.cr.r1-q),undefined,false);m++;break}for(p=m;p<=v;p++){this._toggleRowVisibility(l.item(p-q),false)}t.isExpanded=false;this._updateHeaderIcon(l,t,q);for(p=h.level+1;p<=u;p++){o=b.grid.groupHelper.getChildGroupRanges(s,t.cr,p-1);for(n=0,r=o.length;n<r;n++){k=o[n];k.isExpanded=false;switch(k.owner.position){case"header":case"headerAndFooter":this._toggleRowVisibility(l.item(k.cr.r1-q),undefined,false);break}this._updateHeaderIcon(l,k,q)}}};g.prototype._expand=function(n,s,u,v,h,l,q){var j=u.owner,m=u.cr.r1,w=u.cr.r2,p,r,o,k,t;switch(j.position){case"header":this._toggleRowVisibility(n.item(m-q),true,l||h);m++;break;case"footer":this._toggleRowVisibility(n.item(w-q),true);w--;break;case"headerAndFooter":this._toggleRowVisibility(n.item(m-q),true,l||h);if(l){this._toggleRowVisibility(n.item(w-q),true)}m++;w--;break}if(l){u.isExpanded=true;this._updateHeaderIcon(n,u,q)}else{return}if(u.owner.level===v){for(p=m;p<=w;p++){this._toggleRowVisibility(n.item(p-q),true)}}else{o=b.grid.groupHelper.getChildGroupRanges(s,u.cr,u.owner.level);if(o.length&&(m!==o[0].cr.r1)){for(p=m;p<o[0].cr.r1;p++){this._toggleRowVisibility(n.item(p-q),true)}}if(h){for(p=0,r=o.length;p<r;p++){k=o[p];this._expand(n,s,k,v,h,true,q)}}else{for(p=0,r=o.length;p<r;p++){k=o[p];t=(k.owner.position==="footer"||k.owner.outlineMode==="none")?true:false;this._expand(n,s,k,v,false,t,q)}}}};g.prototype._toggleRowVisibility=function(i,j,h){if(i){if(i[0]){if(j!==undefined){i[0].style.display=j?"":"none";i[0]["aria-hidden"]=j?"false":"true"}if(h!==undefined){i[0]["aria-expanded"]=h?"true":"false"}}if(i[1]){if(j!==undefined){i[1].style.display=j?"":"none";i[1]["aria-hidden"]=j?"false":"true"}if(h!==undefined){i[1]["aria-expanded"]=h?"true":"false"}}}};g.prototype._updateHeaderIcon=function(i,k,j){if(k.owner.position!=="footer"){var l,h=i.item(k.cr.r1-j);if(h){if(h[0]){l=f(h[0]).find("div.wijmo-wijgrid-grouptogglebtn:first-child")}}if(l&&l.length){l.toggleClass(k.getHeaderImageClass(!k.isExpanded),false);l.toggleClass(k.getHeaderImageClass(k.isExpanded),true)}}};return g})();d.groupRange=e;var c=(function(){function g(){this._groupRowIdx=0}g.prototype.group=function(j,m,o){this._grid=j;this._data=m;this._leaves=o;this._groupRowIdx=0;var k=1,n,p,r,q=[],l=false,h=0;for(n=0,p=o.length;n<p;n++){r=o[n];if(r.groupInfo){delete r.groupInfo.level;delete r.groupInfo.expandInfo}if(r.groupInfo&&(r.groupInfo.position&&(r.groupInfo.position!=="none"))&&(r.dataIndex>=0)){if(r.groupedIndex===undefined){l=true}}else{if(r.groupedIndex!==undefined){delete r.groupedIndex}}}if(l){for(n=0,p=o.length;n<p;n++){r=o[n];if(r.groupInfo&&(r.groupInfo.position&&(r.groupInfo.position!=="none"))&&(r.dataIndex>=0)){r.groupedIndex=h++;q.push(r)}}}else{q=f.map(o,function(i){return i.groupedIndex!==undefined?i:null});q.sort(function(s,i){return s.groupedIndex-i.groupedIndex});f.each(q,function(i,s){s.groupedIndex=i})}j._field("groupedColumns",q);for(n=0,p=q.length;n<p;n++){r=q[n];this._groupRowIdx=0;if(r.groupInfo&&(r.groupInfo.position&&(r.groupInfo.position!=="none"))&&(r.dataIndex>=0)){r.groupInfo.level=k;r.groupInfo.expandInfo=[];this._processRowGroup(r,k++)}}delete this._grid;delete this._data;delete this._leaves};g.prototype._processRowGroup=function(q,j){var v,p,h,o,k,r,l,n,s,m,t=0,u=true;f.each(this._leaves,function(x,w){if(w.parentVis){t=x;return false}});for(v=0;v<this._data.length;v++){if(!(this._data[v].rowType&b.grid.rowType.data)){continue}p=this._getGroupCellRange(v,q,j);h=true;o=(q.groupInfo.outlineMode==="startCollapsed");if(o||b.grid.groupHelper.isParentCollapsed(this._leaves,p,j)){if((q.groupInfo.groupSingleRow===false)&&(p.r1===p.r2)){continue}h=false}if(j&&this._grid.options.groupIndent){for(k=p.r1;k<=p.r2;k++){this._addIndent(this._data[k][t],j)}}u=!(q.groupInfo.groupSingleRow===false&&(p.r1===p.r2));switch(q.groupInfo.position){case"header":r=this._addGroupRange(q.groupInfo,p,h,u);for(m=p.r1;m<=p.r2;m++){this._data[m].__attr["aria-level"]=j+1;if(!h){this._data[m].__style.display="none";this._data[m].__attr["aria-hidden"]=true}}if(!u){break}this._updateByGroupRange(r,j);l=b.grid.groupHelper.isParentCollapsed(this._leaves,r.cr,j);n=this._buildGroupRow(r,p,true,l);this._data.splice(p.r1,0,n);n.__attr["arial-level"]=j;n.__attr["aria-expanded"]=h;if(l){n.__style.display="none";n.__attr["aria-hidden"]=true}v=p.r2+1;break;case"footer":r=this._addGroupRange(q.groupInfo,p,true,u);if(!u){break}this._updateByGroupRange(r,j);s=this._buildGroupRow(r,p,false,false);s.__attr["aria-level"]=j;this._data.splice(p.r2+1,0,s);v=p.r2+1;l=b.grid.groupHelper.isParentCollapsed(this._leaves,r.cr,j);if(l){s.__style.display="none";s.__attr["aria-hidden"]=true}break;case"headerAndFooter":r=this._addGroupRange(q.groupInfo,p,h,u);for(m=p.r1;m<=p.r2;m++){this._data[m].__attr["aria-level"]=j+1;if(!h){this._data[m].__style.display="none";this._data[m].__attr["aria-hidden"]=true}}if(!u){break}this._updateByGroupRange(r,j);l=b.grid.groupHelper.isParentCollapsed(this._leaves,r.cr,j);n=this._buildGroupRow(r,p,true,l);s=this._buildGroupRow(r,p,false,false);this._data.splice(p.r2+1,0,s);s.__attr["aria-level"]=j;if(l||!h){s.__style.display="none";s.__attr["aria-hidden"]=true}this._data.splice(p.r1,0,n);n.__attr["aria-level"]=j;n.__attr["aria-expanded"]=h;if(l){n.__style.display="none";n.__attr["aria-hidden"]=true}v=p.r2+2;break;default:throw b.grid.stringFormat('Unknown Position value: "{0}"',q.groupInfo.position)}this._groupRowIdx++}};g.prototype._buildGroupRow=function(p,t,j,w){var n=p.owner,v=n.owner,o=v.owner,l=[],m="",s="",y,h,x,i,u,k,r,q;(l).__style={};(l).__attr={};(l).__attr.id=((j)?"GH":"GF")+this._groupRowIdx+"-"+n.level;(l).rowType=(j)?b.grid.rowType.groupHeader:b.grid.rowType.groupFooter;if((v.dataIndex>=0)&&((y=this._data[t.r1][v.dataIndex].value)!==null)){m=o._toStr(v,y)}if(this._grid.options.showRowHeader){l.push({html:"&nbsp;"})}h={html:"",__attr:{},__style:{}};if(j&&n.outlineMode!=="none"){if(p.isExpanded){h.html='<div class="'+o.options.wijCSS.icon+" "+p.getHeaderImageClass(true)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>'}else{h.html='<div class="'+o.options.wijCSS.icon+" "+p.getHeaderImageClass(false)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>'}}l.push(h);if(v.aggregate&&(v.aggregate!=="none")){s=this._getAggregate(t,v,v,j,m)}x=(j)?n.headerText:n.footerText;if(x==="custom"){i={data:this._data,column:v,groupByColumn:n.owner,groupText:m,text:"",groupingStart:t.r1,groupingEnd:t.r2,isGroupHeader:j,aggregate:s};if(this._grid._trigger("groupText",null,i)){x=i.text}}else{if((x===undefined)||(x===null)){if(j){x="{1}: {0}"}if(s||(s===0)){x=x?x+" {2}":"{2}"}}x=b.grid.stringFormat(x,m,v&&v.headerText?v.headerText:"",s.toString())}if(!x){x="&nbsp;"}h.html+="<span>"+x+"</span>";this._addIndent(h,n.level-1);u=1;k=(this._grid.options.showRowHeader)?1:0;r=true;for(;k<this._leaves.length;k++){y=this._leaves[k];if(y.parentVis){if(r){r=false;continue}if((y.dynamic!==true)&&y.aggregate&&(y.aggregate!=="none")){break}u++}}for(;k<this._leaves.length;k++){y=this._leaves[k];if(y.parentVis){q=this._getAggregate(t,y,n.owner,j,m);if(!q&&(q!==0)){q="&nbsp;"}l.push({html:q.toString(),__attr:{groupInfo:{leafIndex:y.leavesIdx,purpose:b.grid.groupRowCellPurpose.aggregateCell}}})}}h.__attr.colSpan=u;h.__attr.groupInfo={leafIndex:v.leavesIdx,purpose:b.grid.groupRowCellPurpose.groupCell};return l};g.prototype._getAggregate=function(l,k,i,o,n){var h="",m,j,p;if(!k.aggregate||(k.aggregate==="none")){return h}if(k.aggregate==="custom"){m={data:this._data,column:k,groupByColumn:i,groupText:n,text:"",groupingStart:l.r1,groupingEnd:l.r2,isGroupHeader:o};if(this._grid._trigger("groupAggregate",null,m)){h=m.text}}else{j=new b.grid.tally();for(p=l.r1;p<=l.r2;p++){j.add(this._data[p][k.dataIndex].value)}h=j.getValueString(k)}return h};g.prototype._getGroupCellRange=function(p,l,h){var o=l.leavesIdx,j=new b.grid.cellRange(p,o),i=b.grid.groupHelper.getParentGroupRange(this._leaves,j,h),n,m,k;if(this._data[p].rowType&b.grid.rowType.data){n=this._data[p][l.dataIndex].value;if(n instanceof Date){n=n.getTime()}for(j.r2=p,k=this._data.length-1;j.r2<k;j.r2++){if(!(this._data[j.r2+1].rowType&b.grid.rowType.data)||(i&&(j.r2+1>i.cr.r2))){break}m=this._data[j.r2+1][l.dataIndex].value;if(m instanceof Date){m=m.getTime()}if(n!==m){break}}}return j};g.prototype._addGroupRange=function(j,n,h,p){var q=null,o=b.grid.groupHelper.getChildGroupIndex(n,j.expandInfo),m,i,l,k;if(o>=0&&o<j.expandInfo.length){q=j.expandInfo[o]}else{m=new b.grid.cellRange(n.r1,n.r1,n.r2,n.r2);i=(j.position==="footer"||!p)?true:h&&(j.outlineMode!=="startCollapsed");q=new b.grid.groupRange(i,m,-1,j.position,p);q.owner=j;j.expandInfo.push(q)}if(q&&p){l=n.r1;k=n.r2;if(j.position==="headerAndFooter"){k+=2}if(j.position!=="headerAndFooter"){k++}q.cr.r2=k}return q};g.prototype._updateByGroupRange=function(p,h){var n,o,k,l,m,r,q;for(n=0,o=this._leaves.length;n<o;n++){k=this._leaves[n].groupInfo;if(k&&(k.level<h)){l=(k.expandInfo)?k.expandInfo.length:0;for(m=0;m<l;m++){r=k.expandInfo[m];q=(p.position==="headerAndFooter")?2:1;if(r.cr.r1>=p.cr.r1&&!((r.cr.r1===p.cr.r1)&&(r.position==="footer"))){r.cr.r1+=q}if(r.cr.r2>=p.cr.r1){r.cr.r2+=q}}}}};g.prototype._addIndent=function(i,j){var h;if(j>0&&(h=this._grid.options.groupIndent)){i.__style.paddingLeft=(h*j)+"px"}};return g})();d.grouper=c})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var d=jQuery;var e=(function(){function f(){}f._getGroupInfoRegExp=new RegExp(".*G([HF]){1}(\\d+)-(\\d+)$");f.getGroupInfo=function m(s){if(s){var r=b.grid.groupHelper._getGroupInfoRegExp.exec(s.id),t,p,q;if(r){t=parseInt(r[3],10);p=parseInt(r[2],10);q=(r[1]==="H");return{level:t,index:p,isHeader:q,toString:function(){return(q?"GH":"GF")+p+"-"+t}}}}return null};f.getColumnByGroupLevel=function j(t,s){var r,p,q;for(r=0,p=t.length;r<p;r++){q=t[r];if(q.groupInfo&&(q.groupInfo.level===s)){return q}}return null};f.getGroupedColumnsCount=function l(t){var q=0,s,p,r;for(s=0,p=t.length;s<p;s++){r=t[s].groupInfo;if(r&&(r.position==="header"||r.position==="headerAndFooter"||r.position==="footer")){q++}}return q};f.getChildGroupIndex=function n(q,p){var u=0,r=p.length-1,s,t;while(u<=r){s=((r-u)>>1)+u;t=p[s].cr.r1-q.r1;if(t===0){return s}if(t<0){u=s+1}else{r=s-1}}return u};f.getParentGroupIndex=function h(q,r){var p=b.grid.groupHelper.getChildGroupIndex(q,r);if(p>0){p--}return(p<r.length)?p:-1};f.getChildGroupRanges=function k(t,v,p){var y=[],r,q,s,u,w,x=b.grid.groupHelper.getColumnByGroupLevel(t,p+1);if(x){r=x.groupInfo.expandInfo;w=b.grid.groupHelper.getChildGroupIndex(v,r);for(s=w,u=r.length;s<u;s++){q=r[s];if(q.cr.r2<=v.r2){y.push(q)}else{break}}}return y};f.getParentGroupRange=function g(u,q,t){var s,r,p;if(t===undefined){t=65535}if(t-2>=0){for(s=u.length-1;s>=0;s--){r=u[s].groupInfo;if(!r||!r.expandInfo||(r.level<0)||(r.level!==t-1)){continue}p=b.grid.groupHelper.getParentGroupIndex(q,r.expandInfo);if(p>=0){return r.expandInfo[p]}}}return null};f.isParentCollapsed=function i(t,p,s){var q,r;if(s===1){return false}for(q=s;q>1;q--){r=b.grid.groupHelper.getParentGroupRange(t,p,q);if(r&&!r.isExpanded){return true}p=r.cr}return false};f.isParentExpanded=function o(t,p,s){var q,r;if(s===1){return true}for(q=s;q>1;q--){r=b.grid.groupHelper.getParentGroupRange(t,p,q);if(r&&r.isExpanded){return true}p=r.cr}return false};return f})();c.groupHelper=e})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(){function g(j,k,h,i){switch(arguments.length){case 2:this.r1=this.r2=j;this.c1=this.c2=k;break;case 4:this.r1=j;this.r2=h;this.c1=k;this.c2=i;break;default:this.r1=0;this.r2=0;this.c1=0;this.c2=0}}g.prototype.isSingleCell=function(){return((this.r1===this.r2)&&(this.c1===this.c2))};return g})();d.cellRange=c;var f=(function(){function g(){}g.prototype.merge=function(m,j){this._leaves=j;this._data=m;var l,h,k;for(l=0,h=this._leaves.length;l<h;l++){k=this._leaves[l];if((k.dataIndex>=0)&&!k.isBand&&(k.rowMerge==="free"||k.rowMerge==="restricted")){this._mergeColumn(k)}}delete this._data;delete this._leaves};g.prototype._mergeColumn=function(n){var m=n.dataIndex,k,h,j,l,o;for(k=0,h=this._data.length;k<h;k++){if(!(this._data[k].rowType&b.grid.rowType.data)){continue}j=this._getCellRange(k,n);if(j.r1!==j.r2){l=j.r2-j.r1+1;this._data[j.r1][m].__attr.rowSpan=l;for(o=j.r1+1;o<=j.r2;o++){this._data[o][m].visible=false}}k=j.r2}};g.prototype._getCellRange=function(i,l){var k=l.dataIndex,n=new b.grid.cellRange(i,k),p=(this._data[i][k].value||"").toString(),j=this._data.length,h,o,m,q;for(n.r2=i;n.r2<j-1;n.r2++){h=this._data[n.r2+1];if(!(h.rowType&b.grid.rowType.data)||((h[k].value||"").toString()!==p)){break}}o=l.leavesIdx;if(o>0&&l.rowMerge==="restricted"){m=this._leaves[o-1];if(m.dataIndex>=0){q=this._getCellRange(i,m);n.r1=Math.max(n.r1,q.r1);n.r2=Math.min(n.r2,q.r2)}}return n};return g})();d.merger=f})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var l=jQuery;c.EXPANDO="__wijgrid";(function(G){G._map=[];G.header=1;G.data=2;G.dataAlt=4;G.filter=8;G.groupHeader=16;G.groupFooter=32;G.footer=64;G.emptyDataRow=128;G.fooRow=65536})(c.rowType||(c.rowType={}));var u=c.rowType;(function(G){G._map=[];G.none=0;G.rendering=1;G.current=2;G.hovered=4;G.selected=8})(c.renderState||(c.renderState={}));var E=c.renderState;(function(G){G._map=[];G.table=0;G.head=1;G.body=2;G.foot=3})(c.rowScope||(c.rowScope={}));var k=c.rowScope;(function(G){G._map=[];G.none=0;G.toColumn=1;G.toRow=2})(c.cellRangeExtendMode||(c.cellRangeExtendMode={}));var p=c.cellRangeExtendMode;(function(G){G._map=[];G.createIfNull=0;G.createAlways=1;G.dispose=2})(c.objectMode||(c.objectMode={}));var C=c.objectMode;(function(G){G._map=[];G.groupCell=0;G.aggregateCell=1})(c.groupRowCellPurpose||(c.groupRowCellPurpose={}));var o=c.groupRowCellPurpose;function h(J,H){var K,G,I;if(l.isArray(J)&&l.isArray(H)){if(J.length===H.length){I=true;for(K=0,G=J.length;K<G&&I;K++){I=b.grid.compareObj(J[K],H[K])}return I}}else{if(l.isPlainObject(J)&&l.isPlainObject(H)){for(K in J){if(J.hasOwnProperty(K)){if(!b.grid.compareObj(J[K],H[K])){return false}}}for(K in H){if(H.hasOwnProperty(K)){if(!b.grid.compareObj(J[K],H[K])){return false}}}return true}else{if(J instanceof Date){J=J.getTime()}if(H instanceof Date){H=H.getTime()}}}return J===H}c.compareObj=h;function e(J){var K=[];for(var I=0;I<(arguments.length-1);I++){K[I]=arguments[I+1]}var H,G;if(!J){return""}for(H=0,G=K.length;H<G;H++){J=J.replace(new RegExp("\\{"+H+"\\}","gm"),K[H])}return J}c.stringFormat=e;function m(G){return(G&&!(G<0))||(G===0)}c.validDataKey=m;function w(G){return G.dataType||G._underlyingDataType||"string"}c.getDataType=w;function d(G,H){if(G&&H){G.find(".ui-widget").each(function(I,J){l.each(l(J).data(),function(L,K){if(K.widgetName){H(I,K)}});return true})}}c.iterateChildrenWidgets=d;function F(G,H){var I=[];l.each(G.data(),function(J){if(J.indexOf(H)===0){I.push(J)}});l.each(I,function(J,K){G.removeData(K)})}c.remove$dataByPrefix=F;var y=(function(){function G(H){this._dom=H}G.prototype.getSelection=function(){var J=0,H=0,I;if(this._dom.selectionStart!==undefined){J=this._dom.selectionStart;H=this._dom.selectionEnd}else{if(document.selection){I=document.selection.createRange().duplicate();H=I.text.length;J=Math.abs(I.moveStart("character",-this._dom.value.length));H+=J}}return{start:J,end:H,length:H-J}};G.prototype.setSelection=function(H){if(this._dom.selectionStart!==undefined){this._dom.setSelectionRange(H.start,H.end)}else{var I=this._dom.createTextRange();I.collapse(true);I.moveStart("character",H.start);I.moveEnd("character",H.end);I.select()}};G.prototype.toggleSelection=function(J){var H=l(this._dom),I="onselectstart" in this._dom;if(J){if(I){H.unbind(".wijgrid-disableSelection")}else{H.css({MozUserSelect:"",WebkitUserSelect:""})}}else{if(I){H.bind("selectstart.wijgrid-disableSelection",function(K){K.preventDefault()})}else{H.css({MozUserSelect:"-moz-none",WebkitUserSelect:"none"})}}};return G})();c.domSelection=y;function g(G){return l.extend(true,{},b.c1basefield.prototype.options,b.c1field.prototype.options,{dynamic:true,isLeaf:true,isBand:false,parentIdx:-1},G)}c.createDynamicField=g;function n(I,H){if(I){var G=I.nodeType?l(I):I,J=G.offset();if(J){if(H){return{top:J.top,left:J.left,width:G[0].clientWidth||0,height:G[0].clientHeight||0}}return{top:J.top,left:J.left,width:G.outerWidth(),height:G.outerHeight()}}}return null}c.bounds=n;function r(J,L,I){if(L===undefined){L=3}if(J&&L!==0){if(!I&&J.nodeType===3){return J.nodeValue}if(J.nodeType===1){switch((J).type){case"button":case"text":case"textarea":case"select-one":return(J).value;case"checkbox":return(J).checked.toString()}var G="",H=0,K;while(K=J.childNodes[H++]){G+=b.grid._getDOMText(K,L-1)}return G}}return""}c._getDOMText=r;function D(I,M,G,O){var L=(I.jquery||l.isArray(I)),J,N,K,H=M+G;if(arguments.length===3){if(L){return l.data(I[0],H)}return l.data(I,H)}else{if(L){for(J=0,N=I.length;J<N;J++){K=l.data(I[J],H,O)}return K}return l.data(I,H,O)}}c.dataPrefix=D;function z(J,K){if(K&&J){var G,I,H;for(G in K){if(K.hasOwnProperty(G)){I=K[G];H=typeof(I);if((H==="string"||H==="boolean"||H==="number")&&(J[G]===undefined)){J[G]=I}}}}}c.shallowMerge=z;function B(G){return(G&&(typeof(G)==="object")&&!(G instanceof Date))}c.isCustomObject=B;function q(I,K){var G,J,H=l.isFunction(K);for(G in I){if(I.hasOwnProperty(G)){J=H?K(I[G]):(I[G]===K);if(J===true){return{at:G,found:I[G]}}}}return{at:null,found:null}}c.search=q;function v(N,I){if(N){var L,H,K=0,G={},M,J;for(L=0,H=N.attributes.length;L<H;L++){J=N.attributes[L].name;if(J&&(!I||!I(J))){M=N.getAttribute(J);if(J==="style"){M=(typeof(M)==="object")?M.cssText:M}if(!M&&J==="class"){M=N.getAttribute("className")}if(M&&(typeof(M)!=="function")){G[J]=M;K++}}}if(K){return G}}return null}c.getAttributes=v;function s(I,J){var H,K,M,G,L;if(I){if(typeof(J)!=="object"&&!l.isFunction(J)){J={}}for(H in I){K=I[H];M=J[M];if(K===J){continue}if(K&&(l.isPlainObject(K)||(G=l.isArray(K)))){if(G){G=false;L=M&&l.isArray(M)?M:[]}else{L=M&&l.isPlainObject(M)?M:{}}J[H]=b.grid.deepExtend(K,L)}else{J[H]=K}}}return J}c.deepExtend=s;function x(){if(l.ui&&l.ui.keyCode){return l.ui.keyCode}if(l.mobile&&l.mobile.keyCode){return l.mobile.keyCode}throw"keyCode object is not found"}c.getKeyCodeEnum=x;function i(H,G){if(H&&H.jquery){H=H[0]}if(H){return(arguments.length===1)?l.data(H,"wijgridwidgetName"):l.data(H,"wijgridwidgetName",G)}return undefined}c.widgetName=i;function j(H,G,I){return(H>G)&&(H<(G+I))}c.isOverAxis=j;function A(L,H,K,J,G,I){return b.grid.isOverAxis(L,K,G)&&b.grid.isOverAxis(H,J,I)}c.isOver=A;var f=0;function t(){return"uid"+f++}c.getUID=t;l.extend(l.wijmo.wijgrid,{rowType:b.grid.rowType,renderState:b.grid.renderState,bounds:b.grid.bounds})})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(){function g(i){this._cache={};var h=this;this._wijgrid=i;this._addOperator(null,{applicableTo:null,name:"NoFilter",arity:1,operator:function(){return true}});e.each(b.data.filtering.ops,function(j,k){h._addOperator(j,k)});e.each(i.options.customFilterOperators,function(j,k){h._addOperator(null,k,true)})}g.prototype.getByName=function(h){var i=this.getByNameInt(h);return(i)?i.op:null};g.prototype.getByNameInt=function(h){return this._cache[(h||"").toLowerCase()]};g.prototype.getByDataType=function(i){var j=[],h;e.each(this._cache,function(k,m){var l=m.op;if(!l.applicableTo||e.inArray(i,l.applicableTo)>=0){j.push(m)}});switch(this._wijgrid.options.filterOperatorsSortMode.toLowerCase()){case"alphabetical":j.sort(this._sortAlpha);break;case"alphabeticalcustomfirst":j.sort(this._sortAlphaCustomFirst);break;case"alphabeticalembeddedFirst":j.sort(this._sortAlphaEmbeddedFirst);break;case"none":break;default:break}h=e.map(j,function(l,k){return l.op});return h};g.prototype._addOperator=function(h,j,i){if(typeof i==="undefined"){i=false}if(h&&!j.name){j.name=h}h=(h||j.name).toLowerCase();if(!this._cache[h]){this._cache[h]={op:j,isCustom:(i===true)}}};g.prototype._sortAlpha=function(i,h){var k=i.op.name.toLowerCase(),j=h.op.name.toLowerCase();if(k!==j){if(k==="nofilter"){return -1}if(j==="nofilter"){return 1}}if(k===j){return 0}return(k<j)?-1:1};g.prototype._sortAlphaEmbeddedFirst=function(i,h){var k=i.op.name.toLowerCase(),j=h.op.name.toLowerCase();if(k!==j){if(k==="nofilter"){return -1}if(j==="nofilter"){return 1}}if(i.isCustom!==h.isCustom){if(i.isCustom){return 1}if(h.isCustom){return -1}}if(k===j){return 0}return(k<j)?-1:1};g.prototype._sortAlphaCustomFirst=function(i,h){var k=i.op.name.toLowerCase(),j=h.op.name.toLowerCase();if(k!==j){if(k==="nofilter"){return -1}if(j==="nofilter"){return 1}}if(i.isCustom!==h.isCustom){if(i.isCustom){return -1}if(h.isCustom){return 1}}if(k===j){return 0}return(k<j)?-1:1};return g})();d.filterOperatorsCache=c;var f=(function(){function k(){}k.marker="_wijgrid";k.getSingleValue=function h(l){if(e.isArray(l)){l=l[0];if(e.isArray(l)){l=l[0]}}return l};k.getSingleOperatorName=function g(l){if(e.isArray(l)){l=l[0]}return l.name||l||""};k.verify=function j(n,s,p,o){if(n){if(e.isArray(n)){var q,m,r=[],l=[];if(!e.isArray(s)){s=[s]}for(q=0,m=n.length;q<m;q++){if(b.grid.filterHelper._verifySingleOp(n[q],s[q],p,o)){r.push({name:n[q].name||n[q],condition:n[q].condition||"or"});l.push(s?s[q]:undefined)}}if(r.length){return{filterOperator:r,filterValue:l}}}else{if(b.grid.filterHelper._verifySingleOp(n,s,p,o)){return{filterOperator:n,filterValue:s}}}}return null};k._verifySingleOp=function i(l,p,n,m){if(l&&(l=(l.name||l))){var o;l=(l||"").toLowerCase();if((l!=="nofilter"||p!==undefined)&&(o=m.getByName(l))){if(o.applicableTo===null||e.inArray(n||"string",o.applicableTo)>=0){if(o.arity===1||(o.arity>1&&b.grid.filterHelper.getSingleValue(p)!==undefined)){return true}}}}return false};return k})();d.filterHelper=f})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var f=jQuery;function e(k,j){if(k&&!k.nodeType){k=k[0]}if(k){switch(j){case b.grid.rowScope.head:return k.tHead;case b.grid.rowScope.body:if(k.tBodies){return k.tBodies[0]||null}break;case b.grid.rowScope.foot:return k.tFoot;default:return k}}return null}d.getTableSection=e;function i(k,j){var l;if(k&&!k.nodeType){k=k[0]}return(k&&(l=this.getTableSection(k,j)))?l.rows.length:0}d.getTableSectionLength=i;function h(k,j,m){var l;if(k&&!k.nodeType){k=k[0]}return(k&&(l=this.getTableSection(k,j)))?(l.rows[m]||null):null}d.getTableSectionRow=h;function c(s,t,n){var o,q,w,j,k,v,r,l,u=[],m=function(x){x=x.toLowerCase();return x==="rowspan"||x==="colspan"},p;if(s&&!s.nodeType){s=s[0]}if(s&&(p=this.getTableSection(s,t))){for(o=0,q=p.rows.length;o<q;o++){k=p.rows[o];v=[];if(n){r=(b).data.Expando.getFrom(v,true);l=r[b.grid.EXPANDO]={cellsAttributes:{},rowAttributes:b.grid.getAttributes(k)||{}}}for(w=0,j=k.cells.length;w<j;w++){v[w]=f.trim((k.cells[w]).innerHTML);if(n){l.cellsAttributes[w]=b.grid.getAttributes(k.cells[w],m)||{}}}u[o]=v}}return u}d.readTableSection=c;var g=(function(){function j(l,m,k,n){this._width=0;this._table=l;this._offsets=[];if(n){this.ensureColGroup()}if(k){this.ensureTBody()}if(!m){this._buildOffsets()}}j.prototype.element=function(){return this._table};j.prototype.width=function(){return this._width};j.prototype.getCellIdx=function(l,k){return(l<this._width)?this._offsets[k][l].cellIdx:-1};j.prototype.getColumnIdx=function(l,k){if(typeof(l)!=="number"){var m=l;l=m.cellIndex;k=m.parentNode.rowIndex}return(l<this._width)?this._offsets[k][l].colIdx:-1};j.prototype.clearSection=function(l){var n,k,m=b.grid.getTableSection(this._table,l);switch(l){case b.grid.rowScope.body:n=this.getSectionLength(b.grid.rowScope.table);k=n+this.getSectionLength(l)-1;break;case b.grid.rowScope.foot:n=this.getSectionLength(b.grid.rowScope.table)+this.getSectionLength(b.grid.rowScope.head);k=n+this.getSectionLength(l)-1;break;default:n=0;k=this.getSectionLength(l)-1}while(m.rows.length){m.deleteRow(0)}this._offsets.splice(n,k-n+1)};j.prototype.getSectionLength=function(k){return b.grid.getTableSectionLength(this._table,k)};j.prototype.getSectionRow=function(l,k){return b.grid.getTableSectionRow(this._table,k,l)};j.prototype.forEachColumnCellNatural=function(n,q,p){var l,m,o,k;for(l=0,m=this._table.rows.length;l<m;l++){o=this._table.rows[l];if(n<o.cells.length){k=q(o.cells[n],l,p);if(k!==true){return k}}}return true};j.prototype.forEachColumnCell=function(o,r,q){var l,n,p,m,k;for(l=0,n=this._offsets.length;l<n;l++){p=this._table.rows[l];m=this.getCellIdx(o,l);if(m>=0){k=r(p.cells[m],l,q);if(k!==true){return k}}}return true};j.prototype.forEachRowCell=function(q,p,o){var n=this._table.rows[q],l,m,k;for(l=0,m=n.cells.length;l<m;l++){k=p(n.cells[l],l,o);if(k!==true){return k}}return true};j.prototype.colGroupTag=function(){var k=this._table.getElementsByTagName("colgroup");return((k&&k[0]))||null};j.prototype.colTags=function(){var k=this.colGroupTag();return(k&&k.getElementsByTagName("col"))||[]};j.prototype.ensureTBody=function(){return((this._table.tBodies&&this._table.tBodies[0])||this._table.appendChild(document.createElement("tbody")))};j.prototype.ensureTHead=function(){return(this._table.tHead&&this._table.tHead[0])||this._table.createTHead()};j.prototype.ensureTFoot=function(){return(this._table.tFoot&&this._table.tFoot[0])||this._table.createTFoot()};j.prototype.ensureColGroup=function(){var k=this._table.getElementsByTagName("colgroup");return((k&&k[0])||this._table.appendChild(document.createElement("colgroup")))};j.prototype.appendCol=function(l){var k=this.ensureColGroup();return((l&&k.appendChild(l))||k.appendChild(document.createElement("col")))};j.prototype.removeOffset=function(k){if(k>=0&&k<this._offsets.length){if(k<0||(!k&&k!==0)){k=this._offsets.length-1}this._offsets.splice(k,1)}};j.prototype.insertOffset=function(k){var m,l;if(this._width>0){m=[];for(l=0;l<this._width;l++){m.push({cellIdx:l,colIdx:l})}if(k<0||(!k&&k!==0)){k=this._offsets.length}this._offsets.splice(k,0,m)}};j.prototype.rebuildOffsets=function(){this._offsets=[];this._width=0;this._buildOffsets()};j.prototype._buildOffsets=function(){var q=[],l,o,s,u,n,t,k,r,p,m;for(o=0,s=this._table.rows.length;o<s;o++){l=[];this._offsets[o]=l;u=this._table.rows[o];for(n=0,t=0,k=u.cells.length;n<k;n++,t++){r=u.cells[n];for(;q[t]>1;t++){q[t]--;l[t]={cellIdx:-1,colIdx:-1}}if(!(q[t]>1)){q[t]=r.rowSpan}l[t]={cellIdx:n,colIdx:-1};l[n].colIdx=t;p=r.colSpan;for(;p>1;p--){l[++t]={cellIdx:-1,colIdx:-1}}}m=q.length;for(;t<m;t++){q[t]--;l[t]={cellIdx:-1,colIdx:-1}}this._width=Math.max(this._width,m)}};return j})();d.htmlTableAccessor=g})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(){function g(h,k,i,j){if(typeof i==="undefined"){i=null}if(typeof j==="undefined"){j=false}this.__isEdit=false;this._wijgrid=i;if(j){this._cia=h;this._ria=k}else{this._ci=h;this._ri=k}}g.outsideValue=new g(-1,-1,null,true);g.prototype.cellIndexAbs=function(h){if(arguments.length===0){this._ensureCia();return this._cia}this._ci=undefined;this._cia=h};g.prototype.rowIndexAbs=function(h){if(arguments.length===0){this._ensureRia();return this._ria}this._ri=undefined;this._ria=h};g.prototype.cellIndex=function(h){if(arguments.length===0){this._ensureCi();return this._ci}this._cia=undefined;this._ci=h};g.prototype.column=function(){if(this._wijgrid&&this._isValid()){return this._wijgrid._field("visibleLeaves")[this.cellIndexAbs()]}return null};g.prototype.container=function(){var i=this.tableCell(),h;if(i){h=e(i).children("div.wijmo-wijgrid-innercell");if(h){return h}}return null};g.prototype.isEqual=function(h){return(h&&(h.rowIndex()===this.rowIndex())&&(h.cellIndex()===this.cellIndex()))};g.prototype.row=function(){var i=null,h=null;if(this._wijgrid){i=this._wijgrid._view().rows().item(this.rowIndexAbs());if(i&&i.length){h=this._wijgrid._view()._getRowInfo(i)}}return h};g.prototype.rowIndex=function(h){if(arguments.length===0){this._ensureRi();return this._ri}this._ria=undefined;this._ri=h};g.prototype.tableCell=function(){if(this._wijgrid&&this._isValid()){return this._wijgrid._view().getCell(this.cellIndexAbs(),this.rowIndexAbs())}return null};g.prototype.value=function(i){var h,k,j;if(this._wijgrid&&this._isValid()){k=this._wijgrid._view()._getRowInfo(this._wijgrid._rows().item(this.rowIndex()));if(k.type&b.grid.rowType.data){h=this.column();if(arguments.length===0){j=this._wijgrid._dataViewWrapper.getValue(k.data,h.dataKey);return this._wijgrid._parse(h,j)}else{i=this._wijgrid._parse(h,i);if((i===null&&h.valueRequired)||((b.grid.getDataType(h)!=="string")&&isNaN(i))){throw"invalid value"}this._wijgrid._dataViewWrapper.setValue(k.dataItemIndex,h.dataKey,i)}}}};g.prototype.toString=function(){return this.cellIndex()+":"+this.rowIndex()};g.prototype._clip=function(i,k){if(typeof k==="undefined"){k=false}var h=false,j;if(k){if(this.cellIndexAbs()<(j=i.topLeft().cellIndexAbs())){h=true;this._cia=j;this._ci=undefined}if(this.cellIndexAbs()>(j=i.bottomRight().cellIndexAbs())){h=true;this._cia=j;this._ci=undefined}if(this.rowIndexAbs()<(j=i.topLeft().rowIndexAbs())){h=true;this._ria=j;this._ri=undefined}if(this.rowIndexAbs()>(j=i.bottomRight().rowIndexAbs())){h=true;this._ria=j;this._ri=undefined}}else{if(this.cellIndex()<(j=i.topLeft().cellIndex())){h=true;this._ci=j;this._cia=undefined}if(this.cellIndex()>(j=i.bottomRight().cellIndex())){h=true;this._ci=j;this._cia=undefined}if(this.rowIndex()<(j=i.topLeft().rowIndex())){h=true;this._ri=j;this._ria=undefined}if(this.rowIndex()>(j=i.bottomRight().rowIndex())){h=true;this._ri=j;this._ria=undefined}}return h};g.prototype._clone=function(){return new b.grid.cellInfo(this.cellIndex(),this.rowIndex(),this._wijgrid)};g.prototype._isValid=function(){return this.cellIndex()>=0&&this.rowIndex()>=0};g.prototype._isEdit=function(h){if(!arguments.length){return this.__isEdit}this.__isEdit=h};g.prototype._setGridView=function(h){this._wijgrid=h};g.prototype._ensureCia=function(){if(this._cia===undefined){if(this._ci===null){throw"relative index value is undefined"}if(this._ci>=0){if(!this._wijgrid){throw"wijgrid is null"}this._cia=this._ci+this._wijgrid._getDataToAbsOffset().x}else{this._cia=this._ci}if(this._cia<0){this._cia=-1}}};g.prototype._ensureRia=function(){if(this._ria===undefined){if(this._ri===undefined){throw"relative index value is undefined"}if(this._ri>=0){if(!this._wijgrid){throw"wijgrid is null"}this._ria=this._ri+this._wijgrid._getDataToAbsOffset().y}else{this._ria=this._ri}if(this._ria<0){this._ria=-1}}};g.prototype._ensureCi=function(){if(this._ci===undefined){if(this._cia===undefined){throw"absolute index value is undefined"}if(this._cia>=0){if(!this._wijgrid){throw"wijgrid is null"}this._ci=this._cia-this._wijgrid._getDataToAbsOffset().x}else{this._ci=this._cia}if(this._ci<0){this._ci=-1}}};g.prototype._ensureRi=function(){if(this._ri===undefined){if(this._ria===undefined){throw"relative index value is undefined"}if(this._ria>=0){if(!this._wijgrid){throw"wijgrid is null"}this._ri=this._ria-this._wijgrid._getDataToAbsOffset().y}else{this._ri=this._ria}if(this._ri<0){this._ri=-1}}};return g})();d.cellInfo=c;var f=(function(){function g(i,h){if(!i||!h){throw"invalid arguments"}this._topLeft=i._clone();this._bottomRight=h._clone()}g.prototype.bottomRight=function(){return this._bottomRight};g.prototype.isEqual=function(h){return(h&&this._topLeft.isEqual(h.topLeft())&&this._bottomRight.isEqual(h.bottomRight()))};g.prototype.topLeft=function(){return this._topLeft};g.prototype.toString=function(){return this._topLeft.toString()+" - "+this._bottomRight.toString()};g.prototype._isIntersect=function(j){var i,h,l,k;if(j){i=j.bottomRight().rowIndex()-j.topLeft().rowIndex()+1;h=this._bottomRight.rowIndex()-this._topLeft.rowIndex()+1;if((j.topLeft().rowIndex()+i)-this._topLeft.rowIndex()<i+h){l=j.bottomRight().cellIndex()-j.topLeft().cellIndex()+1;k=this._bottomRight.cellIndex()-this._topLeft.cellIndex()+1;return((j.topLeft().cellIndex()+l)-this._topLeft.cellIndex()<l+k)}}return false};g.prototype._isValid=function(){return this._topLeft._isValid()&&this._bottomRight._isValid()};g.prototype._clip=function(h,i){if(typeof i==="undefined"){i=false}return this._topLeft._clip(h,i)||this._bottomRight._clip(h,i)};g.prototype._clone=function(){return new g(this._topLeft._clone(),this._bottomRight._clone())};g.prototype._containsCellInfo=function(h){return(h&&h.cellIndex()>=this._topLeft.cellIndex()&&h.cellIndex()<=this._bottomRight.cellIndex()&&h.rowIndex()>=this._topLeft.rowIndex()&&h.rowIndex()<=this._bottomRight.rowIndex())};g.prototype._containsCellRange=function(h){return(h&&this._containsCellInfo(h.topLeft())&&this._containsCellInfo(h.bottomRight()))};g.prototype._extend=function(i,h){if(i===b.grid.cellRangeExtendMode.toColumn){this._topLeft.rowIndex(h.topLeft().rowIndex());this._bottomRight.rowIndex(h.bottomRight().rowIndex())}else{if(i===b.grid.cellRangeExtendMode.toRow){this._topLeft.cellIndex(h.topLeft().cellIndex());this._bottomRight.cellIndex(h.bottomRight().cellIndex())}}return this};g.prototype._normalize=function(){var i=this._topLeft.cellIndex(),k=this._topLeft.rowIndex(),h=this._bottomRight.cellIndex(),j=this._bottomRight.rowIndex();this._topLeft.cellIndex(Math.min(i,h));this._topLeft.rowIndex(Math.min(k,j));this._bottomRight.cellIndex(Math.max(i,h));this._bottomRight.rowIndex(Math.max(k,j))};return g})();d.cellInfoRange=f;e.extend(e.wijmo.wijgrid,{cellInfo:b.grid.cellInfo,cellInfoRange:b.grid.cellInfoRange})})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(){function f(g,h){this._rowHeaderSize=22;if(!g){throw"'wijgrid' must be specified"}this._wijgrid=g;this._bounds=h;this._wijgrid.element.addClass("wijmo-wijgrid-table")}f.prototype.dispose=function(){this.toggleDOMSelection(true);this._wijgrid.element.removeClass("wijmo-wijgrid-table")};f.prototype.ensureDisabledState=function(){var i="wijmo-wijgrid-disabled "+this._wijgrid.options.wijCSS.stateDisabled,h=this._wijgrid.options.disabled,g=this;e.each(this.subTables(),function(k,l){if(l){var j=e(l.element());if(h){j.addClass(i);g._wijgrid._setAttr(j,"aria-disabled",true)}else{j.removeClass(i);g._wijgrid._setAttr(j,"aria-disabled",false)}}})};f.prototype.ensureWidth=function(h,i,g){this._setColumnWidth(h,i)};f.prototype.ensureHeight=function(g){};f.prototype.getScrollValue=function(){return null};f.prototype.getVisibleAreaBounds=function(){throw"not implemented"};f.prototype.getFixedAreaVisibleBounds=function(){throw"not implemented"};f.prototype.render=function(){this._ensureRenderBounds();this._preRender();this._renderContent();this._postRender()};f.prototype.toggleDOMSelection=function(g){e.each(this.subTables(),function(h,i){(new b.grid.domSelection(i.element())).toggleSelection(g)});(new b.grid.domSelection(this._wijgrid.outerDiv)).toggleSelection(g)};f.prototype.updateSplits=function(g){throw"not implemented"};f.prototype.bodyRows=function(){if(!this._bodyRowsAccessor){this._bodyRowsAccessor=new b.grid.rowAccessor(this,b.grid.rowScope.body,0,0)}return this._bodyRowsAccessor};f.prototype.filterRow=function(){if(this._wijgrid.options.showFilter){var g=new b.grid.rowAccessor(this,b.grid.rowScope.head,0,0);return g.item(g.length()-1)}return null};f.prototype.headerRows=function(){var g;if(!this._headerRowsAccessor){g=this._wijgrid.options.showFilter?1:0;this._headerRowsAccessor=new b.grid.rowAccessor(this,b.grid.rowScope.head,0,g)}return this._headerRowsAccessor};f.prototype.rows=function(){if(!this._rowsAccessor){this._rowsAccessor=new b.grid.rowAccessor(this,b.grid.rowScope.table,0,0)}return this._rowsAccessor};f.prototype.focusableElement=function(){throw"not implemented"};f.prototype.forEachColumnCell=function(g,i,h){throw"not implemented"};f.prototype.forEachRowCell=function(i,h,g){throw"not implemented"};f.prototype.getAbsoluteCellInfo=function(g){throw"not implemented"};f.prototype.getAbsoluteRowIndex=function(g){throw"not implemented"};f.prototype.getCell=function(h,g){throw"not implemented"};f.prototype.getColumnIndex=function(g){throw"not implemented"};f.prototype.getHeaderCell=function(g){throw"not implemented"};f.prototype.getJoinedCols=function(g){throw"not implemented"};f.prototype.getJoinedRows=function(h,g){throw"not implemented"};f.prototype.getJoinedTables=function(g,h){throw"not implemented"};f.prototype.subTables=function(){throw"not implemented"};f.prototype._getMappedScrollMode=function(){var i=this._wijgrid.options.scrollMode,g="auto",h="auto";switch(i){case"horizontal":g="hidden";h="visible";break;case"vertical":g="visible";h="hidden";break;case"both":g="visible";h="visible";break}return{vScrollBarVisibility:g,hScrollBarVisibility:h}};f.prototype._postRender=function(){this.toggleDOMSelection(this._wijgrid.options.selectionMode==="none");this.ensureDisabledState()};f.prototype._preRender=function(){throw"not implemented"};f.prototype._ensureRenderBounds=function(){var g=this._wijgrid._getDataCellsRange();this._bounds.start=0;this._bounds.end=g.bottomRight().rowIndex()};f.prototype._renderContent=function(){this._renderCOLS();this._renderHeader();if(this._wijgrid.options.showFilter){this._renderFilter()}this._renderBody();if(this._wijgrid.options.showFooter){this._renderFooter()}};f.prototype._renderCOLS=function(){var h=this._wijgrid._field("visibleLeaves"),j,l,k,g;for(k=0,g=h.length;k<g;k++){j=h[k];l=this._createCol(j,k);this._appendCol(l,j,k)}};f.prototype._renderHeader=function(){var h=b.grid.rowType,j=this._wijgrid._columnsHeadersTable(),k,g,l;if(j&&(g=j.length)){for(k=0;k<g;k++){l=this._insertEmptyRow(h.header,k,-1,-1,-1);this._renderRow(l,null,j[k])}}};f.prototype._renderFilter=function(){var g=this._insertEmptyRow(b.grid.rowType.filter,-1,-1,-1,-1);this._renderRow(g,this._wijgrid._field("visibleLeaves"),null)};f.prototype._renderBody=function(){var k=b.grid.rowType,p=this._wijgrid._field("visibleLeaves"),q=this._wijgrid.sketchTable,j=-1,r=0,l=0,o,h,m,g,n=this._wijgrid._dataOffset;if(this._bounds.start>=0){for(o=this._bounds.start;o<=this._bounds.end;o++){m=q[o-n];g=(m.rowType&k.data)!==0;h=this._insertEmptyRow(m.rowType,l++,g?++j:-1,g?m.originalRowIndex:-1,g?r+m.originalRowIndex:-1);this._renderRow(h,p,m)}}};f.prototype._renderFooter=function(){var g=this._insertEmptyRow(b.grid.rowType.footer,-1,-1,-1,-1);this._renderRow(g,this._wijgrid._field("visibleLeaves"),null)};f.prototype._insertEmptyRow=function(m,g,h,j,l){var i=this._wijgrid._onViewInsertEmptyRow.apply(this._wijgrid,arguments),k=this._insertRow(m,g,i);return this._createRowInfo(k,m,b.grid.renderState.rendering,g,h,j,l)};f.prototype._createEmptyCell=function(j,g,i){var h=b.grid.rowType,k=this._wijgrid._onViewCreateEmptyCell.apply(this._wijgrid,arguments);return this._createCell(j.type,k)};f.prototype._insertRow=function(i,g,h){throw"not implemented"};f.prototype._createCell=function(i,j){var h=b.grid.rowType,g;if(!j){if(i===h.header){j=document.createElement("th")}else{j=document.createElement("td")}}if(i!==h.filter){g=document.createElement("div");g.className="wijmo-wijgrid-innercell";if(j.firstChild){while(j.firstChild){g.appendChild(j.firstChild)}}j.appendChild(g)}return e(j)};f.prototype._appendCell=function(i,g,h){throw"not implemented"};f.prototype._createCol=function(h,g){throw"not implemented"};f.prototype._appendCol=function(i,h,g){throw"not implemented"};f.prototype._renderRow=function(l,i,k){var h=b.grid.rowType,g,j;switch(l.type){case h.filter:this._renderFilterRow(l,i);break;case h.footer:this._renderFooterRow(l,i);break;case h.header:this._renderHeaderRow(l,k);break;case h.data:case h.data|h.dataAlt:this._renderDataRow(l,i,k);g=k.__attr;j=k.__style;break;case h.emptyDataRow:case h.groupHeader:case h.groupFooter:this._renderSpannedRow(l,i,k);g=k.__attr;j=k.__style;break;default:throw"unknown rowType"}this._rowRendered(l,g,j)};f.prototype._renderCell=function(g,l,n,k,i,j,h){var m=this._createEmptyCell(g,i.dataIndex,i);var o=(g.type===b.grid.rowType.filter)?m:e(m[0].firstChild);this._appendCell(g,l,m);if(k){o.html(n)}else{this._wijgrid.cellFormatter.format(o,i,n,g)}this._cellRendered(g,m,l,i,j,h)};f.prototype._renderDataRow=function(g,q,j){var k,l,m,p,r,o,h,n=false;for(k=0,l=q.length;k<l;k++){m=q[k];p=m.dataIndex;r=null;if(p>=0&&(!j[p]||(j[p].visible===false))){continue}r=(p>=0)?this._wijgrid._toStr(m,j[p].value):null;o=(p>=0)?j[p].__attr:null;h=(p>=0)?j[p].__style:null;this._renderCell(g,k,r,n,m,o,h)}};f.prototype._renderFilterRow=function(l,h){var k,g,j;for(k=0,g=h.length;k<g;k++){j=h[k];this._renderCell(l,k,b.grid.filterHelper.getSingleValue(j.filterValue),false,j)}};f.prototype._renderFooterRow=function(k,h){var j,g;for(j=0,g=h.length;j<g;j++){this._renderCell(k,j,"",false,h[j])}};f.prototype._renderHeaderRow=function(m,k){var j,g,l=0,h;for(j=0,g=k.length;j<g;j++){h=k[j];if(h.column&&h.column.parentVis){h.column.thX=l++;h.column.thY=m.sectionRowIndex;this._renderCell(m,j,h.column.headerText,false,h.column,{colSpan:h.colSpan,rowSpan:h.rowSpan})}}};f.prototype._renderSpannedRow=function(l,h,m){var k,j,g=Math.min(h.length,m.length);for(k=0;k<g;k++){this._renderCell(l,k,m[k].html,true,h[k],m[k].__attr,m[k].__style)}};f.prototype._cellRendered=function(l,k,i,h,g,j){this._wijgrid.cellStyleFormatter.format(k,i,h,l,b.grid.renderState.rendering,g,j);this._changeCellRenderState(k,b.grid.renderState.rendering,false);this._wijgrid._onViewCellRendered(l,k,i,h)};f.prototype._rowRendered=function(i,g,h){this._wijgrid.rowStyleFormatter.format(i,g,h);i.state&=~b.grid.renderState.rendering;this._setRowInfo(i.$rows,i);this._wijgrid._onViewRowRendered(i)};f.prototype._isBodyRow=function(i){var g=b.grid.rowType,h=i.type;return((h&g.data)||(h===g.groupHeader)||(h===g.groupFooter)||(h===g.emptyDataRow))};f.prototype._changeRowRenderState=function(h,g,i){if(i){h.state|=g}else{h.state&=~g}this._setRowInfo(h.$rows,h)};f.prototype._changeCellRenderState=function(l,h,k){var j=b.grid.dataPrefix,g=this._wijgrid._data$prefix,i=j(l,g,"renderState");if(k){h=i|h;j(l,g,"renderState",h)}else{h=i&~h;j(l,g,"renderState",h)}return h};f.prototype._adjustWidthArray=function(i,q,o,k,s){var r=this._sumWidthArray(i),j=this._sumWidthArray(q),p=[],m,n=0,h,g,l=true;if(r<=o){e.extend(true,p,i);if(r===o||k){return p}else{m=o-r}}else{e.extend(true,p,q);if(j>=o){return p}else{m=o-j}}e.each(p,function(t,u){if(!u.real){n++}});if(n!==0){if(s!==undefined&&(s>-1&&s<p.length)&&!p[s].real){p[s].width+=m;return p}h=Math.floor(m/n);g=m-h*n;e.each(p,function(t,u){if(!u.real){u.width+=h;if(l){u.width+=g;l=false}}})}return p};f.prototype._getColumnWidth=function(n,p){var o,k,g,q,s,l,t,v,r,u,h,m;if(p){o=this._wijgrid._field("visibleLeaves")[n];if(o._realWidth!==undefined){k={width:o._realWidth,real:true}}else{if(o.isRowHeader){k={width:this._rowHeaderSize,real:true}}else{g=0;q=this.getJoinedTables(true,n);s=q[2];for(l=0;l<2;l++){t=q[l];if(t!==null){v=t.element().rows;if(m=v.length){for(h=m-1,u=null;h>=0;h--){if(v[h].cells.length===t.width()){u=v[h];break}}if(u){r=u.cells[s];g=Math.max(g,e(r).outerWidth())}}}}k={width:g,real:false}}}p.push(k)}};f.prototype._setColumnWidth=function(g,h){var i=this.getHeaderCell(g),j=this.getJoinedCols(g);if(h){e(i).setOutWidth(h);e.each(j,function(k,l){e(l).setOutWidth(h)})}};f.prototype._setTableWidth=function(i,g,l,h){var k,j;e.each(i,function(m,n){n.css("table-layout","fixed").setOutWidth(g)});k=i[0].outerWidth();j=k-g;if(j!==0){this._setColumnWidth(h,l-j)}};f.prototype._sumWidthArray=function(j,i,h){var g=0;e.each(j,function(k,l){if(i!==undefined&&h!==undefined&&(k<i||k>h)){return true}g+=l.width});return g};f.prototype._clearBody=function(){e.each(this.subTables(),function(g,h){h.clearSection(2)})};f.prototype._rebuildOffsets=function(){e.each(this.subTables(),function(g,h){h.rebuildOffsets()})};f.prototype._removeBodyRow=function(l,k){var j=b.grid.rowType,r=this._wijgrid._rows(),m,n,h,p,q,g,o;if((l>=0)&&(l<(n=r.length()))){if(k){for(m=0;m<n;m++){h=this._getRowInfo(r.item(m));q=h.sectionRowIndex-l;if(h.sectionRowIndex>l){h.sectionRowIndex--;if(h.type&j.data){if(h.type&j.dataAlt){h.type&=~j.dataAlt}else{h.type|=j.dataAlt}h.dataItemIndex--;h.dataRowIndex--;h.virtualDataItemIndex--}this._setRowInfo(h.$rows,h)}}}h=this._getRowInfo(r.item(l));g=this.getAbsoluteRowIndex(h.$rows[0]);h.$rows.remove();o=this.getJoinedTables(false,g);if(o[0]){o[0].removeOffset(o[2])}if(o[1]){o[1].removeOffset(o[2])}}};f.prototype._insertBodyRow=function(l,m,h,r){var q=this._wijgrid._field("visibleLeaves"),k=b.grid.rowType,p=this._wijgrid._view(),s=this._wijgrid._rows(),n=s.length(),j=((l.rowType&k.data)!==0),i,g,o;if(m<0||m>=n||(!m&&m!==0)){m=n}i=this._insertEmptyRow(l.rowType,m,-1,h,r);this._renderRow(i,q,l);g=this.getAbsoluteRowIndex(i.$rows[0]);o=this.getJoinedTables(false,g);if(o[0]){o[0].insertOffset(g)}if(o[1]){o[1].insertOffset(g)}return i};f.prototype._findRowInfo=function(l){var h=this.bodyRows(),j=0,g=h.length(),k;if(e.isFunction(l)){for(j=0;j<g;j++){k=this._getRowInfo(h.item(j));if(l(k)===true){return k}}}return null};f.prototype._setRowInfo=function(l,k){var h="$rows" in k,g="data" in k,j,i;if(h){j=k.$rows;delete k.$rows}if(g){i=k.data;delete k.data}b.grid.dataPrefix(l,this._wijgrid._data$prefix,"rowInfo",k);if(h){k.$rows=j}if(g){k.data=i}};f.prototype._getRowInfo=function(h){var j=this._wijgrid,g=h[1]?e(h):e(h[0]),k=b.grid.dataPrefix(g,j._data$prefix,"rowInfo"),i;k.$rows=g;if((k.dataItemIndex>=0)&&(k.type&b.grid.rowType.data)){k.data=j._getDataItem(k.dataItemIndex)}return k};f.prototype._createRowInfo=function(o,m,i,k,j,g,n){var l,h={type:m,state:i,sectionRowIndex:k,dataRowIndex:j,dataItemIndex:g,virtualDataItemIndex:n,$rows:e(o)};if((g>=0)&&(m&b.grid.rowType.data)){h.data=this._wijgrid._getDataItem(g)}return h};return f})();d.baseView=c})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var wijmo;(function(b){(function(c){var e=jQuery;var d=(function(f){__extends(g,f);function g(h,i){f.call(this,h,i);this._dataTable=null;this._contentArea=null}g.prototype.dispose=function(){this._wijgrid.outerDiv.unbind("scroll",this._onScroll);f.prototype.dispose.call(this)};g.prototype.ensureWidth=function(k,l,j){var i=e(this._dataTable.element()),h=i.width()+l-j;f.prototype.ensureWidth.call(this,k,l,j);this._setTableWidth([i],h,l,k)};g.prototype.getVisibleAreaBounds=function(){var h=b.grid.bounds(this._dataTable.element()),i;if(this._wijgrid.options.scrollMode==="none"){return h}else{i=b.grid.bounds(this._wijgrid.outerDiv.find(".wijmo-wijgrid-split-area-se:first")[0]);return{top:h.top,left:h.left,width:Math.min(i.width,h.width),height:Math.min(i.height,h.height)}}};g.prototype.updateSplits=function(j){var t=this,n=this._wijgrid,i=n.options,l=n.element,h=[],q=[],k=[],p=n._field("visibleLeaves"),r=n.outerDiv,s,m;l.css({"table-layout":"",width:""});e.each(p,function(v,u){var x,o=u.width;if(o||(o===0)){x=((typeof(o)==="string")&&(o.length>1)&&(o[o.length-1]==="%"));if(x){o=r.width()*parseFloat(o)/100}else{o=parseFloat(o)}if(u.ensurePxWidth||(u.ensurePxWidth===undefined&&i.ensureColumnsPxWidth)){u._realWidth=o}t._setColumnWidth(v,o)}});e.each(p,function(u,o){t._getColumnWidth(u,h)});l.css("width","1px");e.each(p,function(u,o){t._getColumnWidth(u,q)});s=r.width();k=this._adjustWidthArray(h,q,s,i.ensureColumnsPxWidth,i.autoExpandColumnIndex);e.each(k,function(u,v){var o=p[u];if(o._realWidth!==undefined){delete o._realWidth;return}t._setColumnWidth(u,v.width)});m=k.length-1;if(m!==-1){this._setTableWidth([l],this._sumWidthArray(k,0,m),k[m].width,m)}};g.prototype.focusableElement=function(){return e(this._dataTable.element())};g.prototype.forEachColumnCell=function(h,j,i){return this._dataTable.forEachColumnCell(h,j,i)};g.prototype.forEachRowCell=function(j,i,h){return this._dataTable.forEachRowCell(j,i,h)};g.prototype.getAbsoluteCellInfo=function(h){return new b.grid.cellInfo(this.getColumnIndex(h),(h.parentNode).rowIndex,this._wijgrid,true)};g.prototype.getAbsoluteRowIndex=function(h){return h.rowIndex};g.prototype.getCell=function(k,j){var i=this._dataTable.getCellIdx(k,j),h;if(i>=0){h=this.getJoinedRows(j,0);if(h[0]){return h[0].cells[i]}}return null};g.prototype.getColumnIndex=function(h){return this._dataTable.getColumnIdx(h)};g.prototype.getHeaderCell=function(j){var h=this._wijgrid._field("visibleLeaves")[j],i;if(h&&(i=this._wijgrid._headerRows())){return b.grid.rowAccessor.getCell(i.item(h.thY),h.thX)}return null};g.prototype.getJoinedCols=function(h){var i=e(this._dataTable.element()).find("> colgroup");if(i.length){if(h<i[0].childNodes.length){return[i[0].childNodes[h],null]}}return[null,null]};g.prototype.getJoinedRows=function(i,h){return[this._dataTable.getSectionRow(i,h),null]};g.prototype.getJoinedTables=function(h,i){return[this._dataTable,null,i]};g.prototype.subTables=function(){return[this._dataTable]};g.prototype._preRender=function(){this._dataTable=new b.grid.htmlTableAccessor(this._wijgrid.element[0],true,true,true)};g.prototype._postRender=function(){this._wijgrid.element.find("> tbody").addClass(this._wijgrid.options.wijCSS.content+" wijmo-wijgrid-data");this._dataTable=new b.grid.htmlTableAccessor(this._wijgrid.element[0]);this._wijgrid._setAttr(this._wijgrid.element,{role:"grid",cellpadding:"0",border:"0",cellspacing:"0"});this._wijgrid.element.css("border-collapse","separate");this._wijgrid.outerDiv.bind("scroll",{wijgrid:this._wijgrid},e.proxy(this._onScroll,this));f.prototype._postRender.call(this)};g.prototype._insertRow=function(l,i,j){var h=b.grid.rowType,k;switch(l){case h.header:case h.filter:k=this._dataTable.ensureTHead();break;case h.footer:k=this._dataTable.ensureTFoot();break;default:k=this._dataTable.ensureTBody()}if(j){return[k.appendChild(j)]}else{if(i>k.rows.length){i=-1}return[k.insertRow(i)]}};g.prototype._rowRendered=function(k,h,i){var j=k.$rows[0];if(!j.cells.length&&this._isBodyRow(k)){j.parentNode.removeChild(j)}else{f.prototype._rowRendered.call(this,k,h,i)}};g.prototype._appendCell=function(j,h,i){j.$rows[0].appendChild(i[0])};g.prototype._createCol=function(i,h){return[document.createElement("col")]};g.prototype._appendCol=function(j,i,h){this._dataTable.appendCol(j[0])};g.prototype._onScroll=function(h){if(h.data.wijgrid.$superPanelHeader){h.data.wijgrid.$superPanelHeader.css("left",h.target.scrollLeft)}if(h.data.wijgrid.$bottomPagerDiv){h.data.wijgrid.$bottomPagerDiv.css("left",h.target.scrollLeft)}};return g})(c.baseView);c.flatView=d})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(g){__extends(f,g);function f(h,i){g.call(this,h,i);this._verScrollBarSize=18;this._viewTables={};this._splitAreas={};this.element=h.element;this._allowVirtualScrolling=h._allowVirtualScrolling(),this._staticDataRowIndex=h._getStaticIndex(true);this._staticRowIndex=h._getRealStaticRowIndex();this._staticColumnIndex=h._getRealStaticColumnIndex();this._staticAllColumnIndex=(this._staticColumnIndex===-1)?-1:h._field("visibleLeaves")[this._staticColumnIndex].leavesIdx;this._mouseWheelHandler=e.proxy(this._onMouseWheel,this)}f.prototype.dispose=function(){g.prototype.dispose.call(this);this._wijgrid.outerDiv.unbind("mousewheel",this._mouseWheelHandler)};f.prototype.ensureWidth=function(s,x,i){var q=this._wijgrid,k=q.options,l=this._staticColumnIndex,v=s<=l,r=e(this._viewTables.nw.element()),m=e(this._viewTables.ne.element()),w=e(this._viewTables.sw.element()),t=e(this._viewTables.se.element()),h=v?[r,w]:[m,t],p=(v?r.width():m.width())+x-i,n=q._field("frozener"),j=this.getScrollValue();this._destroySuperPanel();g.prototype.ensureWidth.call(this,s,x,i);this._setTableWidth(h,p,x,s);try{if(l>=0){k.splitDistanceX=r[0].offsetWidth}else{k.splitDistanceX=0}}catch(u){}this._updateSplitAreaBounds(0);this._adjustRowsHeights();try{if(this._staticRowIndex>=0){k.splitDistanceY=Math.max(r[0].offsetHeight,m[0].offsetHeight)}else{k.splitDistanceY=0}}catch(u){}this._updateSplitAreaBounds(1);this.refreshPanel(j);n.refresh()};f.prototype.ensureHeight=function(r){var l,m=this._wijgrid,i=m.options,n=e(this._viewTables.nw.element()),j=e(this._viewTables.ne.element()),s=e(this._viewTables.sw.element()),p=e(this._viewTables.se.element()),k=m._field("frozener"),h=this.getScrollValue(),t;this._destroySuperPanel();if(arguments.length>0){l=this.getJoinedRows(r,2);this._setRowHeight(l,this._getRowHeight(l))}p.css("height","");s.css("height","");t=Math.max(p.height(),s.height());p.height(t);s.height(t);try{if(this._staticRowIndex>=0){i.splitDistanceY=Math.max(n[0].offsetHeight,j[0].offsetHeight)}else{i.splitDistanceY=0}}catch(q){}this._updateSplitAreaBounds(1);this.refreshPanel(h);k.refresh()};f.prototype.getScrollValue=function(){var h=this._getSuperPanel();return h?{x:h.options.hScroller.scrollValue,y:h.options.vScroller.scrollValue}:null};f.prototype.getVisibleAreaBounds=function(){var h=b.grid.bounds(this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-contentwrapper:first"));if(!h){h=b.grid.bounds(this._wijgrid.outerDiv)}return h};f.prototype.getFixedAreaVisibleBounds=function(){var k=this.getVisibleAreaBounds(),j=b.grid.bounds(this._splitAreas.ne),h=b.grid.bounds(this._splitAreas.nw),i=null,l=null;if(j.height||h.height){i={left:k.left,top:k.top,width:k.width,height:Math.min(j.height||h.height,k.height)}}if(h.width){l={left:k.left,top:k.top,width:Math.min(h.width,k.width),height:k.height}}return[i,l]};f.prototype.refreshPanel=function(j){var o=this,l=this._wijgrid,p=l.options,m=this._getGridWidth(p.scrollMode),i=this._getMappedScrollMode(),k=this._testNeedVBar(l.outerDiv,l.element,e(this._viewTables.ne.element()),p.scrollMode,l._autoHeight),n=j?j.x:null,h=j?j.y:null;this._scroller.width(m);this._splitAreas.ne.width(m-p.splitDistanceX-(k?this._verScrollBarSize:0));if(!this._scroller.data("wijmo-wijsuperpanel")){if(this._allowVirtualScrolling){this.vsUI=new b.grid.uiVirtualScroller(l,this._splitAreas.se,p.splitDistanceY)}this._scroller.wijsuperpanel({disabled:l.options.disabled,scroll:e.proxy(this._onScroll,this),bubbleScrollingEvent:true,customScrolling:this._allowVirtualScrolling,vScroller:{scrollBarVisibility:i.vScrollBarVisibility,scrollValue:j?j.y:null},hScroller:{scrollBarVisibility:i.hScrollBarVisibility,scrollValue:j?j.x:null},hScrollerActivating:function(s,q){var r;if(l._autoHeight){r=l.element.height()+p.splitDistanceY-q.contentLength;if(r>0){o._scroller.height(o._scroller.height()+r);o._scroller.wijsuperpanel("paintPanel");return false}}o._splitAreas.sw.height(q.contentLength-p.splitDistanceY)}});this._scroller.find(".wijmo-wijsuperpanel-contentwrapper:first").scroll(function(q){if((q.target).scrollLeft){(q.target).scrollLeft=0}if((q.target).scrollTop){(q.target).scrollTop=0}q.preventDefault()});if(this._allowVirtualScrolling){this.vsUI.attach(this._scroller)}}else{this._scroller.wijsuperpanel("paintPanel")}this._scroller.find(".wijmo-wijsuperpanel-hbarcontainer, .wijmo-wijsuperpanel-vbarcontainer").css("zIndex",5)};f.prototype.scrollTo=function(w){if(!w.tableCell()){return}var i=this._wijgrid,z=i.options,t=this._getSuperPanel(),j=w.tableCell(),k=j.nodeType?e(j):j,m,B,p,r,C,v,u,A,h,D,x,n=null,s=null,l,y,E,q;if(t&&k.is(":visible")){m=(t).getContentElement();B=m.parent();p=parseInt((m.css("left")+"").replace("px",""),10)*-1;r=parseInt((m.css("top")+"").replace("px",""),10)*-1;C=B.outerWidth()-z.splitDistanceX;v=B.outerHeight()-z.splitDistanceY;u=k.position();A=u.left;h=u.top;D=k.outerWidth();x=k.outerHeight();l=i._getStaticIndex(true);y=i._getStaticIndex(false);E=w.rowIndex();q=w.cellIndex();if(E<=l){if(q<=y){n=0;s=0}else{A+=p;if(A+D>p+C){p=n=A+D-C}if(A<p){n=A}s=0}}else{if(q<=y){h+=r;if(h+x>r+v){r=s=h+x-v}if(h<r){s=h}n=0}else{A-=z.splitDistanceX;if(h+x>r+v){r=s=h+x-v}if(A+D>p+C){p=n=A+D-C}if(h<r){s=h}if(A<p){n=A}}}if(n!==null){(t).hScrollTo(n)}if(s!==null){if(this._allowVirtualScrolling){}else{(t).vScrollTo(s)}}}};f.prototype.updateSplits=function(t){var j=this._wijgrid,y=j.options,m,w=this,r=[],p=[],q=[],x=this._staticColumnIndex,v,u=y.scrollMode,k=j._field("visibleLeaves"),h=e(this._viewTables.se.element()),n=e(this._viewTables.ne.element()),z=e(this._viewTables.sw.element()),D=e(this._viewTables.nw.element()),l=j.outerDiv,C,A,s;this._destroySuperPanel();l.unbind("mousewheel",this._mouseWheelHandler);if((C=w._viewTables.se.element().tBodies)&&(C=C[0])){s=false;for(A=0;A<C.rows.length;A++){if(!e(C.rows[A]).hasClass("wijmo-wijgrid-groupheaderrow")){s=true;break}}if(!s){j.element.css("width","100%")}}e.each([h,n,z,D],function(i,o){o.css({"table-layout":"",width:""})});e.each(k,function(E,o){var F,i=o.width;if(i||(i===0)){F=((typeof(i)==="string")&&(i.length>1)&&(i[i.length-1]==="%"));if(F){i=l.width()*parseFloat(i)/100}else{i=parseFloat(i)}if(o.ensurePxWidth||(o.ensurePxWidth===undefined&&y.ensureColumnsPxWidth)){o._realWidth=i}w._setColumnWidth(E,i)}});e.each(k,function(o,i){w._getColumnWidth(o,q)});e.each([D,n,z,h],function(i,o){o.css({width:"1px"})});e.each(k,function(o,i){w._getColumnWidth(o,p)});m=l.width();r=this._adjustWidthArray(q,p,m,y.ensureColumnsPxWidth,y.autoExpandColumnIndex);e.each(r,function(o,E){var i=k[o];if(i._realWidth!==undefined){delete i._realWidth;return}w._setColumnWidth(o,E.width)});if(x>=0){v=x;this._setTableWidth([D,z],this._sumWidthArray(r,0,v),r[v].width,v)}try{if(x>=0){y.splitDistanceX=D[0].offsetWidth}else{y.splitDistanceX=0}}catch(B){}this._updateSplitAreaBounds(0);if(!y.ensureColumnsPxWidth){n.parent().width(m-y.splitDistanceX)}v=r.length-1;if(v!==-1){this._setTableWidth([n,h],this._sumWidthArray(r,x+1,v),r[v].width,v)}this._adjustRowsHeights();try{if(this._staticRowIndex>=0){y.splitDistanceY=Math.max(D[0].offsetHeight,n[0].offsetHeight)}else{y.splitDistanceY=0}}catch(B){}this._updateSplitAreaBounds(1);if(!y.ensureColumnsPxWidth){if(this._testNeedVBar(j.outerDiv,h,n,u,j._autoHeight)){m-=this._verScrollBarSize;r=this._adjustWidthArray(q,p,m,y.ensureColumnsPxWidth,y.autoExpandColumnIndex);e.each(r,function(i,o){if(!o.real){w._setColumnWidth(i,o.width)}});if(x>=0){v=x;this._setTableWidth([D,z],this._sumWidthArray(r,0,v),r[v].width,v)}try{if(x>=0){y.splitDistanceX=D[0].offsetWidth}else{y.splitDistanceX=0}}catch(B){}this._updateSplitAreaBounds(0);n.parent().width(m-y.splitDistanceX);v=r.length-1;if(v!==-1){this._setTableWidth([n,h],this._sumWidthArray(r,x+1,v),r[v].width,v)}this._adjustRowsHeights();try{if(this._staticRowIndex>=0){y.splitDistanceY=Math.max(D[0].offsetHeight,n[0].offsetHeight)}else{y.splitDistanceY=0}}catch(B){}this._updateSplitAreaBounds(1)}}this.refreshPanel(t);l.bind("mousewheel",e.proxy(this._mouseWheelHandler,this))};f.prototype._clearBody=function(){g.prototype._clearBody.call(this)};f.prototype.bodyRows=function(){var h=g.prototype.bodyRows.call(this);return h};f.prototype.focusableElement=function(){return this._wijgrid.outerDiv};f.prototype.forEachColumnCell=function(j,m,l){var k=this.getJoinedTables(true,j),i,h;if(k[0]!==null){i=k[2];h=k[0].forEachColumnCell(i,m,l);if(h!==true){return h}if(k[1]!==null){h=k[1].forEachColumnCell(i,m,l);if(h!==true){return h}}}return true};f.prototype.forEachRowCell=function(o,n,m){var l=this.getJoinedTables(false,o),k=l[0],j=l[1],h,i;if(k!==null){h=l[2];if(h<k.element().rows.length){i=k.forEachRowCell(h,n,m);if(i!==true){return i}}if((j!==null)&&(h<j.element().rows.length)){i=j.forEachRowCell(h,n,m);if(i!==true){return i}}}HTMLTableCellElement;return true};f.prototype.getAbsoluteCellInfo=function(h){return new b.grid.cellInfo(this.getColumnIndex(h),this.getAbsoluteRowIndex(h.parentNode),this._wijgrid,true)};f.prototype.getAbsoluteRowIndex=function(i){var h=i.rowIndex,j=i.parentNode;while(j.tagName.toLowerCase()!=="table"){j=j.parentNode}return(j===this._viewTables.nw.element()||j===this._viewTables.ne.element())?h:h+this._staticRowIndex+1};f.prototype.getCell=function(o,m){var h=this.getJoinedTables(false,m),l,k,n,j,i;if(h[0]!==null){l=this.getJoinedTables(true,o);if(l[0]!==null){k=h[2];n=l[2];j=null;if(h[1]!==null){j=(o===n)?h[0]:h[1]}else{j=h[0]}i=j.getCellIdx(n,k);if(i>=0){return j.element().rows[k].cells[i]}}}return null};f.prototype.getColumnIndex=function(l){var h=null,j=null,i=false,k;for(h=l.parentNode;h.tagName.toLowerCase()!=="table";h=h.parentNode){}if(h!==null){if(h===this._viewTables.nw.element()){j=this._viewTables.nw}else{if(h===this._viewTables.ne.element()){j=this._viewTables.ne;i=true}else{if(h===this._viewTables.sw.element()){j=this._viewTables.sw}else{if(h===this._viewTables.se.element()){j=this._viewTables.se;i=true}}}}if(j!==null){k=j.getColumnIdx(l);if(i){k+=this._staticColumnIndex+1}return k}}return -1};f.prototype.getHeaderCell=function(j){var h=this._wijgrid._field("visibleLeaves")[j],i;if(h&&(i=this._wijgrid._headerRows())){return b.grid.rowAccessor.getCell(i.item(h.thY),h.thX)}return null};f.prototype.getJoinedCols=function(j){var h=[],k=this.getJoinedTables(true,j),i=k[2];k.splice(k.length-1,1);e.each(k,function(l,m){h.push(m?e(m.element()).find("col")[i]:null)});return h};f.prototype.getJoinedRows=function(o,j){var u=null,t=null,s=null,q=null,p=this._staticRowIndex,h=this._staticColumnIndex,i=this._wijgrid._field("visibleLeaves").length-1,r=this._rowsCountRaw()-1,l=(p===r),n=(p<0),k=!l&&!n,m=0;if(l||k){if(h>=0&&h<i){s=this._viewTables.nw;q=this._viewTables.ne}else{s=(h<0)?this._viewTables.ne:this._viewTables.nw}m=s.getSectionLength(j);if(o<m){u=s.getSectionRow(o,j);if(q!==null){t=q.getSectionRow(o,j)}}}if(n||(k&&(u===null))){if(!n){o-=m}if(h>=0&&h<i){s=this._viewTables.sw;q=this._viewTables.se}else{s=(h<0)?this._viewTables.se:this._viewTables.sw}u=s.getSectionRow(o,j);if(q!==null){t=q.getSectionRow(o,j)}}return(u===null&&t===null)?null:[u,t]};f.prototype.getJoinedTables=function(i,k){var n=null,m=null,h=k,l=this._wijgrid,o=this._staticRowIndex,j=this._staticColumnIndex;if(i){if(k<=j){n=this._viewTables.nw;m=this._viewTables.sw}else{n=this._viewTables.ne;m=this._viewTables.se;h=h-(j+1)}if(o<0){n=null}if(o===this._rowsCountRaw()-1){m=null}}else{if(k<=o){n=this._viewTables.nw;m=this._viewTables.ne}else{n=this._viewTables.sw;m=this._viewTables.se;h=h-(o+1)}if(j<0){n=null}if(j===l._field("leaves").length-1){m=null}}if(n===null){n=m;m=null}return[n,m,h]};f.prototype.subTables=function(){return[this._viewTables.nw,this._viewTables.ne,this._viewTables.sw,this._viewTables.se]};f.prototype._getGridWidth=function(k){var j=this._wijgrid,i=j.element.outerWidth(true)+j.options.splitDistanceX,h=j.outerDiv.innerWidth();if(this._testNeedVBar(j.outerDiv,j.element,e(this._viewTables.ne.element()),k,j._autoHeight)){i+=this._verScrollBarSize}if(i>h){i=h}return i};f.prototype._getSuperPanel=function(){return this._scroller?this._scroller.data("wijmo-wijsuperpanel"):null};f.prototype._ensureRenderBounds=function(){if(this._wijgrid._allowVirtualScrolling()){this._wijgrid._ensureRenderBounds(this._bounds);if(this._wijgrid._serverSideVirtualScrolling()){}this._bounds.end=this._bounds.start+this._wijgrid.options.pageSize-1;this._wijgrid._ensureRenderBounds(this._bounds)}else{g.prototype._ensureRenderBounds.call(this)}};f.prototype._renderContent=function(){g.prototype._renderContent.call(this)};f.prototype._preRender=function(){var i=document.createDocumentFragment(),h=b.grid.htmlTableAccessor;this._wijgrid.outerDiv.wrapInner('<div class="wijmo-wijgrid-fixedview"><div class="wijmo-wijgrid-scroller"><div class="wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div></div>');this._scroller=this._wijgrid.outerDiv.find(".wijmo-wijgrid-scroller");this._scroller.css("padding",0);this._scroller.after(this._splitAreas.nw=e('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>'));this._scroller.after(this._splitAreas.ne=e('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>'));this._scroller.after(this._splitAreas.sw=e('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>'));this._splitAreas.se=this._scroller.find(".wijmo-wijgrid-split-area-se:first");this._viewTables={nw:new h(i.appendChild(document.createElement("table")),true,true,true),ne:new h(i.appendChild(document.createElement("table")),true,true,true),sw:new h(i.appendChild(document.createElement("table")),true,true,true),se:new h(i.appendChild(this._wijgrid.element[0]),true,true,true)}};f.prototype._postRender=function(){var j,h,m,l,i=b.grid.htmlTableAccessor,k=this;this._viewTables={nw:new i(j=this._viewTables.nw.element()),ne:new i(h=this._viewTables.ne.element()),sw:new i(m=this._viewTables.sw.element()),se:new i(l=this._viewTables.se.element())};this._splitAreas.nw.empty().append(j);this._splitAreas.ne.empty().append(h);this._splitAreas.sw.empty().append(m);this._splitAreas.se.empty().append(l);e.each(this._viewTables,function(n,p){var o=e(p.element());k._wijgrid._setAttr(o,{role:"grid",border:"0",cellpadding:"0",cellspacing:"0"});o.addClass("wijmo-wijgrid-table").css("border-collapse","separate").find("> tbody").addClass(k._wijgrid.options.wijCSS.content+" wijmo-wijgrid-data")});g.prototype._postRender.call(this)};f.prototype._rowsCountRaw=function(){var i=this._viewTables.nw.element(),h=this._viewTables.ne.element(),k=this._viewTables.sw.element(),j=this._viewTables.se.element(),l;l=Math.max(i.rows.length,h.rows.length)+Math.max(k.rows.length,j.rows.length);return l};f.prototype._createCol=function(i,h){return[document.createElement("col"),document.createElement("col")]};f.prototype._appendCol=function(j,i,h){if(h<=this._staticColumnIndex){this._viewTables.nw.appendCol(j[0]);this._viewTables.sw.appendCol(j[1])}else{this._viewTables.ne.appendCol(j[0]);this._viewTables.se.appendCol(j[1])}};f.prototype._insertRow=function(m,i,k){var h=b.grid.rowType,l,j,n=this._viewTables;switch(m){case h.header:case h.filter:l=n.nw.ensureTHead();j=n.ne.ensureTHead();break;case h.footer:l=n.sw.ensureTFoot();j=n.se.ensureTFoot();break;default:if(i<=this._staticDataRowIndex){l=n.nw.ensureTBody();j=n.ne.ensureTBody()}else{i-=this._staticDataRowIndex+1;l=n.sw.ensureTBody();j=n.se.ensureTBody()}}if(k){return[l.appendChild(k),j.appendChild(k.cloneNode(false))]}else{return[l.insertRow(i>l.rows.length?-1:i),j.insertRow(i>j.rows.length?-1:i)]}};f.prototype._rowRendered=function(l,h,i){var j=l.$rows[0],k=l.$rows[1];if(!j.cells.length&&this._isBodyRow(l)){j.parentNode.removeChild(j);j=null}if(!k.cells.length&&this._isBodyRow(l)){k.parentNode.removeChild(k);k=null}if(j||k){if(!j||!k){l.$rows=j?e(j):e(k)}g.prototype._rowRendered.call(this,l,h,i)}};f.prototype._appendCell=function(k,h,j){var i=(k.type!==b.grid.rowType.header)?this._staticColumnIndex:this._staticAllColumnIndex;if(h<=i){k.$rows[0].appendChild(j[0])}else{k.$rows[1].appendChild(j[0])}};f.prototype._getRowHeight=function(n,h){if(n[0]&&n[1]){var q=n[0],k=n[1],m=e(q),i=e(k),p,j,o,l=function(r){var t,s=r[0],u;for(t=0;t<s.cells.length;t++){u=s.cells[t];if(!u.rowSpan||u.rowSpan===1){return e(u).outerHeight()}}return r.height()};if(o=e.data(q,"customHeight")){p=j=parseInt(o)}else{m.css("height","");i.css("height","");if(h){p=l(m);j=l(i)}else{p=m.height();j=i.height()}}return Math.max(p,j)}return null};f.prototype._setRowHeight=function(h,k){if(h[0]&&h[1]){var j=[e(h[0]),e(h[1])],i;if(k===null){return}k+=1;e.each(j,function(l,m){m.height(k);i=k-m.height();if(i){m.height(k+i)}})}};f.prototype._adjustRowHeight=function(){var k=this._wijgrid,B=this._staticColumnIndex,A=k._field("visibleLeaves").length-1,p,o,q,C,n,t,x,u,m,l,w,s,z,y,v,h,r=[];if(B>-1&&B<A){p=this._staticRowIndex;o=this._rowsCountRaw()-1;q=this._viewTables;if(p>-1&&p<=o){C=q.ne.element();n=C.parentNode;t=q.nw.element();x=t.parentNode;v=t.rows;h=C.rows;s=v.length;for(z=0;z<s;z++){r.push(this._getRowHeight([v[z],h[z]],true))}}if(p>=-1&&p<o){u=q.se.element();m=u.parentNode;l=q.sw.element();w=l.parentNode;v=l.rows;h=u.rows;s=v.length;for(z=0;z<s;z++){r.push(this._getRowHeight([v[z],h[z]]))}}if(p>-1&&p<=o){x.removeChild(t);n.removeChild(C)}if(p>=-1&&p<o){w.removeChild(l);m.removeChild(u)}if(p>-1&&p<=o){v=t.rows;h=C.rows;s=v.length;for(z=0,y=0;z<s;z++){this._setRowHeight([v[z],h[z]],r[y++])}}if(p>=-1&&p<o){v=l.rows;h=u.rows;s=v.length;for(z=0;z<s;z++){this._setRowHeight([v[z],h[z]],r[y++])}}if(p>-1&&p<=o){x.appendChild(t);n.appendChild(C)}if(p>=-1&&p<o){w.appendChild(l);m.appendChild(u)}}};f.prototype._adjustRowsHeights=function(){var i=e(this._viewTables.sw.element()),j=e(this._viewTables.se.element()),h;j.css("height","");i.css("height","");this._adjustRowHeight();h=Math.max(j.height(),i.height());i.height(h);j.height(h)};f.prototype._destroySuperPanel=function(){if(this._scroller.data("wijmo-wijsuperpanel")){if(this.vsUI){this.vsUI.dispose()}this._scroller.wijsuperpanel("destroy")}};f.prototype._onScroll=function(h,j){var i=this._getSuperPanel();if(this._allowVirtualScrolling){if(j.dir==="h"){this._setFixedAreaPosition((i).getContentElement(),j.dir,j.position,j.animationOptions,false);this._setFixedAreaPosition(this._splitAreas.ne,j.dir,j.position,j.animationOptions,true)}}else{this._setFixedAreaPosition(j.dir==="h"?this._splitAreas.ne:this._splitAreas.sw,j.dir,j.position,j.animationOptions,true)}this._wijgrid._trackScrollingPosition(i.options.hScroller.scrollValue,i.options.vScroller.scrollValue)};f.prototype._onMouseWheel=function(l,m){var k,i=(m>0)?"top":"bottom",h=false,j;if(this._wijgrid._canInteract()){k=this.getFixedAreaVisibleBounds();e.each(k,function(n,p){if(p&&b.grid.isOver(l.pageY,l.pageX,p.top,p.left,p.height,p.width)){h=true;return false}});if(h&&this._scroller.data("wijmo-wijsuperpanel")){j=this._scroller.wijsuperpanel("option","vScroller").scrollValue;this._scroller.wijsuperpanel("doScrolling",i);if(j!==this._scroller.wijsuperpanel("option","vScroller").scrollValue){l.stopPropagation();l.preventDefault()}}}};f.prototype._setFixedAreaPosition=function(j,m,h,k,l){var n={},i;if(m==="h"){i=l?"scrollLeft":"left"}else{i=l?"scrollTop":"top"}if(!l){h=-h}if(k){n[i]=h;j.animate(n,k)}else{if(l){j[0][i]=h}else{j.css(i,h)}}};f.prototype._testNeedVBar=function(q,i,r,j,s){var o,k=this._wijgrid,l=r.width()+k.options.splitDistanceX,h=i.height()+k.options.splitDistanceY,u=q.width(),p=q.height(),n,t=0,m=0;if(this._allowVirtualScrolling&&k._totalRowsCount()>1){return true}if(k.$superPanelHeader!==null){t=k.$superPanelHeader.outerHeight(true)}if(k.$bottomPagerDiv!==null){m=k.$bottomPagerDiv.outerHeight(true)}n=p-t-m;if(j==="both"||j==="vertical"){o=true}else{o=(j==="auto")&&((h>n)||(!s&&l>u&&h>n-this._verScrollBarSize))}return o};f.prototype._updateSplitAreaBounds=function(n){var h=this._wijgrid,m=h.options,l,j,i=0,k=0;if(n===0||n===2){this._splitAreas.nw.width(m.splitDistanceX);this._splitAreas.sw.width(m.splitDistanceX);this._splitAreas.se.css("marginLeft",m.splitDistanceX);this._splitAreas.ne.css("marginLeft",m.splitDistanceX)}if(n===1||n===2){this._scroller.css("height","");this._splitAreas.se.css("marginTop",0);l=h.outerDiv.height();if(!h._autoHeight){this._scroller.height(l)}else{this._scroller.height(l+m.splitDistanceY)}this._splitAreas.nw.height(m.splitDistanceY);this._splitAreas.ne.height(m.splitDistanceY);if(h.$superPanelHeader!==null){i=h.$superPanelHeader.outerHeight(true)}if(h.$bottomPagerDiv!==null){k=h.$bottomPagerDiv.outerHeight(true)}j=l-i-k;if(h.$superPanelHeader!==null){this._splitAreas.nw.css("top",i+"px");this._splitAreas.ne.css("top",i+"px")}if(!h._autoHeight){this._splitAreas.sw.height(j-m.splitDistanceY)}else{this._splitAreas.sw.height(j)}this._splitAreas.sw.css("top",m.splitDistanceY+i);this._splitAreas.se.css("marginTop",m.splitDistanceY)}};return f})(d.baseView);d.fixedView=c})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var f=jQuery;var d=(function(){function g(h){this._updates=0;this._selectedColumns=null;this._selectedRows=null;this._extend_rules={singlecell:[0,0,0],singlecolumn:[1,1,1],singlerow:[2,2,2],singlerange:[0,1,2],multicolumn:[1,1,1],multirow:[2,2,2],multirange:[0,1,2]};if(!h){throw"invalid arguments"}this._wijgrid=h;this._addedCells=new e(h);this._removedCells=new e(h);this._selectedCells=new e(h);this._addedDuringCurTransactionCells=new e(h)}g.prototype.selectedCells=function(){return this._selectedCells};g.prototype.addColumns=function(i,h){if(!h&&h!==0){h=i}this.addRange(i,0,h,16777215)};g.prototype.addRange=function(i,l,j,k){if(!i&&(arguments.length===1)){throw"invalid argument"}var h=(arguments.length===4)?new b.grid.cellInfoRange(new b.grid.cellInfo(i,l),new b.grid.cellInfo(j,k)):i._clone();h._normalize();if(!h._isValid()){throw"invalid argument"}this.beginUpdate();this._startNewTransaction(this._wijgrid._field("currentCell"));this._selectRange(h,false,true,0,null);this.endUpdate()};g.prototype.addRows=function(i,h){if(!h&&h!==0){h=i}this.addRange(0,i,16777215,h)};g.prototype.removeRange=function(i,l,j,k){if(!i&&(arguments.length===1)){throw"invalid argument"}var h=(arguments.length===4)?new b.grid.cellInfoRange(new b.grid.cellInfo(i,l),new b.grid.cellInfo(j,k)):i._clone();h._normalize();if(!h._isValid()){throw"invalid argument"}this.beginUpdate();this._startNewTransaction(this._wijgrid._field("currentCell"));this._clearRange(h,0);this.endUpdate()};g.prototype.removeColumns=function(i,h){if(!h&&h!==0){h=i}this.removeRange(i,0,h,16777215)};g.prototype.removeRows=function(i,h){if(!h&&h!==0){h=i}this.removeRange(0,i,16777215,h)};g.prototype.clear=function(){this.beginUpdate();this._removedCells._clear();this._removedCells._addFrom(this._selectedCells);this.endUpdate()};g.prototype.selectAll=function(){this.beginUpdate();this._selectRange(this._wijgrid._getDataCellsRange(),false,false,0,null);this.endUpdate()};g.prototype.beginUpdate=function(){this._updates++};g.prototype.endUpdate=function(){if(this._updates>0){this._updates--;if(this._updates===0){this.doSelection();if(this._addedCells.length()||this._removedCells.length()){if(this._selectedColumns!==null){this._selectedColumns.UnderlyingDataChanged()}if(this._selectedRows!==null){this._selectedRows.UnderlyingDataChanged()}this._wijgrid._trigger("selectionChanged",null,{addedCells:this._addedCells,removedCells:this._removedCells})}this._addedCells=new b.grid.cellInfoOrderedCollection(this._wijgrid);this._removedCells._clear()}}};g.prototype._multipleRangesAllowed=function(){var h=this._wijgrid.options.selectionMode;return(h&&((h=h.toLowerCase())==="multicolumn"||h==="multirow"||h==="multirange"))};g.prototype._anchorCell=function(){return this.__anchorCell};g.prototype._startNewTransaction=function(h){if(h){this.__anchorCell=h._clone();this._addedDuringCurTransactionCells=new b.grid.cellInfoOrderedCollection(this._wijgrid)}};g.prototype._clearRange=function(o,m){var t=this._wijgrid.options.selectionMode.toLowerCase(),h,j,l,q,u,s,n,p,k,r=this._wijgrid._getDataCellsRange();if(o._isValid()&&(t!=="none")&&(this._selectedCells.length()>0)){h=o._clone();h._normalize();h._clip(r);if(!o._isValid()){return}h._extend(this._extend_rules[t][m],r);this.beginUpdate();for(n=0,p=this._selectedCells.length();n<p;n++){k=this._selectedCells.item(n);if(h._containsCellInfo(k)){this._removedCells._add(k)}}this.endUpdate()}};g.prototype._selectRange=function(i,o,m,l,k){var n=this._wijgrid.options.selectionMode.toLowerCase(),h,j=this._wijgrid._getDataCellsRange();if((n!=="none")&&i._isValid()){h=i._clone();h._normalize();h._clip(j);if(!h._isValid()){return}this.beginUpdate();if(!this._multipleRangesAllowed()){this.clear()}else{if(o||m){if(m){this._removedCells._clear();this._removedCells._addFrom(this._addedDuringCurTransactionCells)}}else{this.clear()}}switch(n){case"singlecell":case"singlecolumn":case"singlerow":h=(k===null)?new b.grid.cellInfoRange(h.topLeft(),h.topLeft()):new b.grid.cellInfoRange(k,k);break}h._extend(this._extend_rules[n][l],j);this.doRange(h,true);this.endUpdate()}};g.prototype.doSelection=function(){var o=this._wijgrid._getDataToAbsOffset(),m=o.x,q=o.y,u=this._wijgrid._view(),p,s,n,v,t,r,l=b.grid.renderState,j,h,k=-1;for(p=0,s=this._removedCells.length();p<s;p++){n=this._removedCells.item(p);if(this._addedCells.indexOf(n)<0){v=u.getCell(n.cellIndex()+m,n.rowIndex()+q);if(v){if(k!==n.rowIndex()){j=n.row();k=n.rowIndex()}t=f(v);h=u._changeCellRenderState(t,l.selected,false);this._wijgrid.cellStyleFormatter.format(t,n.cellIndex(),n.column(),j,h)}this._selectedCells._remove(n);this._addedDuringCurTransactionCells._remove(n)}else{this._removedCells._removeAt(p);p--;s--}}k=-1;for(p=0,s=this._addedCells.length();p<s;p++){n=this._addedCells.item(p);r=this._selectedCells.indexOf(n);if(r<0){v=u.getCell(n.cellIndex()+m,n.rowIndex()+q);if(v){if(k!==n.rowIndex()){j=n.row();k=n.rowIndex()}t=f(v);h=u._changeCellRenderState(t,l.selected,true);this._wijgrid.cellStyleFormatter.format(t,n.cellIndex(),n.column(),j,h)}this._selectedCells._insertUnsafe(n,~r);this._addedDuringCurTransactionCells._add(n)}else{this._addedCells._removeAt(p);p--;s--}}};g.prototype.doRange=function(m,r){var j=m.topLeft().cellIndex(),p=m.topLeft().rowIndex(),i=m.bottomRight().cellIndex(),o=m.bottomRight().rowIndex(),l,t,k,q,n=this._wijgrid._view(),h,s;if(r){l=this._addedCells.length();s=this._wijgrid._rows();for(t=p;t<=o;t++){h=n._getRowInfo(s.item(t));if(h.type&b.grid.rowType.data){for(k=j;k<=i;k++){q=new b.grid.cellInfo(k,t);if(l===0){this._addedCells._appendUnsafe(q)}else{this._addedCells._add(q)}}}}}else{l=this._removedCells.length();for(t=p;t<=o;t++){for(k=j;k<=i;k++){q=new b.grid.cellInfo(k,t);if(l===0){this._removedCells._appendUnsafe(q)}else{this._removedCells._add(q)}}}}};return g})();c.selection=d;var e=(function(){function g(h){this._clear=function(){this._list.length=0};if(!h){throw"invalid arguments"}this._wijgrid=h;this._list=[]}g.prototype.item=function(h){return this._list[h]};g.prototype.length=function(){return this._list.length};g.prototype.indexOf=function(i,n){if(arguments.length===1){n=i.rowIndex();i=i.cellIndex()}var j=0,h=this._list.length-1,l,m,k;while(j<=h){l=j+((h-j)>>1);m=this._list[l];k=m.rowIndex()-n;if(k===0){k=m.cellIndex()-i}if(k<0){j=l+1}else{if(k>0){h=l-1}else{return l}}}return ~j};g.prototype.toString=function(){var k="",j,h;for(j=0,h=this._list.length;j<h;j++){k+=this._list[j].toString()+"\n"}return k};g.prototype._add=function(i){var h=this.indexOf(i);if(h<0){this._list.splice(~h,0,i);i._setGridView(this._wijgrid);return true}return false};g.prototype._addFrom=function(j){if(j){var l=j.length(),h=this._list.length,k;if(h===0){this._list.length=l;for(k=0;k<l;k++){this._list[k]=j.item(k);this._list[k]._setGridView(this._wijgrid)}}else{for(k=0;k<l;k++){this._add(j.item(k))}}}};g.prototype._appendUnsafe=function(h){this._list[this._list.length]=h;h._setGridView(this._wijgrid)};g.prototype._insertUnsafe=function(i,h){this._list.splice(h,0,i)};g.prototype._remove=function(i){var h=this.indexOf(i);if(h>=0){this._list.splice(h,1);return true}return false};g.prototype._removeAt=function(h){this._list.splice(h,1)};g.prototype._getColumnsIndicies=function(){var m=[],h=this._list.length,j,l,k;if(h){j=[];for(l=0;l<h;l++){j[this._list[l].cellIndex()]=1}h=j.length;k=0;for(l=0;l<h;l++){if(j[l]){m[k++]=l}}}return m};g.prototype._getSelectedRowsIndicies=function(){var m=[],h=this._list.length,l,k,j;if(h){l=[];for(k=0;k<h;k++){l[this._list[k].rowIndex()]=1}h=l.length;j=0;for(k=0;k<h;k++){if(l[k]){m[j++]=k}}}return m};g.prototype._rectangulate=function(){var h=this._list.length,m=4294967295,o=4294967295,k=0,n=0,l,j;if(h){for(l=0;l<h;l++){j=this._list[l];m=Math.min(m,j.cellIndex());o=Math.min(o,j.rowIndex());k=Math.max(k,j.cellIndex());n=Math.max(n,j.rowIndex())}return new b.grid.cellInfoRange(new b.grid.cellInfo(m,o),new b.grid.cellInfo(k,n))}return null};return g})();c.cellInfoOrderedCollection=e})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var e=jQuery;var d=(function(){function f(g){this._gap_to_start=10;this._inProgress=false;this._additionalEventsAttached=false;this._wijgrid=g;this._evntFormat="{0}."+this._wijgrid.widgetName+".selectionui";this._addedCells=new b.grid.cellInfoOrderedCollection(this._wijgrid);this._view=this._wijgrid._view();this._rootElement=this._view.focusableElement();this._visLeavesLen=this._wijgrid._field("visibleLeaves").length;this._rootElement.bind(this._eventKey("mousedown"),e.proxy(this._onGridMouseDown,this))}f.prototype.dispose=function(){this._rootElement.unbind(this._eventKey("mousedown"),this._onGridMouseDown);this._detachAdditionalEvents()};f.prototype._onGridMouseDown=function(j){if(!this._wijgrid._canInteract()||this._wijgrid.options.selectionMode.toLowerCase()==="none"){return}var k=this._view.getVisibleAreaBounds(),i={x:j.pageX,y:j.pageY},h=((j.target&&(j.target).tagName!==undefined)?(j.target).tagName.toLowerCase():undefined),g=e(j.target);if((!h||g.is("td.wijgridtd, th.wijgridtd, div.wijmo-wijgrid-innercell"))&&(i.x>k.left&&i.x<k.left+k.width)&&(i.y>k.top&&i.y<k.top+k.height)){this._attachAdditionalEvents();this._startPos=i;this._startCellInfo=this._coordToDataCellInfo(this._startPos)}};f.prototype._onDocumentMouseMove=function(h){if(!this._startCellInfo||!this._startCellInfo._isValid()){return}var u={x:h.pageX,y:h.pageY},A,z,w,s,m,q,v,p,g,x,y,o,n,j,k,t=this._wijgrid._view(),r=this._wijgrid._rows(),l=b.grid.renderState;if(!this._inProgress){this._inProgress=(Math.abs(this._startPos.x-u.x)>this._gap_to_start)||(Math.abs(this._startPos.y-u.y)>this._gap_to_start)}if(this._inProgress){A=this._coordToDataCellInfo(u);if(!A._isValid()){return}this._endCellInfo=A;w=new b.grid.cellInfoRange(this._startCellInfo,this._endCellInfo);w._normalize();w._clip(this._wijgrid._getDataCellsRange());if(w._isValid()&&!w.isEqual(this._prevMouseMoveRange)){s=this._wijgrid._getDataToAbsOffset();this._prevMouseMoveRange=w;m=new b.grid.cellInfoOrderedCollection(this._wijgrid);q=w.bottomRight().rowIndex();v=w.bottomRight().cellIndex();for(p=w.topLeft().rowIndex();p<=q;p++){n=t._getRowInfo(r.item(p));if(n.type&b.grid.rowType.data){for(g=w.topLeft().cellIndex();g<=v;g++){m._appendUnsafe(new b.grid.cellInfo(g,p))}}}j=-1;for(x=0,y=this._addedCells.length();x<y;x++){z=this._addedCells.item(x);if(m.indexOf(z)<0){if(this._wijgrid.selection().selectedCells().indexOf(z)<0){g=this._view.getCell(z.cellIndex()+s.x,z.rowIndex()+s.y);if(g){if(j!==z.rowIndex()){n=z.row();j=z.rowIndex()}o=e(g);k=t._changeCellRenderState(o,l.selected,false);this._wijgrid.cellStyleFormatter.format(o,z.cellIndex(),z.column(),n,k)}}this._addedCells._removeAt(x);x--;y--}}j=-1;for(x=0,y=m.length();x<y;x++){z=m.item(x);if(this._addedCells.indexOf(z)<0&&this._wijgrid.selection().selectedCells().indexOf(z)<0){if(this._addedCells._add(z)){g=this._view.getCell(z.cellIndex()+s.x,z.rowIndex()+s.y);if(g){if(j!==z.rowIndex()){n=z.row();j=z.rowIndex()}o=e(g);k=t._changeCellRenderState(o,l.selected,true);this._wijgrid.cellStyleFormatter.format(o,z.cellIndex(),z.column(),n,k)}}}}}}};f.prototype._onDocumentMouseUp=function(p){this._detachAdditionalEvents();if(this._inProgress){this._inProgress=false;if(this._prevMouseMoveRange&&this._prevMouseMoveRange._isValid()){this._wijgrid._changeCurrentCell(p,this._endCellInfo);if(!p.shiftKey||(!this._wijgrid.selection()._multipleRangesAllowed()&&this._wijgrid.options.selectionMode.toLowerCase()!=="singleRange")){this._wijgrid.selection()._startNewTransaction(this._startCellInfo)}this._wijgrid.selection().beginUpdate();this._wijgrid.selection()._selectRange(this._prevMouseMoveRange,p.shiftKey,p.ctrlKey,0,this._endCellInfo);this._wijgrid.selection().endUpdate();var r=this._wijgrid._view(),m=this._wijgrid._getDataToAbsOffset(),n,o,l,s,q,j=-1,h,g,k=b.grid.renderState;for(n=0,o=this._addedCells.length();n<o;n++){l=this._addedCells.item(n);if(this._wijgrid.selection().selectedCells().indexOf(l)<0){s=r.getCell(l.cellIndex()+m.x,l.rowIndex()+m.y);if(s!==null){if(j!==l.rowIndex()){h=l.row();j=l.rowIndex()}q=e(s);g=r._changeCellRenderState(q,k.selected,false);this._wijgrid.cellStyleFormatter.format(q,l.cellIndex(),l.column(),h,g)}}}this._addedCells._clear();this._startCellInfo=this._endCellInfo=this._prevMouseMoveRange=null;return false}}};f.prototype._attachAdditionalEvents=function(){if(!this._additionalEventsAttached){try{this._view.toggleDOMSelection(false);e(document).bind(this._eventKey("mousemove"),e.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),e.proxy(this._onDocumentMouseUp,this))}finally{this._additionalEventsAttached=true}}};f.prototype._detachAdditionalEvents=function(){if(this._additionalEventsAttached){try{this._view.toggleDOMSelection(true);e(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp)}finally{this._additionalEventsAttached=false}}};f.prototype._eventKey=function(g){return b.grid.stringFormat(this._evntFormat,g)};f.prototype._coordToDataCellInfo=function(g){var k=0,o=this._visLeavesLen-1,n=0,h=-1,i,p=new b.grid.rowAccessor(this._view,2,0,0),j,m,l,q;while(k<=o){n=((o-k)>>1)+k;i=b.grid.bounds(this._view.getHeaderCell(n));if(!i){m=p.item(0);i=b.grid.bounds(b.grid.rowAccessor.getCell(m,n))}if(!i){break}if(g.x<i.left){o=n-1}else{if(g.x>i.left+i.width){k=n+1}else{h=n;break}}}if(h===-1){return b.grid.cellInfo.outsideValue}p=new b.grid.rowAccessor(this._view,0,0,0);j=-1;k=0;o=p.length()-1;n=0;while(k<=o){n=((o-k)>>1)+k;m=p.item(n);i=b.grid.bounds(b.grid.rowAccessor.getCell(m,0));if(g.y<i.top){o=n-1}else{if(g.y>i.top+i.height){k=n+1}else{j=n;break}}}if(j===-1){return b.grid.cellInfo.outsideValue}l=this._wijgrid._getDataToAbsOffset();q=new b.grid.cellInfo(h-l.x,j-l.y);q._clip(this._wijgrid._getDataCellsRange());return q};return f})();c.uiSelection=d})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(){function h(j,m,l,k){this._view=j;this._scope=m;this._offsetBottom=k;this._offsetTop=l}h.prototype.item=function(k){var j=this.length();return(k<j)?this._view.getJoinedRows(k+this._offsetTop,this._scope):null};h.prototype.length=function(){var l=this._view.getJoinedTables(true,0),j=0,k;if(k=l[0]){j=k.getSectionLength(this._scope)}if(k=l[1]){j+=k.getSectionLength(this._scope)}j-=this._offsetTop+this._offsetBottom;if(j<0){j=0}return j};h.iterateCells=function f(q,s,k){if(q&&s){var n=0,m,o,p,l,r,t;for(m=0,o=q.length;m<o;m++){p=q[m];if(p){for(l=0,r=p.cells.length;l<r;l++){t=s(p.cells[l],n++,k);if(t!==true){return}}}}}};h.getCell=function g(j,m){var k,l;if(j&&(k=j[0])){l=k.cells.length;if(m<l){return k.cells[m]}m-=l;if(k=j[1]){l=k.cells.length;if(m<l){return k.cells[m]}}}return null};h.cellsCount=function i(j){var l=0,k;if(j&&(k=j[0])){l=k.cells.length;if(k=j[1]){l+=k.cells.length}}return l};return h})();d.rowAccessor=c})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var e=jQuery;var d=(function(){function f(){this._timeout=25}f.prototype.currentCellEditStart=function(g,j){var o=false,m=g.currentCell(),n=g._view(),h,k,l,i;if(m._isValid()&&!m._isEdit()&&(m.column().dataIndex>=0)){h=m.row();if(h){i=h.type;if(i&b.grid.rowType.data){k={cell:m,event:j,handled:false};if(o=g._trigger("beforeCellEdit",null,k)){if(!k.handled){o=this._defaultBeforeCellEdit(g,k)}}if(o){m._isEdit(true);if(g.options.showRowHeader){l=e((h.$rows[0]).cells[0]).children("div.wijmo-wijgrid-innercell");if(l.length){l.empty();l.append(e("<div>&nbsp;</div>").addClass(g.options.wijCSS.icon+" ui-icon-pencil"))}}}}}}return o};f.prototype.currentCellEditEnd=function(g,n){var q=g.currentCell(),w=false,r=g._view(),h,m,k,s,p,u,l=b.grid.getKeyCodeEnum();if(!q._isValid()||!q._isEdit()){return}h=q.row();if(h){m=h.type;if(!(m&b.grid.rowType.data)){return w}k=(n&&n.which===l.ESCAPE);if(!n||(!k)){var j={cell:q,value:undefined};if(w=g._trigger("beforeCellUpdate",null,j)){if(j.value===undefined){j.value=this._getCellValue(g,q)}s=j.value;try{j.value=g._parse(q.column(),j.value);s=j.value}catch(o){j.value=s}p=q.value();if(b.grid.getDataType(j.cell.column())==="datetime"){if(s instanceof Date){s=s.getTime()}if(p instanceof Date){p=p.getTime()}}if(s!==p){try{q.value(j.value)}catch(o){var v={cell:q,value:j.value};w=false;g._trigger("invalidCellValue",null,v)}if(w){var t={cell:q};g._trigger("afterCellUpdate",null,t)}}}}else{w=true}if(w){var i={cell:q,event:n,handled:false};g._trigger("afterCellEdit",null,i);if(!i.handled){w=this._defaultAfterCellEdit(g,i)}if(w){q._isEdit(false)}if(g.options.showRowHeader){e((h.$rows[0]).cells[0]).children("div.wijmo-wijgrid-innercell").html("&nbsp;")}window.setTimeout(function(){if(!g._destroyed){q=g.currentCell();if(u=q.tableCell()){e(u).attr("tabIndex",0).focus()}else{e(g._view().focusableElement()).focus()}}},this._timeout)}}return w};f.prototype._defaultBeforeCellEdit=function(g,k){var m=k.cell.column(),q=false,n,p,l,i,o,h=b.grid.getKeyCodeEnum();if(m.dataIndex>=0){n=k.cell.value();q=true;try{p=k.cell.container();if(b.grid.getDataType(m)==="boolean"){l=p.children("input");l.focus();if(k.event&&k.event.type==="keypress"){l.one("keyup",function(r){if(r.which===h.SPACE){r.preventDefault();(l[0]).checked=!n}})}}else{l=e("<input />").attr("type","text").addClass("wijgridinput wijmo-wijinput "+g.options.wijCSS.stateFocus).bind("keydown",g,e.proxy(this._checkBoxOrInputKeyDown,this));l.bind(((e.support).selectstart?"selectstart":"mousedown"),function(r){r.stopPropagation()});if(k.event&&k.event.type==="keypress"&&k.event.which){l.val(String.fromCharCode(k.event.which))}else{switch(b.grid.getDataType(k.cell.column())){case"currency":case"number":if(n!==null){l.val(n);break}default:l.val(g._toStr(k.cell.column(),n));break}}p.empty().append(l);i=l.val().length;new b.grid.domSelection(l[0]).setSelection({start:i,end:i});l.focus();setTimeout(function(){l.focus()},this._timeout*2)}}catch(j){alert(j.message);q=false}}return q};f.prototype._defaultAfterCellEdit=function(g,j){var m=j.cell.column(),p=false,n,o,l,h,k;if(m.dataIndex>=0){p=true;k=g._view();try{n=j.cell.container();o=g._toStr(m,j.cell.value());h=k._getRowInfo(g._rows().item(j.cell.rowIndex()));if(b.grid.getDataType(m)==="boolean"){l=n.children("input");if(o==="true"){l.attr("checked","checked")}else{l.removeAttr("checked")}}else{g.cellFormatter.format(n,m,o,h)}}catch(i){alert("defaultAfterCellEdit: "+i.message);p=false}}return p};f.prototype._checkBoxOrInputKeyDown=function(h){var g=b.grid.getKeyCodeEnum();if(h.which===g.ENTER){var i=h.data;if(i){i._endEditInternal(h);return false}}};f.prototype._getCellValue=function(h,i){var j=i.container().find(":input:first"),g=null;if(j.length){g=(j.attr("type")==="checkbox")?(j[0]).checked:j.val()}return g};return f})();c.cellEditorHelper=d})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(){function f(){}f._div=document.createElement("div");f.prototype.format=function(n,l,k,m){if(m.type&b.grid.rowType.footer){if(l.aggregate&&(l.aggregate!=="none")){k=b.grid.stringFormat(l.footerText||"{0}",l._totalsValue||"")}else{k=l.footerText||l._footerTextDOM||""}}var h=true,g=null,j={$container:n,column:l,formattedValue:k,row:m,afterDefaultCallback:null},i;if(e.isFunction(l.cellFormatter)){h=!l.cellFormatter(j)}if(h){switch(b.grid.getDataType(l)){case"boolean":g=this._boolFormatter;break;default:g=this._textFormatter}if(g){g.call(this,j);if(e.isFunction(i=j.afterDefaultCallback)){i(j)}}}};f.prototype._textFormatter=function(h){var g;switch(h.row.type){case b.grid.rowType.filter:this._defFormatFilterCell(h);break;default:g=h.$container[0];if(g.firstChild){while(g.firstChild){g.removeChild(g.firstChild)}}b.grid.cellFormatterHelper._div.innerHTML=h.formattedValue||"&nbsp;";while(b.grid.cellFormatterHelper._div.firstChild){g.appendChild(b.grid.cellFormatterHelper._div.firstChild)}}};f.prototype._boolFormatter=function(k){var l,n,h="disabled='disabled'",j,m,g=b.grid.rowType,i=b.grid.getKeyCodeEnum();switch(k.row.type){case g.data:case g.data|g.dataAlt:l=k.column.owner;n=l.options.allowEditing&&(k.column.readOnly!==true);if(n){h=""}if(l._parse(k.column,l._dataViewWrapper.getValue(k.row.data,k.column.dataKey))===true){k.$container.html("<input class='wijgridinput' type='checkbox' checked='checked' "+h+" />")}else{k.$container.html("<input class='wijgridinput' type='checkbox' "+h+" />")}if(n){k.$container.children("input").bind("mousedown",function(o){j=k.$container.parent()[0];m=l.currentCell();if(m.tableCell()!==j){l._onClick({target:j})}if(!m._isEdit()){l.beginEdit()}}).bind("keydown",function(o){if(o.which===i.ENTER){l._endEditInternal(o);return false}})}break;default:this._textFormatter(k)}};f.prototype._defFormatFilterCell=function(g){var h=g.column.owner,i=h.options.wijCSS;g.$container.addClass(i.widget+" "+i.stateDefault);if((g.column.dataIndex>=0)&&!g.column.isBand&&g.column.showFilter){g.$container.html('<div class="wijmo-wijgrid-filter '+i.cornerAll+'"><input type="text" class="wijmo-wijgrid-filter-input" style="width:100%" /><a class="wijmo-wijgrid-filter-trigger '+i.cornerRight+" "+i.stateDefault+'" href="#"><span class="'+i.icon+" "+i.iconArrowDown+'"></span></a></div>')}else{g.$container.html("&nbsp;")}};return f})();d.cellFormatterHelper=c})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var d=jQuery;var e=(function(){function f(g){this._elements=[];this._gap=10;this._step=1;this._inProgress=false;this._hoveredField=null;this._startLocation=null;this._lastLocation=null;this._proxy=null;this._wijgrid=g;this._evntFormat="{0}."+this._wijgrid.widgetName+".resizer"}f.prototype.addElement=function(g){if(g&&g.element){g.element.bind(this._eventKey("mousemove"),d.proxy(this._onMouseMove,this)).bind(this._eventKey("mousedown"),d.proxy(this._onMouseDown,this)).bind(this._eventKey("mouseout"),d.proxy(this._onMouseOut,this));this._elements.push(g)}};f.prototype.dispose=function(){var g=this;d.each(this._elements,function(h,i){i.element.unbind(g._eventKey("mousemove"),g._onMouseMove).unbind(g._eventKey("mousedown"),g._onMouseDown).unbind(g._eventKey("mouseout"),g._onMouseOut)});this._detachDocEvents()};f.prototype.inProgress=function(){return this._inProgress};f.prototype._onMouseMove=function(h){if(!this._inProgress){var g=this._getFieldByPos({x:h.pageX,y:h.pageY});if(g&&g._canSize()&&this._wijgrid._canInteract()){g.element.css("cursor","e-resize");this._hoveredField=g;h.stopPropagation()}else{this._onMouseOut(h)}}};f.prototype._onMouseOut=function(g){if(!this._inProgress){if(this._hoveredField){this._hoveredField.element.css("cursor","");this._hoveredField=null}}};f.prototype._onMouseDown=function(h){this._hoveredField=this._getFieldByPos({x:h.pageX,y:h.pageY});if(this._hoveredField&&(this._hoveredField)._canSize()&&this._wijgrid._canInteract()){try{this._hoveredField.element.css("cursor","");this._docCursor=document.body.style.cursor;document.body.style.cursor="e-resize";this._startLocation=this._lastLocation=b.grid.bounds(this._hoveredField.element);this._proxy=d('<div class="wijmo-wijgrid-resizehandle '+this._wijgrid.options.wijCSS.stateHightlight+'">&nbsp;</div>');var g=this._wijgrid._view().getVisibleAreaBounds();this._proxy.css({left:h.pageX,top:this._startLocation.top,height:g.height+g.top-this._startLocation.top});d(document.body).append(this._proxy)}finally{this._attachDocEvents();this._inProgress=true;h.stopPropagation()}}};f.prototype._onDocumentMouseMove=function(h){var g=this._step*Math.round((h.pageX-this._lastLocation.left)/this._step);this._lastLocation={left:this._lastLocation.left+g,top:h.pageY,width:undefined,height:undefined};this._proxy.css("left",this._lastLocation.left)};f.prototype._onDocumentMouseUp=function(g){try{document.body.style.cursor=this._docCursor;this._proxy.remove();if(this._startLocation!==this._lastLocation){this._wijgrid._fieldResized(this._hoveredField,this._startLocation.width,this._lastLocation.left-this._startLocation.left)}}finally{this._hoveredField=null;this._proxy=null;this._detachDocEvents();this._inProgress=false}};f.prototype._onSelectStart=function(g){g.preventDefault()};f.prototype._attachDocEvents=function(){if(!this._inProgress){d(document).bind(this._eventKey("mousemove"),d.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),d.proxy(this._onDocumentMouseUp,this));if(d.fn.disableSelection){d(document.body).disableSelection()}if("onselectstart" in document){d(document.body).bind("selectstart",this._onSelectStart)}}};f.prototype._detachDocEvents=function(){if(this._inProgress){d(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp);if(d.fn.enableSelection){d(document.body).enableSelection()}if("onselectstart" in document){d(document.body).unbind("selectstart",this._onSelectStart)}}};f.prototype._getFieldByPos=function(h){var l,g,k,m,j;for(l=0,g=this._elements.length;l<g;l++){k=this._elements[l];m=b.grid.bounds(k.element);j=b.grid.isOver(h.y,h.x,m.top,m.left+m.width-this._gap,m.height,this._gap);if(j){return k}}return null};f.prototype._eventKey=function(g){return b.grid.stringFormat(this._evntFormat,g)};return f})();c.uiResizer=e})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(){function f(g){this._scope_guid="scope_"+b.grid.getUID();this._dragEnd=false;this._wijgrid=g;this._wijCSS=this._wijgrid.options.wijCSS;this._wrapHtml='<div class="'+this._wijCSS.widget+" wijmo-wijgrid "+this._wijCSS.content+" "+this._wijCSS.cornerAll+'"><table class="wijmo-wijgrid-root wijmo-wijgrid-table"><tr class="wijmo-wijgrid-headerrow"></tr></table></div>'}f.prototype.attachGroupArea=function(h){var i,g=this;if(!(e.ui).droppable||!(e.ui).draggable){return}h.droppable({scope:this._scope_guid,tolerance:"pointer",greedy:true,accept:function(j){if(g._wijgrid.options.allowColMoving){i=g._getWijFieldInstance(j);if(i){if((i instanceof e.wijmo.c1groupedfield)&&(i.options.groupedIndex===g._wijgrid._field("groupedColumns").length-1)){return false}return !i.options.isBand&&(i.options.groupedIndex===undefined||(i instanceof e.wijmo.c1groupedfield))}}return false},drop:function(k,j){if(!g._isInElement(k,j.draggable)&&(i=g._getWijFieldInstance(j.draggable))){g._dragEnd=true}},over:function(l,k){var j=g._wijgrid._field("groupedWidgets").length;g._dropTargetRedirected=(j>0);g._droppableWijField=(j>0)?g._wijgrid._field("groupedWidgets")[j-1]:h;h.data("thisDroppableWijField",g._droppableWijField)},out:function(k,j){if(g._droppableWijField===h.data("thisDroppableWijField")){g._droppableWijField=null}}})};f.prototype.attach=function(j){var h,i,g=this;if(!(e.ui).droppable||!(e.ui).draggable){return}if(!j||!(h=j.element)){return}h.draggable({helper:function(k){if(j instanceof e.wijmo.c1groupedfield){return h.clone().addClass("wijmo-wijgrid-dnd-helper")}else{return h.clone().wrap(g._wrapHtml).width(h.width()).height(h.height()).closest(".wijmo-wijgrid").addClass("wijmo-wijgrid-dnd-helper")}},appendTo:"body",scope:g._scope_guid,drag:function(m,l){g._hideArrows();if(g._droppableWijField&&!g._isInElement(m,h)){var k=g._droppableWijField.element;if(!k){k=(g._droppableWijField)}g._showArrows(k,g._getPosition(j,g._droppableWijField,m,l))}},start:function(p,o){if(g._wijgrid._canInteract()&&g._wijgrid.options.allowColMoving&&!g._wijgrid._field("resizer").inProgress()){var n=j.options,l=j.options.travIdx,m=(j instanceof e.wijmo.c1groupedfield),k=m?"groupArea":"columns";if(m){n=b.grid.search(g._wijgrid.columns(),function(q){return q.options.travIdx===l});n=(!n.found)?b.grid.getColumnByTravIdx(g._wijgrid.options.columns,l).found:n.found.options}if(j._canDrag()&&g._wijgrid._trigger("columnDragging",null,{drag:n,dragSource:k})){g._wijgrid._trigger("columnDragged",null,{drag:n,dragSource:k});return true}}return false},stop:function(l,k){g._hideArrows();try{if(g._dragEnd){if(!g._droppableWijField.element){g._wijgrid._handleDragnDrop(j.options.travIdx,-1,"left",j instanceof e.wijmo.c1groupedfield,true)}else{g._wijgrid._handleDragnDrop(j.options.travIdx,g._droppableWijField.options.travIdx,g._getPosition(j,g._droppableWijField,l,k),j instanceof e.wijmo.c1groupedfield,g._droppableWijField instanceof e.wijmo.c1groupedfield)}}}finally{g._droppableWijField=null;g._dragEnd=false}}}).droppable({hoverClass:g._wijCSS.stateHover,scope:g._scope_guid,tolerance:"pointer",greedy:true,accept:function(k){if(g._wijgrid.options.allowColMoving){if(h[0]!==k[0]){i=g._getWijFieldInstance(k);if(i){return i._canDropTo(j)}}}return false},drop:function(l,k){if(i=g._getWijFieldInstance(k.draggable)){g._dragEnd=true}},over:function(l,k){g._dropTargetRedirected=false;g._droppableWijField=j;h.data("thisDroppableWijField",g._droppableWijField)},out:function(l,k){if(g._droppableWijField===j.element.data("thisDroppableWijField")){g._droppableWijField=null}}})};f.prototype.detach=function(h){var g;if(h&&(g=h.element)){if(g.data("ui-draggable")){g.draggable("destroy")}if(g.data("ui-droppable")){g.droppable("destroy")}}};f.prototype.dispose=function(){if(this._$topArrow){this._$topArrow.remove();this._$topArrow=null}if(this._$bottomArrow){this._$bottomArrow.remove();this._$bottomArrow=null}};f.prototype._getWijFieldInstance=function(g){var h=b.grid.widgetName(g);if(!h){throw"widgetName is undedined"}return g.data(h)};f.prototype._showArrows=function(h,g){this._topArrow().show().position({my:"center",at:g+" top",of:h,collision:"none"});this._bottomArrow().show().position({my:"center",at:g+" bottom",of:h,collision:"none"})};f.prototype._hideArrows=function(){this._topArrow().hide();this._bottomArrow().hide()};f.prototype._topArrow=function(){if(!this._$topArrow){this._$topArrow=e("<div />").addClass("wijmo-wijgrid-dnd-arrow-top").append(e("<span />").addClass(this._wijCSS.icon+" ui-icon-arrowthick-1-s")).hide().appendTo(document.body)}return this._$topArrow};f.prototype._bottomArrow=function(){if(!this._$bottomArrow){this._$bottomArrow=e("<div />").addClass("wijmo-wijgrid-dnd-arrow-bottom").append(e("<span />").addClass(this._wijCSS.icon+" ui-icon-arrowthick-1-n")).hide().appendTo(document.body)}return this._$bottomArrow};f.prototype._isInElement=function(i,g){var h=b.grid.bounds(g,false);return((i.pageX>h.left&&i.pageX<h.left+h.width)&&(i.pageY>h.top&&i.pageY<h.top+h.height))};f.prototype._getPosition=function(k,i,l,m){if(!i.element){return"left"}if(this._dropTargetRedirected){return"right"}var g=b.grid.bounds(i.element,false),n=g.width/6,j=g.left+(g.width/2),o="right",h;if(l.pageX<j){o="left"}if(i instanceof e.wijmo.c1groupedfield){if(k instanceof e.wijmo.c1groupedfield){h=i.options.groupedIndex-k.options.groupedIndex;if(Math.abs(h)===1){o=(h<0)?"left":"right"}}return o}h=i.options.linearIdx-k.options.linearIdx;if(i.options.isBand&&(k.options.parentIdx!==i.options.travIdx)&&(Math.abs(l.pageX-j)<n)){return"center"}if(k.options.parentIdx===i.options.parentIdx&&Math.abs(h)===1){o=(h<0)?"left":"right"}return o};return f})();d.uiDragndrop=c})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var e=jQuery;var d=(function(){function f(g){if(!g){throw"invalid arguments"}this._wijgrid=g}f.prototype.format=function(r,q,l,g,h,p,k){var j=b.grid.renderState,i=b.grid.rowType,n=g.type,o,m=null;if(q===0&&this._wijgrid.options.showRowHeader){l=null}if(n===i.groupHeader||n===i.groupFooter){l=null;if(p&&(m=p.groupInfo)){l=this._wijgrid._field("leaves")[m.leafIndex];delete p.groupInfo}}o={$cell:r,state:h,row:g,column:l,_cellIndex:q,_purpose:m?m.purpose:undefined};if(h===j.rendering){this._renderingStateFormatter(o,p,k)}else{this._currentStateFormatter(o,h&j.current);this._selectedStateFormatter(o,h&j.selected)}if(e.isFunction(this._wijgrid.options.cellStyleFormatter)){this._wijgrid.options.cellStyleFormatter(o)}};f.prototype._renderingStateFormatter=function(i,m,l){var g=b.grid.rowType,j,n,h=i.column,k=i.row.type;switch(k){case g.header:i.$cell.addClass("wijgridth");break;default:i.$cell.addClass("wijgridtd")}if((k&g.data)&&h&&h.textAlignment){switch(h.textAlignment.toLowerCase()){case"left":i.$cell.addClass("wijalign-left");break;case"right":i.$cell.addClass("wijalign-right");break;case"center":i.$cell.addClass("wijalign-center");break}}if(m){for(j in m){if(m.hasOwnProperty(j)){n=m[j];if((j==="colSpan"||j==="rowSpan")&&!(n>1)){continue}if(j==="class"){i.$cell.addClass(n)}else{i.$cell.attr(j,n)}}}}if(l){for(j in l){if(l.hasOwnProperty(j)){if(j==="paddingLeft"){i.$cell.children(".wijmo-wijgrid-innercell").css(j,l[j]);continue}i.$cell.css(j,l[j])}}}if(i._cellIndex===0&&this._wijgrid.options.showRowHeader){i.$cell.attr({role:"rowheader",scope:"row"}).addClass(this._wijgrid.options.wijCSS.stateDefault+" "+this._wijgrid.options.wijCSS.content+" wijmo-wijgrid-rowheader")}else{switch(k){case (g.header):i.$cell.attr({role:"columnheader",scope:"col"});break;case (g.footer):i.$cell.attr({role:"columnfooter",scope:"col"});break;default:i.$cell.attr("role","gridcell")}}if(k&g.data){if(i._cellIndex>=0&&h){i.$cell.attr("headers",(window).escape(h.headerText));if(h.readOnly){i.$cell.attr("aria-readonly",true)}if(h.dataIndex>=0){i.$cell.addClass("wijdata-type-"+b.grid.getDataType(h))}}}if(k===g.groupHeader||k===g.groupFooter){if(h&&i._purpose===b.grid.groupRowCellPurpose.aggregateCell){i.$cell.addClass("wijdata-type-"+b.grid.getDataType(h))}}};f.prototype._currentStateFormatter=function(h,i){var g=b.grid.rowType;if(i){h.$cell.addClass(this._wijgrid.options.wijCSS.stateActive);if(h.row.type===g.header){h.$cell.addClass("wijmo-wijgrid-current-headercell")}else{h.$cell.addClass("wijmo-wijgrid-current-cell")}}else{h.$cell.removeClass(this._wijgrid.options.wijCSS.stateActive);if(h.row.type===g.header){h.$cell.removeClass("wijmo-wijgrid-current-headercell")}else{h.$cell.removeClass("wijmo-wijgrid-current-cell")}}};f.prototype._hoveredStateFormatter=function(g,h){if(h){}else{}};f.prototype._selectedStateFormatter=function(g,h){if(h){g.$cell.addClass(this._wijgrid.options.wijCSS.stateHightlight).attr("aria-selected","true")}else{g.$cell.removeClass(this._wijgrid.options.wijCSS.stateHightlight).removeAttr("aria-selected")}};return f})();c.cellStyleFormatterHelper=d})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var d=jQuery;var e=(function(){function f(g){if(!g){throw"invalid arguments"}this._wijgrid=g}f.prototype.format=function(m,h,j){var i=b.grid.renderState,g=b.grid.rowType,l=m.state,k=m;if(l===i.rendering){this._renderingStateFormatter(k,h,j)}else{this._currentStateFormatter(k,(l&i.current)!==0);this._hoveredStateFormatter(k,(l&i.hovered)!==0);this._selectedStateFormatter(k,(l&i.selected)!==0)}if(d.isFunction(this._wijgrid.options.rowStyleFormatter)){this._wijgrid.options.rowStyleFormatter(k)}};f.prototype._renderingStateFormatter=function(k,h,i){var m="wijmo-wijgrid-row "+this._wijgrid.options.wijCSS.content,j="wijmo-wijgrid-row "+this._wijgrid.options.wijCSS.content,g=b.grid.rowType,l;k.$rows.attr("role","row");if(h){for(l in h){if(h.hasOwnProperty(l)){if(l==="class"){k.$rows.addClass(h[l])}else{k.$rows.attr(l,h[l]);if(k.$rows[0].style.height){k.$rows.each(function(){d.data(this,"customHeight",this.style.height);return true})}}}}}if(i){for(l in i){if(i.hasOwnProperty(l)){k.$rows.css(l,i[l])}}}switch(k.type&~g.dataAlt){case (g.header):m="wijmo-wijgrid-headerrow";break;case (g.data):m=j+" wijmo-wijgrid-datarow";if(k.type&g.dataAlt){m+=" wijmo-wijgrid-alternatingrow"}break;case (g.emptyDataRow):m=j+" wijmo-wijgrid-emptydatarow";break;case (g.filter):m="wijmo-wijgrid-filterrow";break;case (g.groupHeader):m=j+" wijmo-wijgrid-groupheaderrow";break;case (g.groupFooter):m=j+" wijmo-wijgrid-groupfooterrow";break;case (g.footer):m="wijmo-wijgrid-footerrow "+this._wijgrid.options.wijCSS.stateHightlight;break;default:throw b.grid.stringFormat("unknown rowType: {0}",k.type)}k.$rows.addClass(m)};f.prototype._currentStateFormatter=function(h,g){if(this._wijgrid.options.showRowHeader){if(g){d((h.$rows[0]).cells[0]).addClass(this._wijgrid.options.wijCSS.stateActive+" wijmo-wijgrid-current-rowheadercell")}else{d((h.$rows[0]).cells[0]).removeClass(this._wijgrid.options.wijCSS.stateActive+" wijmo-wijgrid-current-rowheadercell")}}};f.prototype._hoveredStateFormatter=function(h,g){if(g){h.$rows.addClass(this._wijgrid.options.wijCSS.stateHover)}else{h.$rows.removeClass(this._wijgrid.options.wijCSS.stateHover)}};f.prototype._selectedStateFormatter=function(h,g){if(g){}else{}};return f})();c.rowStyleFormatterHelper=e})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(){function f(){this._sum=0;this._sum2=0;this._cntNumbers=0;this._cntStrings=0;this._cntDates=0;this._max=0;this._min=0;this._minDate=0;this._maxDate=0}f.prototype.add=function(h){if(h===null||h===""){return}var i,g=(h instanceof Date)?"datetime":typeof(h);i=h.toString();if(this._cntStrings++===0){this._minString=this._maxString=i}if(i<this._minString){this._minString=i}if(i>this._maxString){this._maxString=i}if(g==="number"){if(this._cntNumbers++===0){this._min=this._max=h}this._sum+=h;this._sum2+=h*h;if(h<this._min){this._min=h}if(h>this._max){this._max=h}}else{if(g==="datetime"){i=h.getTime();if(this._cntDates++===0){this._minDate=this._maxDate=i}if(i<this._minDate){this._minDate=i}if(i>this._maxDate){this._maxDate=i}}}};f.prototype.getValueString=function(h){var g=h.owner;if(this._cntNumbers&&(h.dataType==="number"||h.dataType==="currency")){var i=this._getValue(h.aggregate);return g._toStr(h,i)}if(this._cntDates&&(h.dataType==="datetime")){switch(h.aggregate){case"max":return g._toStr(h,new Date(this._maxDate));case"min":return g._toStr(h,new Date(this._minDate));case"count":return this._cntStrings+""}}if(this._cntStrings){switch(h.aggregate){case"max":return this._maxString;case"min":return this._minString;case"count":return this._cntStrings+""}}return""};f.prototype._getValue=function(h){switch(h){case"average":return(this._cntNumbers===0)?0:this._sum/this._cntNumbers;case"count":return this._cntStrings;case"max":return this._max;case"min":return this._min;case"sum":return this._sum;case"std":if(this._cntNumbers<=1){return 0}return Math.sqrt(this._getValue("var"));case"stdPop":if(this._cntNumbers<=1){return 0}return Math.sqrt(this._getValue("varPop"));case"var":if(this._cntNumbers<=1){return 0}return this._getValue("varPop")*this._cntNumbers/(this._cntNumbers-1);case"vapPop":if(this._cntNumbers<=1){return 0}var g=this._sum/this._cntNumbers;return this._sum2/this._cntNumbers-g*g}return 0};return f})();d.tally=c})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(d){var e=jQuery;var c=(function(){function f(g){this._docEventsUID="wijgridfrozener"+b.grid.getUID();this._docEventsAttached=false;this._newStaticIndex=-1;this._staticColumnIndex=-1;this._staticRowIndex=-1;this._staticOffsetH=0;this._staticOffsetV=0;this._inProgress=false;this._wijgrid=g;this.refresh()}f.prototype.inProgress=function(){return this._inProgress};f.prototype.refresh=function(){this.dispose();this._$outerDiv=this._wijgrid.outerDiv.find(".wijmo-wijgrid-fixedview");this._superPanel=(this._wijgrid._view())._getSuperPanel();this._staticOffsetH=this._wijgrid._getStaticOffsetIndex(false);this._staticOffsetV=this._wijgrid._getStaticOffsetIndex(true);this._staticColumnIndex=this._wijgrid._getStaticIndex(false);this._staticRowIndex=this._wijgrid._getStaticIndex(true);this._visibleBounds=this._wijgrid._view().getVisibleAreaBounds();var h=b.grid.bounds(this._$outerDiv.find(".wijmo-wijgrid-split-area-nw")),g=b.grid.bounds(this._$outerDiv);this._createVBar(this._visibleBounds,h,g);this._createHBar(this._visibleBounds,h,g)};f.prototype.dispose=function(){if(this._$hBar){this._$hBar.remove();this._$hBar=null}if(this._$vBar){this._$vBar.remove();this._$vBar=null}if(this._$proxy){this._$proxy.remove();this._$proxy=null}this._$outerDiv=null;this._superPanel=null;this._detachDocEvents()};f.prototype._createVBar=function(k,j,g){var i=j.width+j.left,h=this;if(i<=k.left+k.width){this._$vBar=e("<div><div></div></div>").addClass("wijmo-wijgrid-frozener-v").css({left:i-g.left,top:j.top-g.top,height:k.height+k.top-j.top}).bind("mousedown",function(l){l.data=true;h._onBarMouseDown.apply(h,arguments)}).appendTo(this._$outerDiv);this._$vBar.find("div").addClass(this._wijgrid.options.wijCSS.header).css({width:0,height:"100%"})}};f.prototype._createHBar=function(k,j,g){var i=j.top+j.height,h=this;if(i<=k.top+k.height){this._$hBar=e("<div><div></div></div>").addClass("wijmo-wijgrid-frozener-h").css({left:j.left-g.left,top:i-g.top,width:k.width+k.left-j.left}).bind("mousedown",function(l){l.data=false;h._onBarMouseDown.apply(h,arguments)}).appendTo(this._$outerDiv);this._$hBar.find("div").addClass(this._wijgrid.options.wijCSS.header).css({width:"100%",height:0})}};f.prototype._onBarMouseDown=function(g){this._visibleBounds=this._wijgrid._view().getVisibleAreaBounds();this._newStaticIndex=g.data?this._staticColumnIndex:this._staticRowIndex;this._$proxy=e('<div class="wijmo-wijgrid-resizehandle '+this._wijgrid.options.wijCSS.header+'"></div>').appendTo(document.body);this._attachDocEvents(g.data);this._inProgress=true;g.stopPropagation()};f.prototype._onDocumentMouseMove=function(g){if(g.data&&this._superPanel.options.hScroller.scrollValue){(this._superPanel).hScrollTo(0)}else{if(!g.data&&this._superPanel.options.vScroller.scrollValue){(this._superPanel).vScrollTo(0)}}this._showPosition(g)};f.prototype._onDocumentMouseUp=function(g){try{if(this._$proxy){this._$proxy.remove()}this._detachDocEvents();if(g.data){if(this._newStaticIndex!==this._staticColumnIndex){this._wijgrid.option("staticColumnIndex",this._newStaticIndex)}}else{if(this._newStaticIndex!==this._staticRowIndex){this._wijgrid.option("staticRowIndex",this._newStaticIndex)}}}finally{this._$proxy=null;this._inProgress=false}};f.prototype._attachDocEvents=function(g){if(!this._docEventsAttached){try{if(e.fn.disableSelection){e(document.body).disableSelection()}this._wijgrid._view().toggleDOMSelection(false);e(document).bind(this._docEventKey("mousemove"),g,e.proxy(this._onDocumentMouseMove,this)).bind(this._docEventKey("mouseup"),g,e.proxy(this._onDocumentMouseUp,this))}finally{this._docEventsAttached=true}}};f.prototype._detachDocEvents=function(){if(this._docEventsAttached){try{if(e.fn.enableSelection){e(document.body).enableSelection()}this._wijgrid._view().toggleDOMSelection(true);e(document).unbind("."+this._docEventsUID)}finally{this._docEventsAttached=false}}};f.prototype._docEventKey=function(g){return b.grid.stringFormat("{0}.{1}",g,this._docEventsUID)};f.prototype._showPosition=function(k){var i,n,h,m,o,l,j,g;if(k.data){g=b.grid.bounds(this._$vBar);if(Math.abs(k.pageX-(g.left+g.width/2))<g.width){this._$proxy.hide();return}if((i=this._getFieldByPos({x:k.pageX,y:k.pageY}))){n=b.grid.bounds(i.element);h=n.left+n.width/2;m=i.options.visLeavesIdx-this._staticOffsetV;o=Math.max(m-1,-1);l=k.pageX<h?(o!==this._staticColumnIndex):(m===this._staticColumnIndex);j=l?n.left:n.left+n.width;if(!b.grid.isOverAxis(j,this._visibleBounds.left-1,this._visibleBounds.width+2)){return}this._newStaticIndex=l?o:m;this._$proxy.show().css({left:j,top:n.top,width:3,height:this._visibleBounds.height+this._visibleBounds.top-n.top})}}else{g=b.grid.bounds(this._$hBar);if(Math.abs(k.pageY-(g.top+g.height/2))<g.height){this._$proxy.hide();return}if((i=this._getRowByPos({x:k.pageX,y:k.pageY}))){n=b.grid.bounds(i);h=n.top+n.height/2;m=this._wijgrid._view().getAbsoluteRowIndex(i)-this._staticOffsetH;o=Math.max(m-1,-1);l=k.pageY<h?(o!==this._staticRowIndex):(m===this._staticRowIndex);j=l?n.top:n.top+n.height;if(!b.grid.isOverAxis(j,this._visibleBounds.top-1,this._visibleBounds.height+2)){return}this._newStaticIndex=l?o:m;this._$proxy.show().css({left:n.left,top:j,width:this._visibleBounds.width+this._visibleBounds.left-n.left,height:3})}}};f.prototype._getFieldByPos=function(n){var k=this._wijgrid.columns(),j,g,h,m,l;for(j=0,g=k.length;j<g;j++){h=k[j];m=h.options;if(m.isLeaf){l=b.grid.bounds(h.element);if(b.grid.isOverAxis(n.x,l.left,l.width)){return h}}}return null};f.prototype._getRowByPos=function(m){var k=this._wijgrid._rows(),h,g,l,j;for(h=0,g=k.length();h<g;h++){l=k.item(h)[0];j=b.grid.bounds(e(l));if(b.grid.isOverAxis(m.y,j.top,j.height)){return l}}return null};return f})();d.uiFrozener=c})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var d=jQuery;var e=(function(){function i(){}i.generate=function g(m,l,k){switch(m){case"append":i._processAppendMode(l,k);break;case"merge":i._processMergeMode(l,k);break;case"none":break;default:throw b.grid.stringFormat('Unsupported value: "{0}"',m)}};i._processAppendMode=function h(m,l){var k={};b.grid.traverse(l,function(n){if(n.dynamic&&b.grid.validDataKey(n.dataKey)){k[n.dataKey]=true}});d.each(m,function(p,o){if(("name" in o)&&!k[o.name]){var n=i._createAutoField(o);l.push(n)}})};i._processMergeMode=function f(m,l){var n=[],k;b.grid.traverse(l,function(o){if(o.isLeaf&&!o.isBand){var p=o.dataKey;if(b.grid.validDataKey(p)){if(m[p]!==undefined){delete m[p]}}else{if(p!==null){n.push(o)}}}});if(n.length){k=0;d.each(m,function(p,q){var o=n[k++];if(o){o.dataKey=q.name;delete m[p]}})}d.each(m,function(p,q){var o=i._createAutoField(q);l.push(o)})};i._createAutoField=function j(k){return b.grid.createDynamicField({dataKey:k.name})};return i})();c.columnsGenerator=e})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var d=jQuery;var e=(function(){function f(i,h,k){this._timer=0;this._timeout=50;this._ignoreScrollEvents=false;this._wijgrid=i;this._fixedAreaHeight=k;this._view=this._wijgrid._view();this._N=this._wijgrid._totalRowsCount();var j=20,g=this._wijgrid.outerDiv.height()+this._N*j;h.height(g-k-(this._N>0?j:0));this._view._splitAreas.sw.height(g)}f.prototype.attach=function(m){this._$scroller=m;this._panelInst=m.data("wijmo-wijsuperpanel");var i,l=m.find(".wijmo-wijsuperpanel-contentwrapper:first"),j=(this._panelInst).getContentElement().height(),h=this._fixedAreaHeight+j,g=l.innerHeight(),k=(101/(this._N-1))*((h-g)/h);i=this._panelInst.options.vScroller;i.scrollSmallChange=k;this._panelInst.option("vScroller",i);m.bind("wijsuperpanelscrolled.wijgrid",d.proxy(this._onSuperpanelScrolled,this));m.bind("wijsuperpanelscrolling.wijgrid",d.proxy(this._onSuperpanelScrolling,this));m.bind("wijsuperpanelscrolled.wijgrid",d.proxy(this._onSuperpanelPostScrolled,this))};f.prototype.dispose=function(){this._$scroller.unbind(".wijgrid");this._clearTimer()};f.prototype._clearTimer=function(){window.clearTimeout(this._timer);this._timer=0};f.prototype._onSuperpanelScrolling=function(h,g){if(this._ignoreScrollEvents||(g.dir!=="v")){return}if(this._timer===-1){return false}};f.prototype._onSuperpanelScrolled=function(i,h){var g=this;if(this._ignoreScrollEvents||(h.dir!=="v")){return}if(this._timer>0){this._clearTimer()}if(this._timer!==-1){this._timer=window.setTimeout(function(){g._timer=-1;var k=Math.round(h.newValue/g._panelInst.options.vScroller.scrollSmallChange),j=g._view._bounds.start;if(k<0){k=0}if(k>=g._N){k=g._N-1}if(k!==j){g._wijgrid._handleVirtualScrolling(k,d.proxy(g._scrollingCompleted,g))}else{g._log();g._clearTimer()}},this._timeout)}};f.prototype._scrollingCompleted=function(g){this._wijgrid._trackScrollingIndex(g);this._log();this._clearTimer()};f.prototype._onSuperpanelPostScrolled=function(){if(d.isFunction(this._postScrolled)){this._postScrolled.apply(this,arguments)}};f.prototype._log=function(){};return f})();c.uiVirtualScroller=e})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));var wijmo;(function(a){(function(e){var d=jQuery,g=Globalize;function f(m,k,j,i){var h=m;i=d.extend({nullString:"",format:""},i);function l(n){i.parser=i.parser||e.defaultParsers[n];if(!i.parser&&m!=null){e.errors.noParser(n)}return i.parser}k=k||m!=null&&typeof m;j=j||k;if(!j){return m}if(j=="string"){l(k);if(!i.parser){return m}return i.parser.toStr(m,i.culture,i.format,i.nullString,true)}l(j);if(!i.parser){return m}m=i.parser.parse(m,i.culture,i.format,i.nullString,true);if(isNaN(m)&&m!=null&&e.util.isNumeric(m)){if(i.ignoreError){return h}e.errors.cantConvert(j,h)}return m}e.convert=f;e.defaultParsers={string:{parse:function(k,j,l,i,h){switch(k){case null:return null;case i:if(h){return null}case undefined:case"&nbsp":return"";default:return""+k}},toStr:function(k,j,l,i,h){if(k===null&&h){return i}return""+k}},number:{parse:function(l,j,m,i,h){var k=typeof(l);if(k==="number"){return isNaN(l)?NaN:l}if((!l&&l!==0)||(l==="&nbsp;")||(l===i&&h)){return null}return g.parseFloat(l,10,j.name)},toStr:function(k,j,l,i,h){if(k===null&&h){return i}return g.format(k,l?l:"n",j.name)}},currency:{parse:function(l,j,m,i,h){var k=typeof(l);if(k==="number"){return isNaN(l)?NaN:l}if((!l&&l!==0)||(l==="&nbsp;")||(l===i&&h)){return null}if(k==="string"){l=l.replace(j.numberFormat.currency.symbol,"")}return g.parseFloat(l,10,j.name)},toStr:function(k,j,l,i,h){if(k===null&&h){return i}return g.format(k,l?l:"c",j.name)}},datetime:{parse:function(m,j,n,i,h){var l;if(m instanceof Date){return m}if(!m||(m==="&nbsp;")||(m===i&&h)){return null}l=/^\/Date\((\d+)\)\/$/.exec(m);if(l){return new Date(parseInt(l[1],10))}var k=g.parseDate(m,n,j.name);if(k==null||isNaN(k)){k=Date.parse(m);k=isNaN(k)?NaN:new Date(k)}return k},toStr:function(k,j,l,i,h){if(k===null&&h){return i}return g.format(k,l?l:"d",j.name)}},"boolean":{parse:function(k,j,l,i,h){var m=typeof(k);if(m==="number"){return k!=0}if(m==="boolean"){return k}if(m==="string"){k=d.trim(k)}if(!k||(k==="&nbsp;")||(k===i&&h)){return null}switch(k.toLowerCase()){case"true":return true;case"false":return false}return NaN},toStr:function(k,j,l,i,h){if(k===null&&h){return i}return(k)?"true":"false"}}};function c(h){return function(){if(!g){e.util.logError(e.errors.noGlobalize.create().message)}return h.apply(this,arguments)}}d.each(e.defaultParsers,function(h,i){i.parse=i.parse&&c(i.parse);i.toStr=i.toStr&&c(i.toStr)})})(a.data||(a.data={}));var b=a.data})(wijmo||(wijmo={}));var wijmo;(function(a){(function(c){(function(f){(function(g){g.Connective={AND:"and",OR:"or"};function i(l){function k(o){var m=[];if(o.length===0){return m}var n=g.Connective.AND;c.util.each(o,function(q,r){if(q==0&&c.util.isString(r)){var s=r.toLowerCase();if(s==g.Connective.AND||s==g.Connective.OR){n=s;return}}if($.isArray(r)){r=k(r);if(!r){return}if(r[0]===n||r.length==2){r.shift();m=m.concat(r);return}}else{var p=f.normalizeCondition(r);if(!p){return}p.property=r.property;r=p}m.push(r)});if(m.length==0){return null}else{m.unshift(n);return m}}return k(l)}function j(l){if(!$.isArray(l)){return null}var k={original:l,normalized:i(l),func:null};if(k.normalized==null){k.func=function(m){return true}}else{k.func=function(m){function n(q){var o=q[0]===g.Connective.AND,p=o?c.util.every:c.util.some;return p(q,function(s,r){if(r===0){return o}if($.isArray(s)){return n(s)}else{var t=c.util.getProperty(m,s.property);return s.op.apply(t,s.value)}})}return n(k.normalized)}}return k}function h(k){return j(k)||c.filtering.compile(k)}g.compile=h})(f.extended||(f.extended={}));var e=f.extended})(c.filtering||(c.filtering={}));var d=c.filtering})(a.data||(a.data={}));var b=a.data})(wijmo||(wijmo={}));var wijmo;(function(b){(function(c){var g=jQuery;var f=b.data;var e=f.filtering.extended;var d=(function(){function i(j){this.real=j;this._updatingFilter=false;this._overrideFilter();this._makeMemberProxies()}i.prototype._overrideFilter=function(){var j=this;this.filter=f.observable(this.real.filter());this.filter.subscribe(function(k){if(j.real.filter()!==k&&!j._updatingFilter){j.refresh({filter:k})}});this.real.filter.subscribe(function(k){if(k!==j._lastSetFilter){j.filter(k)}})};i.prototype.refresh=function(j,l){if(typeof l==="undefined"){l=false}j=g.extend({},j);var k=j.filter;j.filter=this._coerceFilter(j.filter);this._lastSetFilter=j.filter;this._updatingFilter=true;try{if(g.isFunction(j.filter)&&!g.isFunction(k)){this.filter(k)}else{this.filter(j.filter)}}finally{this._updatingFilter=false}return this.real.refresh(j,l)};i.prototype._makeMemberProxies=function(){var j=this;f.util.each(this.real,function(k,l){if(!g.isFunction(l)||j[k]||k.charAt(0)==="_"){return}j[k]=g.isFunction(l.subscribe)?l:function(){return l.apply(j.real,arguments)}})};i.create=function h(j){return new i(j)};i.prototype._convertComplexPropertyFilterToExtendedFilterFormat=function(k){var j=[];g.each(k,function(o,l){if(!g.isArray(l)){l=[l]}else{var m=f.util.isString(l[0])&&l[0].toLowerCase();if(m===e.Connective.AND||m===e.Connective.OR){j.push(l);return}}var n=[];g.each(l,function(q,r){var p=f.filtering.normalizeCondition(r);if(p){p.property=o;n.push(p)}});if(n.length>0){j.push(n)}});return j.length>0?j:null};i.prototype._coerceFilter=function(j){if(g.isArray(j)){return e.compile(j).func}else{if(!g.isPlainObject(j)){return j}}j=g.extend(true,{},j);var l={};g.each(j,function(o,m){if(!g.isArray(m)){m=[m]}if(l){var n=f.util.isString(m[0])&&m[0].toLowerCase();if(m.length==1||m.length==2&&(n==="and"||n==="or")){l[o]=m[m.length-1];return}}j[o]=m;l=null});if(l){return l}var k=this._convertComplexPropertyFilterToExtendedFilterFormat(j);return e.compile(k).func};i.prototype._unsafeReplace=function(j,k){(this.real).sourceArray[j]=k;(this.real).local[j]=k};i.prototype._unsafeSplice=function(j,l,k){if(arguments.length===2){(this.real).sourceArray.splice(j,l);(this.real).local.splice(j,l)}else{(this.real).sourceArray.splice(j,l,k);(this.real).local.splice(j,l,k)}};i.prototype._unsafePush=function(j){(this.real).sourceArray.push(j);(this.real).local.push(j)};return i})();c.GridDataView=d})(b.grid||(b.grid={}));var a=b.grid})(wijmo||(wijmo={}));