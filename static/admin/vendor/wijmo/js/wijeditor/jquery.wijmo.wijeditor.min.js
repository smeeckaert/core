var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){"use strict";var t=jQuery,n="wijeditor",r=alert,i=window,s=document,o=parseInt,u,a,f,l=[],c=null,h=!0,p=!0,d=0,v=[],m=null,g=null,y="setButtonDisabled",b="setButtonsDisabled",w="setButtonChecked",E="setButtonsChecked",S="form",x="imagebutton",T="textarea",N="button",C="textbox",k="list",L="passwordfield",A="dropdownlist",O="hiddenfield",M="radio",_="checkbox",D="insertcol",P="insertrow",H="insertcell",B="splitcell",j="mergecell",F="deletecol",I="deleterow",q="deletecell",R="justifyleft",U="justifycenter",z="justifyright",W="justifyfull",X="borders",V="insertorderedlist",$="insertunorderedlist",J="outdent",K="indent",Q="backcolor",G="fontcolor",Y="bold",Z="italic",et="strikethrough",tt="underline",nt="subscript",rt="superscript",it="template",st="removeformat",ot="insertbreak",ut="insertparagraph",at="insertprintpagebreak",ft="inserthorizontalrule",lt="tablebutton",ct="inserttable",ht="edittable",pt="wysiwyg",dt="split",vt="code",mt="wordwrap",gt="fullscreen",yt="undo",bt="redo",wt="preview",Et="cleanup",St="cut",xt="copy",Tt="paste",Nt="selectall",Ct="media",kt="specialchar",Lt="datetime",At="find",Ot="inspect",Mt="save",_t="spelling",Dt="imagebrowser",Pt="link",Ht="xx-small",Bt="x-small",jt="small",Ft="medium",It="large",qt="x-large",Rt="xx-large",Ut="fontname",zt="fontsize",Wt="blockquote",Xt="insertcode",Vt="wijmo-wijribbon",$t=Vt+"-bigbutton",Jt=Vt+"-dropdownbutton",Kt=Vt+"-splitbutton",Qt=Vt+"-list",Gt=Vt+"-save",Yt=Vt+"-save16",Zt=Vt+"-undo",en=Vt+"-redo",tn=Vt+"-preview",nn=Vt+"-cleanup",rn=Vt+"-cut",sn=Vt+"-copy",on=Vt+"-paste",un=Vt+"-selectall",an=Vt+"-bgcolor",fn=Vt+"-color",ln=Vt+"-bold",cn=Vt+"-italic",hn=Vt+"-underline",pn=Vt+"-strike",dn=Vt+"-sub",vn=Vt+"-sup",mn=Vt+"-template",gn=Vt+"-removeformat",yn=Vt+"-justifyleft",bn=Vt+"-justifycenter",wn=Vt+"-justifyright",En=Vt+"-justifyfull",Sn=Vt+"-borders",xn=Vt+"-orderlist",Tn=Vt+"-unorderlist",Nn=Vt+"-outdent",Cn=Vt+"-indent",kn=Vt+"-inspect",Ln=Vt+"-find",An=Vt+"-table",On=Vt+"-inserttable",Mn=Vt+"-edittable",_n=Vt+"-insertcol",Dn=Vt+"-insertrow",Pn=Vt+"-insertcell",Hn=Vt+"-splitcell",Bn=Vt+"-mergecell",jn=Vt+"-deletecol",Fn=Vt+"-deleterow",In=Vt+"-deletecell",qn=Vt+"-insertbreak",Rn=Vt+"-insertparagraph",Un=Vt+"-insertprintpagebreak",zn=Vt+"-inserthr",Wn=Vt+"-form",Xn=Vt+"-textarea",Vn=Vt+"-textbox",$n=Vt+"-password",Jn=Vt+"-hiddenfield",Kn=Vt+"-imagebutton",Qn=Vt+"-button",Gn=Vt+"-listbox",Yn=Vt+"-dropdownlist",Zn=Vt+"-radio",er=Vt+"-checkbox",tr=Vt+"-link",nr=Vt+"-link16",rr=Vt+"-imagebrowser",ir=Vt+"-media",sr=Vt+"-specialchar",or=Vt+"-datetime",ur=Vt+"-blockquote",ar=Vt+"-insertcode",fr=Vt+"-modes",lr=Vt+"-designview",cr=Vt+"-sourceview",hr=Vt+"-splitview",pr=Vt+"-wordwrap",dr=Vt+"-fullscreen",vr="wijmo-wijeditor",mr=vr+"-container",gr=vr+"-header",yr=vr+"-content",br=vr+"-footer",wr=vr+"-pathselector",Er=vr+"-fullscreen",Sr=vr+"-dialog",xr=Sr+"-hr",Tr=Sr+"-buttons",Nr=Sr+"-button",Cr=Sr+"-text",kr=vr+"-imagedlg",Lr=kr+"-content",Ar=kr+"-fields",Or=kr+"-imagefield",Mr=kr+"-imagelist",_r=kr+"-preview",Dr=kr+"-imagesrc",Pr=kr+"-imagealt",Hr=kr+"-imagewidth",Br=kr+"-imageheight",jr=kr+"-css",Fr=kr+"-hideimagelist",Ir=vr+"-templatedlg",qr=Ir+"-toplabels",Rr=Ir+"-topleftlabel",Ur=Ir+"-toprightlabel",zr=Ir+"-content",Wr=Ir+"-templatelist",Xr=Ir+"-preview",Vr=Ir+"-templateinfo",$r=Ir+"-nameinfo",Jr=Ir+"-descriptioninfo",Kr=Ir+"-fields",Qr=Ir+"-name",Gr=Ir+"-description",Yr=Ir+"-buttons",Zr=Ir+"-delete",ei=Ir+"-save",ti=vr+"-linkdlg",ni=ti+"-address",ri=ti+"-linktype",ii=ti+"-anchor",si=ti+"-text",oi=ti+"-target",ui=ti+"-css",ai=ti+"-src",fi=ti+"-width",li=ti+"-height",ci=ti+"-imagecontainer",hi=ti+"-linkicontype",pi=vr+"-codedlg",di=pi+"-source",vi=pi+"-sourcelabel",mi=vr+"-taginsdlg",gi=mi+"-caption",yi=mi+"-taglabel",bi=mi+"-tagtext",wi=mi+"-filterempty",Ei=mi+"-attribs",Si=mi+"-attriblist",xi=mi+"-innerhtml",Ti=mi+"-css",Ni=vr+"-colordlg",Ci=Ni+"-picker",ki=Ni+"-color",Li=vr+"-tabledlg",Ai=Li+"-rows",Oi=Li+"-columns",Mi=Li+"-width",_i=Li+"-height",Di=Li+"-border",Pi=Li+"-cellpadding",Hi=Li+"-cellspacing",Bi=Li+"-csstext",ji=Li+"-bgcolor",Fi=vr+"-previewdlg",Ii=Fi+"-caption",qi=Fi+"-navigator",Ri=Fi+"-prev",Ui=Fi+"-next",zi=Fi+"-printall",Wi=Fi+"-printone",Xi=Fi+"-ok",Vi=Fi+"-printdocument",$i=Fi+"-previewiframe",Ji=vr+"-cleanupdlg",Ki=Ji+"-caption",Qi=Ji+"-document",Gi=Ji+"-actions",Yi=vr+"-finddlg",Zi=Yi+"-find",es=Yi+"-replace",ts=vr+"-mediadlg",ns=ts+"-type",rs=ts+"-src",is=ts+"-width",ss=ts+"-height",os=vr+"-specialchardlg",us=os+"-chars",as=os+"-preview",fs=os+"-content",ls=os+"-list",cs=os+"_label",hs=os+"-punctuation",ps=os+"-symbols",ds=os+"-diacritics",vs="wijmo-formatspan",ms="."+Tr+" input:first",gs="."+Tr+" input:last",ys="."+Tr+" input[value='OK']",bs="."+Tr+" input[engValue='Cancel']",ws=["Bold","Italic","UnderLine","StrikeThrough","SubScript","SuperScript","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","Border","NumberedList","BulletedList","Outdent","Indent"],Es=["Bold","Italic","Link","BlockQuote","StrikeThrough","InsertDate","InsertImage","NumberedList","BulletedList","InsertCode"],Ss=["Bold","Italic","StrikeThrough","UnderLine","ForeColor","FontSize","Link","InsertImage","NumberedList","BulletedList","BlockQuote"],xs={Form:{name:"form",tip:"Form",css:Wn},Image:{name:"imagebutton",tip:"Image Button",css:Kn},TextArea:{name:"textarea",tip:"TextArea",css:Xn},Button:{name:"button",tip:"Button",css:Qn},TextBox:{name:"textbox",tip:"TextBox",css:Vn},List:{name:"list",tip:"ListBox",css:Gn},PasswordField:{name:"passwordfield",tip:"Password Field",css:$n},DropDownList:{name:"dropdownlist",tip:"DropDownList",css:Yn},HiddenField:{name:"hiddenfield",tip:"Hidden Field",css:Jn},Radio:{name:"radio",tip:"RadioButton",css:Zn},CheckBox:{name:"checkbox",tip:"CheckBox",css:er},InsertColumn:{name:"insertcol",tip:"Insert Column",css:_n},InsertRow:{name:"insertrow",tip:"Insert Row",css:Dn},InsertCell:{name:"insertcell",tip:"Insert Cell",css:Pn},SplitCell:{name:"splitcell",tip:"Split Cell",css:Hn},MergeCell:{name:"mergecell",tip:"Merge Cell",css:Bn},DeleteColumn:{name:"deletecol",tip:"Delete Column",css:jn},DeleteRow:{name:"deleterow",tip:"Delete Row",css:Fn},DeleteCell:{name:"deletecell",tip:"Delete Cell",css:In},JustifyLeft:{name:"justifyleft",tip:"Justify Left",css:yn,grpname:"alignment"},JustifyCenter:{name:"justifycenter",tip:"Justify Center",css:bn,grpname:"alignment"},JustifyRight:{name:"justifyright",tip:"Justify Right",css:wn,grpname:"alignment"},JustifyFull:{name:"justifyfull",tip:"Justify Full",css:En,grpname:"alignment"},Border:{name:"borders",tip:"Border",css:Sn},NumberedList:{name:"insertorderedlist",tip:"Numbered List",css:xn,grpname:"list"},BulletedList:{name:"insertunorderedlist",tip:"Bulleted List",css:Tn,grpname:"list"},Outdent:{name:"outdent",tip:"Outdent",css:Nn,grpname:"block"},Indent:{name:"indent",tip:"Indent",css:Cn,grpname:"block"},BackColor:{name:"backcolor",tip:"Background Color",css:an},ForeColor:{name:"fontcolor",tip:"Font Color",css:fn},Bold:{name:"bold",tip:"Bold",css:ln},Italic:{name:"italic",tip:"Italic",css:cn},StrikeThrough:{name:"strikethrough",tip:"Strikethrough",css:pn},UnderLine:{name:"underline",tip:"Underline",css:hn},SubScript:{name:"subscript",tip:"Subscript",css:dn},SuperScript:{name:"superscript",tip:"Superscript",css:vn},Template:{name:"template",tip:"Template",css:mn},RemoveFormat:{name:"removeformat",tip:"RemoveFormat",css:gn},InsertBreak:{name:"insertbreak",tip:"Insert Break",css:qn},InsertParagraph:{name:"insertparagraph",tip:"Insert Paragraph",css:Rn},InsertPrint:{name:"insertprintpagebreak",tip:"Insert Print Page Break",css:Un},InsertHR:{name:"inserthorizontalrule",tip:"Insert Horizontal Line",css:zn},Table:{name:"tablebutton",tip:"Table",css:An},InsertTable:{name:"inserttable",tip:"Insert Table",css:On},EditTable:{name:"edittable",tip:"Edit Table",css:Mn},Wysiwyg:{name:"wysiwyg",tip:"Design View",css:lr,grpname:"modes"},Split:{name:"split",tip:"Split View",css:hr,grpname:"modes"},Code:{name:"code",tip:"Source View",css:cr,grpname:"modes"},Wordwrap:{name:"wordwrap",tip:"Wordwrap",css:pr},FullScreen:{name:"fullscreen",tip:"Fullscreen",css:dr},Undo:{name:"undo",tip:"Undo",css:Zt},Redo:{name:"redo",tip:"Redo",css:en},Preview:{name:"preview",tip:"Preview",css:tn},Cleanup:{name:"cleanup",tip:"Clean up",css:nn},Cut:{name:"cut",tip:"Cut",css:rn},Copy:{name:"copy",tip:"Copy",css:sn},Paste:{name:"paste",tip:"Paste",css:on},SelectAll:{name:"selectall",tip:"Select All",css:un},Media:{name:"media",tip:"Media",css:ir},InsertSpecialChar:{name:"specialchar",tip:"Insert Special Character",css:sr},InsertDate:{name:"datetime",tip:"Insert Date Time",css:or},Find:{name:"find",tip:"Find And Replace",css:Ln,text:"Find"},Inspect:{name:"inspect",tip:"Tag Inspect",css:kn,text:"Inspect"},Save:{name:"save",tip:"Save",css:Gt,text:"Save"},Spelling:{name:"spelling",tip:"Form",css:""},InsertImage:{name:"imagebrowser",tip:"Image Browser",css:rr},Link:{name:"link",tip:"Link",css:tr,text:"Link"},FontName:{name:"fontname",tip:"Font Name",css:Jt},FontSize:{name:"fontsize",tip:"Font Size",css:Jt},BlockQuote:{name:"blockquote",tip:"Block Quote",css:ur},InsertCode:{name:"insertcode",tip:"Insert Code",css:ar}},Ts=function(){var e=this,t=[];e.append=function(e){t.push(e)},e.toString=function(){return t.join("")},e.dispose=function(){t=null}},Ns=function(e){this.text=e,this.render=function(){return this.text}},Cs=function(e,n,r){var i=this,s={br:!0,img:!0,hr:!0,input:!0};i.tagName=e||"div",i.attributes=r||{},i.innerText=n||"",i.children=[],t.isPlainObject(n)&&(i.innerText="",i.attributes=n),i._isShortTag=!1,s[i.tagName]===!0&&(i._isShortTag=!0),i.render=function(){var e=new Ts,n="";return e.append(i._renderBeginTag(i.tagName,i.attributes)),i.innerText!==""&&e.append(i.innerText),i.children.length>0&&t.each(i.children,function(t,n){e.append(n.render())}),e.append(i._renderEndTag(i.tagName)),n=e.toString(),e.dispose(),n},i.add=function(e){this.children.push(e)},i._renderBeginTag=function(e,n){var r=new Ts,i="";return r.append("<"),r.append(e),t.each(n,function(e,t){r.append(" "),r.append(e),r.append("="),r.append('"'),r.append(t?t.toString():""),r.append('"')}),this._isShortTag?r.append(" "):r.append(">"),i=r.toString(),r.dispose(),i},i._renderEndTag=function(e){var t=new Ts,n="";return this._isShortTag?t.append("/>"):(t.append("</"),t.append(e),t.append(">")),n=t.toString(),t.dispose(),n}},ks=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.wijeditor=function(){this._curPageIdx=0,this.tRange=null,this.txtFoundInIE=!1,this.txtFoundInNoneIE=!1},n.prototype._create=function(){var e=this;window.wijmoApplyWijTouchUtilEvents&&(t=window.wijmoApplyWijTouchUtilEvents(t));if(e.element.is("input"))return;e.id_prefix="wijeditor-"+e.element.attr("id")+"-",e.$ribbon=undefined,e.$modes=undefined,e._editorify(),e._initElements(),i.setTimeout(function(){e.options.disabled&&e._handleDisabledOption(!0,e.editor)},40),e._continueSavingInputTextForUndo=!1,e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.refresh(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijeditor")},n.prototype._contextMenuWidgetName=function(){return"wijmenu"},n.prototype._createBigButton=function(e,t,n,r){var i=this,s=i._createElement("button",{title:e,name:n,"class":$t});return s.add(i._createDiv(t)),s.add(i._createSpan("",r)),s},n.prototype._createTextButton=function(e,t,n){return this._createElement("button",n,{title:e,name:t})},n.prototype._createButton=function(e,t,n,r){var i=this,s;return r?(s=i._createElement("button",{title:e,name:n}),s.add(i._createSpan(t)),s.add(i._createSpan("",r)),s):i._createElement("button",{title:e,name:n,"class":t})},n.prototype._createTextRadioButton=function(e,t,n,r,i){var s=this,o=[];return o.push(s._createElement("input",{id:t+n,type:"radio",name:r})),o.push(s._createElement("label",i,{"for":t+n,title:e,name:n})),o},n.prototype._createImageRadioButton=function(e,t,n,r,i){var s=this,o=[];return o.push(s._createElement("input",{id:t+r,type:"radio",name:i})),o.push(s._createElement("label",{"for":t+r,title:e,name:r,"class":n})),o},n.prototype._createImageCheckButton=function(e,t,n,r){var i=this,s=[];return s.push(i._createElement("input",{id:t+r,type:"checkbox"})),s.push(i._createElement("label",{"for":t+r,title:e,name:r,"class":n})),s},n.prototype._createRibbonList=function(){return this._createSpan(Qt)},n.prototype._createDropdownButton=function(e,n,r,i,s){var o=this,u=o._createElement("div",{title:e,"class":Jt}),a=o._createElement("ul");return u.add(o._createTextButton(e,n,r)),u.add(a),t.each(i,function(e,r){var i=o._createElement("li"),u=o._createTextRadioButton(r.tip,s,r.name,n,r.text);t.each(u,function(e,t){i.add(t)}),a.add(i)}),u},n.prototype._createSplitButton=function(e,n,r,i,s){var o=this,u=o._createElement("div",{title:e,"class":Kt}),a=o._createElement("ul");return u.add(o._createBigButton(e,n,r,i)),u.add(o._createElement("button",{"class":$t})),u.add(a),t.each(s,function(e,t){var n=o._createElement("li");n.add(o._createButton(t.tip,t.css,t.name,t.text)),a.add(n)}),u},n.prototype._createButtonByCommand=function(e){var t=this,n,r=xs[e],i;if(!r)return;i=r.name;switch(i){case Wt:case S:case x:case T:case N:case C:case k:case L:case A:case O:case M:case _:case D:case P:case H:case B:case j:case F:case I:case q:case st:case ot:case ut:case at:case gt:case yt:case bt:case St:case xt:case Tt:case Lt:case mt:case Q:case G:case wt:case Et:case Ct:case kt:case it:case Dt:case Xt:case ft:case Nt:n=t._createButton(r.tip,r.css,i);break;case At:case Ot:n=t._createButton(r.tip,r.css,i,r.text);break;case X:case nt:case rt:case Y:case Z:case tt:case et:n=t._createImageCheckButton(r.tip,t.id_prefix,r.css,i);break;case pt:case dt:case vt:case R:case U:case z:case W:case J:case K:case V:case $:n=t._createImageRadioButton(r.tip,t.id_prefix,r.css,i,r.grpname);break;case lt:n=t._createSplitButton("Table",An,lt,"Table",[{tip:"Insert Table",css:On,name:ct,text:"Insert"},{tip:"Edit Table",css:Mn,name:ht,text:"Edit"}]);break;case Mt:t.options.mode==="ribbon"?n=t._createBigButton(r.tip,r.css,i,r.text):n=t._createButton(r.tip,Yt,i);break;case Pt:t.options.mode==="ribbon"?n=t._createBigButton(r.tip,r.css,i,r.text):n=t._createButton(r.tip,nr,i);break;case Ut:n=t._createDropdownButton("Font Name",Ut,"Font Name",[{tip:"Arial",name:"fn1",text:"Arial"},{tip:"Courier New",name:"fn2",text:"Courier New"},{tip:"Garamond",name:"fn3",text:"Garamond"},{tip:"Tahoma",name:"fn4",text:"Tahoma"},{tip:"Times New Roman",name:"fn5",text:"Times New Roman"},{tip:"Verdana",name:"fn6",text:"Verdana"},{tip:"Wingdings",name:"fn7",text:"Wingdings"}],t.id_prefix);break;case zt:n=t._createDropdownButton("Font Size",zt,"Font Size",[{tip:"VerySmall",name:"xx-small",text:"VerySmall"},{tip:"Smaller",name:"x-small",text:"Smaller"},{tip:"Small",name:"small",text:"Small"},{tip:"Medium",name:"medium",text:"Medium"},{tip:"Large",name:"large",text:"Large"},{tip:"Larger",name:"x-large",text:"Larger"},{tip:"VeryLarge",name:"xx-large",text:"VeryLarge"}],t.id_prefix);break;case _t:}return n},n.prototype._createActionGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(e._createButtonByCommand("Save")),t.add(n),n.add(e._createButtonByCommand("Undo")),n.add(e._createButtonByCommand("Redo")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Preview")),n.add(e._createButtonByCommand("Cleanup")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Cut")),n.add(e._createButtonByCommand("Copy")),n.add(e._createButtonByCommand("Paste")),n.add(e._createButtonByCommand("SelectAll")),t.add(e._createElement("div","Actions")),t},n.prototype._createFontGroup=function(){var e=this,n=e._createElement("li"),r=e._createRibbonList();return n.add(e._createButtonByCommand("FontName")),n.add(e._createButtonByCommand("FontSize")),n.add(r),r.add(e._createButtonByCommand("BackColor")),r.add(e._createButtonByCommand("ForeColor")),r=e._createRibbonList(),n.add(r),t.each(e._createButtonByCommand("Bold"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("Italic"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("UnderLine"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("StrikeThrough"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("SubScript"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("SuperScript"),function(e,t){r.add(t)}),r=e._createRibbonList(),n.add(r),r.add(e._createButtonByCommand("Template")),r=e._createRibbonList(),n.add(r),r.add(e._createButtonByCommand("RemoveFormat")),n.add(e._createElement("div","Font")),n},n.prototype._createParaGroup=function(){var e=this,n=e._createElement("li"),r=e._createRibbonList();return n.add(r),t.each(e._createButtonByCommand("JustifyLeft"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("JustifyCenter"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("JustifyRight"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("JustifyFull"),function(e,t){r.add(t)}),r=e._createRibbonList(),n.add(r),t.each(e._createButtonByCommand("Border"),function(e,t){r.add(t)}),r=e._createRibbonList(),n.add(r),t.each(e._createButtonByCommand("NumberedList"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("BulletedList"),function(e,t){r.add(t)}),r=e._createRibbonList(),n.add(r),t.each(e._createButtonByCommand("Outdent"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("Indent"),function(e,t){r.add(t)}),n.add(e._createElement("div","Paragraph")),n},n.prototype._createReviewGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("Inspect")),t.add(e._createButtonByCommand("Find")),t.add(e._createElement("div","Review")),t},n.prototype._createTablesGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(e._createButtonByCommand("Table")),t.add(n),n.add(e._createButtonByCommand("InsertColumn")),n.add(e._createButtonByCommand("InsertRow")),n.add(e._createButtonByCommand("InsertCell")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("SplitCell")),n.add(e._createButtonByCommand("MergeCell")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("DeleteColumn")),n.add(e._createButtonByCommand("DeleteRow")),n.add(e._createButtonByCommand("DeleteCell")),t.add(e._createElement("div","Tables")),t},n.prototype._createBreaksGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("InsertBreak")),t.add(e._createButtonByCommand("InsertParagraph")),t.add(e._createButtonByCommand("InsertPrint")),t.add(e._createButtonByCommand("InsertHR")),t.add(e._createElement("div","Breaks")),t},n.prototype._createFormsGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(n),n.add(e._createButtonByCommand("Form")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("TextArea")),n.add(e._createButtonByCommand("TextBox")),n.add(e._createButtonByCommand("PasswordField")),n.add(e._createButtonByCommand("HiddenField")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Image")),n.add(e._createButtonByCommand("Button")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("List")),n.add(e._createButtonByCommand("DropDownList")),n.add(e._createButtonByCommand("Radio")),n.add(e._createButtonByCommand("CheckBox")),t.add(e._createElement("div","Forms")),t},n.prototype._createSpecialGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("Link")),t.add(e._createButtonByCommand("InsertImage")),t.add(e._createButtonByCommand("Media")),t.add(e._createButtonByCommand("InsertSpecialChar")),t.add(e._createButtonByCommand("InsertDate")),t.add(e._createElement("div","Special")),t},n.prototype._getDefaultRibbonMarkup=function(){var e=this,t=e._createElement("div"),n=e._createElement("ul"),r=e._createElement("li"),i=e._createElement("li"),s=e._createElement("div",{id:e.id_prefix+"format"}),o=e._createElement("div",{id:e.id_prefix+"insert"}),u=e._createElement("ul"),a=e._createElement("ul");return t.add(n),t.add(s),t.add(o),n.add(r),n.add(i),r.add(e._createElement("a","Format",{href:"#"+e.id_prefix+"format"})),i.add(e._createElement("a","Insert",{href:"#"+e.id_prefix+"insert"})),s.add(u),u.add(e._createActionGroup()),u.add(e._createFontGroup()),u.add(e._createParaGroup()),u.add(e._createReviewGroup()),o.add(a),a.add(e._createTablesGroup()),a.add(e._createBreaksGroup()),a.add(e._createFormsGroup()),a.add(e._createSpecialGroup()),t.render()},n.prototype._getRibbonModesMarkup=function(){var e=this,n=e._createDiv(fr),r=e._createRibbonList(),i=e.element.find(".wijeditor-footer"),s,o,u,a,f;return i.length>0&&(s=t(i.find("."+lr)),s.length>0&&(xs.Wysiwyg.tip=s.attr("title")||xs.Wysiwyg.tip),o=t(i.find("."+hr)),o.length>0&&(xs.Split.tip=o.attr("title")||xs.Split.tip),u=t(i.find("."+cr)),u.length>0&&(xs.Code.tip=u.attr("title")||xs.Code.tip),a=t(i.find("."+pr)),s.length>0&&(xs.Wordwrap.tip=a.attr("title")||xs.Wordwrap.tip),f=t(i.find("."+dr)),s.length>0&&(xs.FullScreen.tip=f.attr("title")||xs.FullScreen.tip),i.remove()),n.add(r),t.each(e._createButtonByCommand("Wysiwyg"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("Code"),function(e,t){r.add(t)}),t.each(e._createButtonByCommand("Split"),function(e,t){r.add(t)}),n.add(e._createButtonByCommand("Wordwrap")),n.add(e._createButtonByCommand("FullScreen")),n.render()},n.prototype._getSimpleToolBar=function(e){var n=this,r,i=n._createDiv("");return t.each(e,function(e,s){r=n._createButtonByCommand(s),r&&(t.inArray(s,ws)!==-1?t.each(r,function(e,t){i.add(t)}):i.add(r))}),i.render()},n.prototype._editorify=function(){var e=this,n=e.element,r=n.width(),i=n.height(),s=e.options,o=s.mode,u,a,f,l,c,h,p;e._oriStyle=n.attr("style"),e._oriContent=n.html(),e._oriEleWidth=r,e._oriEleHeight=i,n.is("textarea")?(o==="ribbon"?e.$ribbon=t(e._getDefaultRibbonMarkup()):o==="bbcode"?e.$ribbon=t(e._getSimpleToolBar(Ss)):s.simpleModeCommands&&s.simpleModeCommands.length!==0?(f=t.grep(s.simpleModeCommands,function(e,t){return e!=="Table"},undefined),e.$ribbon=t(e._getSimpleToolBar(f))):e.$ribbon=t(e._getSimpleToolBar(Es)),s.text&&n.val(s.text),e.sourceView=n,e.editor=n.wrap("<div></div>").parent(),e.editor.width(r).height(i)):(e.editor=n,e.$ribbon=n.children(":eq(0)"),h=n.children(":eq(1)"),h.is("textarea")?(s.text&&h.val(s.text),e.sourceView=h):(s.text?p=s.text:p=h.html(),h.remove(),e.sourceView=t("<textarea></textarea>").val(p))),u=t("<div class='"+mr+"'></div>"),e.dialog=t("<div class ='"+vr+"'></div>"),e.subDialog=t("<div class ='"+vr+"'></div>"),e.editor.addClass(vr).append(u).append(e.dialog).append(e.subDialog),e._createMenuMarkUp(e,s),e.$ribbon.wrap("<a href='javascript:void(null)'></a>").parent().appendTo("<div class='"+gr+" ui-widget-header ui-helper-clearfix ui-corner-top'></div>").parent().appendTo(u),a=t("<div class='"+yr+"'></div>").appendTo(u),e.designView=t("<iframe frameborder='0'></iframe>"),e.designView.wrap("<div></div>").parent().appendTo(a),e.sourceView.wrap("<div></div>").parent().appendTo(a),l=[e.$ribbon],e.$modes=t(e._getRibbonModesMarkup()),s.showFooter&&(c=t("<div class='"+br+" "+"ui-widget ui-widget-content ui-state-default'></div>"),u.append(c),c.append("<div class='"+wr+"'></div>"),e.$modes.appendTo(c),l.push(e.$modes)),t.each(l,function(t,n){n.wijribbon({click:function(t,n){e._ribbonCommand(n.commandName,n.name),e._trigger("commandButtonClick",t,n)}})})},n.prototype._createMenuMarkUp=function(e,n){n.customContextMenu&&!t.browser.webkit&&(e.contextMenu=t("<ul><li _c1buttoncmd='cut'><a>"+this.localizeString("contextMenuCut","Cut")+"</a></li>"+"<li _c1buttoncmd='copy'><a>"+this.localizeString("contextMenuCopy","Copy")+"</a></li>"+"<li _c1buttoncmd='paste'><a>"+this.localizeString("contextMenuPaste","Paste")+"</a></li></ul>"),t("<a href='#'></a>").append(e.contextMenu).appendTo(e.editor))},n.prototype._handleDisabledOption=function(e,n){var r=this;e?(r.disabledDiv||(r.disabledDiv=r._createDisabledDiv(n)),t("body").focus(),r.disabledDiv.appendTo(r.editor)):r.disabledDiv&&(r.disabledDiv.remove(),r.disabledDiv=null)},n.prototype._createDisabledDiv=function(e){var n=this,r=e?e:n.element,i=r.outerWidth(),s=r.outerHeight();return t("<div></div>").addClass("ui-state-disabled").css({"z-index":"99999",position:"relative","background-color":"lightgray",width:i,height:s,left:0,top:-s})},n.prototype._initElements=function(){var e=this,t=e.options,n=e.element.height()-e._getHeader().outerHeight(!0)-e._getFooter().outerHeight(!0),r={};e._getContent().height(n).wijsplitter({showExpander:!1,orientation:"horizontal",panel1:{scrollBars:"none",collapsed:!1},panel2:{scrollBars:"none",collapsed:!0}}),e.sourceView.css("width","").css("height",""),e._addHandlerToDesignView(),e._addDefaultFontStyleToDesignView(),e._createWijMenu(),(!t.showPathSelector||e.options.mode==="bbcode")&&e._getPathSelector().hide(),e._ribbonCommand(t.editorMode),t.fullScreenMode&&e._setFullScreen(t.fullScreenMode),r[bt]=!0,r[yt]=!0,e.$ribbon.wijribbon(b,r),e._handleWinDocumentKeyDown()},n.prototype._handleWinDocumentKeyDown=function(){var e=this;t(document).keydown(function(t){if(e.options.disabled)return;switch(t.keyCode){case 27:e._escActionAssociated()}})},n.prototype._setOption=function(e,n){var r=this,i=r.options,s=i.mode,o=r.$ribbon.parent(),u=i.customContextMenu;t.Widget.prototype._setOption.apply(r,arguments);if(e==="fullScreenMode")i.fullScreenMode=n,r._setFullScreen(n);else if(e==="showPathSelector")i.showPathSelector=n,n?r._getPathSelector().show():r._getPathSelector().hide();else if(e==="editorMode")i.editorMode=n,r._ribbonCommand(n);else if(e==="fullScreenContainerSelector")i.fullScreenContainerSelector=n,r.options.fullScreenMode&&r._setFullScreen(!0);else if(e==="disabled")r._handleDisabledOption(n,r.editor);else if(e==="showFooter")n?t("."+br).is(":visible")||t("."+br).show():t("."+br).is(":visible")&&t("."+br).hide();else if(e==="commandButtonClick")i.commandButtonClick=n;else if(e==="text")i.text=n,r.setText(n);else if(e==="customContextMenu"){if(u===n)return;n?(r.contextMenu||r._createMenuMarkUp(r,i),r._createWijMenu()):(r.contextMenu[r._contextMenuWidgetName()]("destroy").remove(),r.contextMenu=undefined)}else e==="mode"&&n!==s&&(r.$ribbon.wijribbon("destroy"),r.$ribbon.remove(),n==="ribbon"?r.$ribbon=t(r._getDefaultRibbonMarkup()):n==="bbcode"?r.$ribbon=t(r._getSimpleToolBar(Ss)):r.$ribbon=t(r._getSimpleToolBar(Es)),o.append(r.$ribbon),r.$ribbon.wijribbon({click:function(e,t){r._ribbonCommand(t.commandName,t.name),r._trigger("commandButtonClick",e,t)}}),r._ribbonCommand(i.editorMode))},n.prototype._getHeader=function(){return t("."+gr,this.editor)},n.prototype._getContent=function(){return t("."+yr,this.editor)},n.prototype._getFooter=function(){return t("."+br,this.editor)},n.prototype._getPathSelector=function(){return t("."+wr,this.editor)},n.prototype._getModes=function(){return t("."+fr,this.editor)},n.prototype._getDesignView=function(){return this.designView},n.prototype._getDesignViewWindow=function(){var e=this.designView;return e&&e.length>0?e[0].contentWindow:null},n.prototype._getDesignViewDocument=function(){var e=this._getDesignViewWindow();return e?e.document:null},n.prototype._getDesignViewText=function(){var e=this._getDesignViewDocument();return e&&e.body&&e.body.innerHTML?e.body.innerHTML:""},n.prototype._setDesignViewText=function(e){var t=this,n=this._getDesignViewDocument();this.options.mode==="bbcode"&&(e=t._convertBBCodeToHtml(e)),n&&n.body&&(n.body.innerHTML=e),t.options.text=e},n.prototype._getDialog=function(){return this.dialog},n.prototype._getSubDialog=function(){return this.subDialog},n.prototype._initContentDocument=function(){var e=this,n=e.sourceView.val(),r=e._getDesignViewDocument();e.options.mode==="bbcode"&&(n=e._convertBBCodeToHtml(t.trim(n))),r.open(),r.write('<html style="width:100%;height:100%;'+(e.options.enabled?"cursor:text;":"")+'"><head><title></title><style id="__wijStyle" '+' type="text/css" >table,td,tr{border: 1px #acacac dashed;}'+"</style></head><body>"+n+"</body></html>"),r.close(),p||t("#__wijStyle",r).attr("disabled",!p),e.element.attr("accesskey")&&(t(r.body).attr("accesskey",e.element.attr("accesskey")),e.element.removeAttr("accesskey")),v=[],v.push(n),d=0},n.prototype._addHandlerToDesignView=function(){var e=this,t=e._getDesignViewWindow(),n=t.document;e._initContentDocument(),e._loadDesignView()},n.prototype._loadDesignView=function(){var e=this,n=e._getDesignViewWindow(),r=n.document;t.browser.mozilla?setTimeout(e._setDesignModeForFF,1e3,e):e._setContentEditable(r,!0),t.browser.msie&&e._setContentSpellCheck(r,!1),e.sourceView.bind("blur."+e.widgetName,function(t){e._onSourceViewBlur()}),e.sourceView.bind("keyup."+e.widgetName,function(t){e._onSourceViewBlur()}),t.browser.mozilla?t(r).bind("blur."+e.widgetName,function(t){e._onDesignViewBlur(t)}):t(n).blur(function(t){e._onDesignViewBlur(t)}),t(r).bind("mouseup."+e.widgetName,function(t){e._onDesignViewMouseUp(t)}).bind("keydown."+e.widgetName,function(t){e._onDesignViewKeyDown(t)}).bind("keyup."+e.widgetName,function(t){e._onDesignViewKeyUp(t),e._onDesignViewBlur(t)})},n.prototype._addDefaultFontStyleToDesignView=function(){var e=this,n=e.options,r=e._getDesignViewDocument(),i=n.defaultFontName,s=n.defaultFontSize,o='<style type="text/css"> body {';if(!(i!==""&&i!==null||s!==""&&s!==null))return;i!==""&&i!==null&&(o+="font-family: "+i+";"),n.defaultFontSize!==""&&n.defaultFontSize!==null&&(o+=" font-size: "+s+";"),o+="}</style>",window.setTimeout(function(){t(o).appendTo(t("head",r))},200),e._setFontStyleButtonState(i,Ut),e._setFontStyleButtonState(s,zt)},n.prototype._setFontStyleButtonState=function(e,n){var r="";if(!e||e===null)return;t.each(this.$ribbon.wijribbon("getDropdownList",n),function(t,n){if(n.toUpperCase()===e.toUpperCase())return r=t,!1}),this.$ribbon.wijribbon(w,r,!0,n)},n.prototype._setDesignModeForFF=function(e){var t=e._getDesignViewDocument();t&&(t.designMode="on")},n.prototype.destroy=function(){var e=this;e.element.html(e._oriContent),e.element.removeAttr("tabindex"),e._oriStyle===undefined?e.element.removeAttr("style"):e.element.attr("style",e._oriStyle),e.element.insertBefore(e.editor),e.element.unbind("."+e.widgetName),e.editor.remove(),t.Widget.prototype.destroy.call(e)},n.prototype.showEditorDialog=function(e){switch(e){case ct:case it:case Dt:case Ot:case At:case kt:case Ct:case Et:case Pt:case Q:case G:case Xt:this._ribbonCommand(e);break;default:r("Cannot find the dialog with command name '"+e+"'!")}},n.prototype.executeEditorAction=function(e,t){this._ribbonCommand(e,t)},n.prototype._isFontSizeCustomized=function(){if(c!==null)return c;var e=this.$ribbon.wijribbon("getDropdownList",zt),n=[Ht,Bt,jt,Ft,It,qt,Rt];return c=!1,t.each(e,function(e,r){if(t.inArray(e,n)===-1)return c=!0,!1}),c},n.prototype._fontSizeCommand=function(e){var n=this,r=n._getDesignViewDocument(),i,s=4,u="font-size",a=[];n._getDesignViewWindow().getSelection&&(i=n._getDesignViewWindow().getSelection());switch(e){case Ht:s=1;break;case Bt:s=2;break;case jt:s=3;break;case Ft:s=4;break;case It:s=5;break;case qt:s=6;break;case Rt:s=7}n._isFontSizeCustomized()?t.browser.msie?n._formatFontSpan(r,u,e):(r.execCommand("FontSize",!1,s),t.each(t("font[size]",r),function(r,i){a.push(n._replaceFontWithSpan(t(i),"size",u,e))}),n._setSelection(a)):t.browser.msie&&o(t.browser.version)>=9?i&&i.rangeCount>0&&r.execCommand("FontSize",!1,s):r.execCommand("FontSize",!1,s),n.options.mode==="bbcode"&&!t.browser.msie&&n._convertFontStyleToStandTag(),n._addtoUndoBuffer()},n.prototype._fontNameCommand=function(e){var n=this,r=n._getDesignViewDocument(),i,s=n.$ribbon.wijribbon("getDropdownList",Ut),u;n._getDesignViewWindow().getSelection&&(i=n._getDesignViewWindow().getSelection()),t.each(s,function(t,n){if(e===t)return u=n,!1}),t.browser.msie&&o(t.browser.version)>=9?i&&i.rangeCount>0&&r.execCommand("FontName",!1,u):r.execCommand("FontName",!1,u),n._isFontSizeCustomized()&&t.browser.msie&&n._formatFontSpan(r,"font-family",u),n._addtoUndoBuffer()},n.prototype._formatFontSpan=function(e,n,r){var i=this,s=r,o="fontFamily",u=[];n!=="font-family"&&(s="c1-temp",o="fontSize"),e.execCommand("FontName",!1,s),t.each(t("font[face='"+s+"']",e),function(e,s){var a=i._replaceFontWithSpan(t(s),"face",n,r),f,l;u.push(a),f=t("span."+vs,a);for(l=f.length-1;l>=0;l--)i._removeSpecifiedStyleSpan(t(f[l]),o,n);t.each(a,function(e,r){t.each(t(r).parents("span."+vs),function(e,s){var u=t(s);if(u.children().length>1)return!1;u.text()===t(r).text()&&i._removeSpecifiedStyleSpan(u,o,n)})})}),i._setSelection(u)},n.prototype._setSelection=function(e,n,r){var i=this._getDesignViewWindow(),s=i.document,o,u,a,f,l=0;try{t.browser.msie?(o=s.selection.createRange(),e?(t.each(e,function(e,t){l+=t.text().length}),o.moveToElementText(e[0][0]),o.collapse(!0),o.moveEnd("character",l)):(o.moveStart("textedit",-1),o.collapse(!0),o.moveStart("character",n),o.moveEnd("character",r)),o.select()):(f=i.getSelection(),o=s.createRange(),u=e[0][0],a=e[e.length-1][0],o.setStart(u,0),o.setEnd(a,a.childNodes.length),f.removeAllRanges(),f.addRange(o))}catch(c){}},n.prototype._replaceFontWithSpan=function(e,t,n,r){e.wrap("<span class = '"+vs+"' style='"+n+":"+r+"'></span>");var i=e.parent();return e.removeAttr(t),/<font\s*>/ig.test(i.html())&&(i.html(e.html()),e.remove()),i},n.prototype._removeSpecifiedStyleSpan=function(e,n,r){var i,s=!0;e[0].style[n]!==""&&e.css(r,""),i=e.attr("style"),i&&t.each(i.split(";"),function(e,n){var i=t.trim(n).toLowerCase();if(i!==""&&i.indexOf(r)!==-1)return s=!1,!1}),s&&e.replaceWith(e.html())},n.prototype._removeFormat=function(){var e=this,n=e._getDesignViewDocument(),r={};n.execCommand(st,!1,null),e._isFontSizeCustomized()&&t.browser.msie&&e._removeFormatForIE(n),e._addtoUndoBuffer(),r[Y]=!1,r[Z]=!1,r[et]=!1,r[tt]=!1,r[nt]=!1,r[rt]=!1,r[V]=!1,r[$]=!1,r[R]=!1,r[U]=!1,r[z]=!1,r[W]=!1,e.$ribbon.wijribbon(E,r)},n.prototype._removeFormatForIE=function(e){var n=e.selection.createRange(),r=n.htmlText,i=n.text,s=0,o=t(n.parentElement()),u=t(e.body),a="",f="",l="__c1temp",c="c1-temp",h="<span class='"+c+"'>"+l+"</span>",p,d,v,m,g,y;o.addClass("c1-app-parent"),n.pasteHTML(h),s=u.text().indexOf(l),p=t("span."+c,e),d=p,p.parentsUntil("body").each(function(e){if(t(this).is(".c1-app-parent"))return!1;d=t(this)}),p.html(r),v=t("span."+vs,p);for(g=v.length-1;g>=0;g--)m=t(v[g]),m.replaceWith(m.html());d.is("."+c)||d.after(p),t.each(d.parents("span."+vs),function(e,n){a+="</span>",f="<span class='"+vs+"' style = '"+t(n).attr("style")+"'>"+f}),r=p.html(),p.replaceWith(l),y=u.html().split(l),u.html(y[0]+a+r+f+y[1]),v=t("span."+vs,e);for(g=v.length-1;g>=0;g--)m=t(v[g]),m.text()===""&&m.replaceWith(m.html());t(".c1-app-parent",e).removeClass("c1-app-parent"),this._setSelection(null,s,i.length)},n.prototype._toggleFullScreen=function(){var e=this,t=e.options;t.fullScreenMode=!t.fullScreenMode,e._setFullScreen(t.fullScreenMode)},n.prototype._setFullScreen=function(e){var n=this,r=1,s=n._getHeader(),l=n._getFooter(),c=n._getContent(),h=n.options.fullScreenContainerSelector,p=t(h),d=n._getDesignViewText(),v,m,g;e?(p.length===0&&(p=t(i),h="body",n._oriDocOverFlow=t(document.documentElement).css("overflow"),t(document.documentElement).css({overflow:"hidden"}),t.browser.mozilla||window.scrollTo(0,0),t(i).bind("resize.wijeditor",function(){n._fullscreenOnWindowResize()})),v=p.width(),m=p.height()-2*r,u=n.editor.width(),a=n.editor.height(),f||(f=n.editor.parent()),n._replacedDiv||(n._replacedDiv=t("<div />")),n.editor.after(n._replacedDiv),t(h).append(n.editor),n.editor.css({width:v,height:m,position:""}).addClass(Er),n.$ribbon.wijribbon("updateRibbonSize")):(n._replacedDiv.after(n.editor).remove(),n.editor.css({width:u,height:a,position:"static"}).removeClass(Er),n.options.fullScreenContainerSelector||t(document.documentElement).css({overflow:n._oriDocOverFlow}),t(i).unbind("resize.wijeditor"),n.$ribbon.wijribbon("updateRibbonSize")),g=n.editor.height()-s.outerHeight(!0)-l.outerHeight(!0),c.height(g).wijsplitter("refresh"),n._addHandlerToDesignView(),n._addDefaultFontStyleToDesignView(),n._createWijMenu(),t.browser.msie&&window.setTimeout(function(){n.options.mode==="bbcode"&&(d=n._convertHtmlToBBCode(t.trim(d))),n._setDesignViewText(d),o(t.browser.version)>=9&&n.sourceView.val(d)},40)},n.prototype._createWijMenu=function(){var e=this,n=e._getDesignViewDocument();e.contextMenu&&e.contextMenu[e._contextMenuWidgetName()]({orientation:"vertical",trigger:e.designView,triggerEvent:"rtclick",showing:function(r,i){t.browser.msie&&(m=n.selection.createRange());var s=e.designView.offset(),o=t(t(e.designView)[0].contentWindow).scrollLeft(),u=t(t(e.designView)[0].contentWindow).scrollTop(),a=s.left+2-o,f=s.top-u;i.options.position={my:"left+"+a+" "+"top+"+f,at:"right top",of:r,collision:"none none"}},animation:{animated:"fade"},select:function(t,n){e._setIESelection(),e._contextMenuItemClick(t,n),e.contextMenu[e._contextMenuWidgetName()]("deactivate")}})},n.prototype._fullscreenOnWindowResize=function(){var e=this,n=e._getHeader(),r=e._getFooter(),i=e._getContent(),s,o=t(window).width(),u=t(window).height();e.editor.css({width:o,height:u}),s=e.editor.height()-n.height()-r.height(),i.height(s).wijsplitter("refresh")},n.prototype._saveText=function(e){},n.prototype._doSpellCheck=function(){},n.prototype._ribbonCommand=function(e,n){var r=this,i=r._getDesignViewDocument(),s=r._getContent(),o,u,a;if(n===Ut){r._fontNameCommand(e),r._onDesignViewBlur(null);return}if(n===zt){r._fontSizeCommand(e),r._onDesignViewBlur(null);return}r.editor.hasClass("ui-helper-hidden-accessible")||r._setIEFocus();switch(e){case Wt:t.browser.msie?(i.execCommand("FormatBlock",!1,"<ADDRESS>"),a=i.selection.createRange(),a=t(a.parentElement()).closest("address"),a.length&&(a.replaceWith("<blockquote>"+a.html()+"</blockquote>"),i.body.innerHTML=i.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<BLOCKQUOTE>/gi,"<BLOCKQUOTE>"),i.body.innerHTML=i.body.innerHTML.replace(/<\/BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,"</BLOCKQUOTE>"),i.body.innerHTML=i.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,""))):i.execCommand("FormatBlock",!1,"<BLOCKQUOTE>"),r._addtoUndoBuffer();break;case S:o=r._generateUniqueName("form"),r.insertHTML('<form id="'+o+'" name="'+o+'" method="post">'+o+"</form>");break;case x:o=r._generateUniqueName("image"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="image"'+' value="'+o+'"/>');break;case T:o=r._generateUniqueName("textarea"),r.insertHTML('<textarea id="'+o+'" name="'+o+'" rows="4" cols="48"></textarea>');break;case N:o=r._generateUniqueName("button"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="button"'+' value="'+o+'"/>');break;case C:o=r._generateUniqueName("textbox"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="text"'+' value="'+o+'"/>');break;case k:o=r._generateUniqueName("list"),r.insertHTML('<select id="'+o+'" name="'+o+'" style="width: 120px" size="8"></select>');break;case L:o=r._generateUniqueName("password"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="password" value="'+o+'"/>');break;case A:o=r._generateUniqueName("dropdown"),r.insertHTML('<select id="'+o+'" name="'+o+'"></select>');break;case O:o=r._generateUniqueName("hidden"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="hidden" value="'+o+'" />');break;case M:o=r._generateUniqueName("radiobox"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="radio"'+' value="'+o+'">'+'<label for="'+o+'">'+o+"</label></input>");break;case _:o=r._generateUniqueName("checkbox"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="checkbox"'+' value="'+o+'">'+'<label for="'+o+'">'+o+"</label></input>");break;case D:case P:case H:case B:case j:case F:case I:case q:r._tableAction(e);break;case X:r._toggleTableBorders();break;case nt:try{i.queryCommandState(rt)&&(i.execCommand(rt,!1,null),r.$ribbon.wijribbon(w,rt,!1))}catch(f){}i.execCommand(nt,!1,null),r._addtoUndoBuffer();break;case rt:try{i.queryCommandState(nt)&&(i.execCommand(nt,!1,null),r.$ribbon.wijribbon(w,nt,!1))}catch(l){}i.execCommand(rt,!1,null),r._addtoUndoBuffer();break;case st:r._removeFormat();break;case ot:r.insertHTML("<br/>");break;case ut:u=r._getSelectedContent();if(!u||u==="")u="&nbsp;";r.insertHTML("<p>"+u+"</p>");break;case at:r.insertHTML('<div title="Print Page Break" style="font-size:1px;page-break-before:always;vertical-align:middle;height:1px;background-color:#c0c0c0">&nbsp;</div>');break;case gt:r._toggleFullScreen();break;case yt:r._undoAction();break;case bt:r._redoAction();break;case St:r._execCut();break;case xt:r._execCopy();break;case Tt:r._execPaste();break;case Lt:r.insertDateAndTime();break;case pt:r.$modes.data("wijmoWijribbon")&&r.$modes.wijribbon(y,mt,!0).wijribbon(w,pt,!0),r.$ribbon.wijribbon("option","disabled",!1),s.wijsplitter("option","panel2",{collapsed:!0});break;case dt:r.$modes.data("wijmoWijribbon")&&r.$modes.wijribbon(y,mt,!0).wijribbon(w,dt,!0),r.$ribbon.wijribbon("option","disabled",!1),s.wijsplitter("option",{panel1:{collapsed:!1},panel2:{collapsed:!1}});break;case vt:r.$modes.data("wijmoWijribbon")&&r.$modes.wijribbon(y,mt,!1).wijribbon(w,vt,!0),r.$ribbon.wijribbon("option","disabled",!0),s.wijsplitter("option","panel1",{collapsed:!0}),t.browser.msie&&r.sourceView.focus();break;case mt:s.wijsplitter("option","panel1").collapsed&&r._toggleWordWrap();break;case Q:r._saveSelectionForIE(),r._createDialog(this.localizeString("backColorDialogTitle","Set BackColor"),r._getDialogRes_BackColor(),r.initBackColorDialog);break;case G:r._saveSelectionForIE(),r._createDialog(this.localizeString("foreColorDialogTitle","Set ForeColor"),r._getDialogRes_ForeColor(),r.initForeColorDialog);break;case ct:r._saveSelectionForIE(),r._createDialog(this.localizeString("insertTableDialogTitle","Insert Table"),r._getDialogRes_Table(),r.initInsertTableDialog);break;case ht:r._getEditableTable()&&r._createDialog(this.localizeString("editTableDialogTitle","Edit Table"),r._getDialogRes_Table(),r.initEditTableDialog);break;case wt:r._createDialog(this.localizeString("previewDialogPreview","Preview"),r._getDialogRes_Preview(),r.initPreviewDialog);break;case Et:r._createDialog(this.localizeString("cleanUpDialogTitle","Clean up source HTML document"),r._getDialogRes_CleanUp(),r.initCleanUpDialog);break;case Ct:r._saveSelectionForIE(),r._createDialog(this.localizeString("mediaDialogTitle","Insert media"),r._getDialogRes_Media(),r.initMediaDialog);break;case kt:r._saveSelectionForIE(),r._createDialog(this.localizeString("specialCharacterDialogTitle","Insert special character"),r._getDialogRes_SpecialCharacter(),r.initSpecialCharacterDialog);break;case At:r._createDialog(this.localizeString("findAndReplaceTitle","Find and replace"),r._getDialogRes_FindAndReplace(),r.initFindDialog);break;case Ot:g=r._getSelectedElement(),r._createDialog(this.localizeString("tagInspectorDialogTitle","Tag Inspector"),r._getDialogRes_TagInspector(),r.initTagInspectorDialog);break;case it:r._saveSelectionForIE(),r._createDialog(this.localizeString("templateDialogApplyTemplate","Apply Template"),r._getDialogRes_Template(),r.initTemplateDialog);break;case Dt:r._saveSelectionForIE(),r._createDialog(this.localizeString("imageEditorDialogImageBrowser","Image Browser"),r._getDialogRes_ImageBrowser(),r.initImageBrowserDialog);break;case Pt:r._saveSelectionForIE(),r._createDialog(this.localizeString("hyperLinkDialogInserthyperLink","Insert hyperLink"),r._getDialogRes_Link(),r.initHyperLinkDialog);break;case Xt:r._saveSelectionForIE(),r._createDialog("Insert Code",r._getDialogRes_Code(),r.initInsertCodeDialog);break;case R:case U:case z:case W:case J:case K:case Y:case Z:case tt:case V:case $:case et:case ft:case Nt:i.execCommand(e,!1,null),r.options.mode==="bbcode"&&!t.browser.msie&&r._convertStyleToStandTag(),r._addtoUndoBuffer();break;case Mt:r._saveText();break;case _t:r._doSpellCheck()}r._onDesignViewBlur(null)},n.prototype._saveSelectionForIE=function(){var e=this._getDesignViewWindow(),n;t.browser.msie&&(n=e.document.selection,m=n.createRange())},n.prototype._createDialog=function(e,n,r){var i=this,s,u=i.dialog;u.html("").undelegate(i.widgetName).undelegate("."+i.widgetName).append(n),i.subDialog&&i.subDialog.html("").undelegate(i.widgetName).undelegate("."+i.widgetName),s={width:"auto",height:"auto",modal:!0,title:e,position:"center",resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},u.data("wijmoWijdialog")?(u.wijdialog("reset"),u.wijdialog("option",{width:"auto",height:"auto",title:e})):t.browser.msie&&o(t.browser.version)===6?window.setTimeout(function(){u.wijdialog(s)},0):u.wijdialog(s),i._adjustDialogLayoutForIE7(),r&&r.call(i),u.wijdialog("open")},n.prototype._adjustDialogLayoutForIE7=function(){var e=this.dialog;t.browser.msie&&/^7\.[0-9]+/.test(t.browser.version)&&e.wijdialog("option","width",e.parent().width())},n.prototype._contextMenuItemClick=function(e,t,n){var r=this,i=t.item.element.attr("_c1buttoncmd");switch(i){case St:r._execCut();break;case xt:r._execCopy();break;case Tt:r.focus(),r._execPaste()}},n.prototype._execCut=function(){var e=this,n=e._getDesignViewDocument();t.browser.safari?r(this.localizeString("errorMessageCutError","This function is not supported in current browser.  Plesse use (Ctrl + X).")):t.browser.msie?(n.execCommand("Cut",!1,null),e._addtoUndoBuffer()):(e._execCopy(),e._deleteSelectionContent(),e._addtoUndoBuffer())},n.prototype._execCopy=function(){var e=this,n=e._getDesignViewDocument();t.browser.safari?r(this.localizeString("errorMessageCopyError","This function is not supported in current browser. Plesse use (Ctrl + C).")):t.browser.msie?(n.execCommand("Copy",!1,null),e._addtoUndoBuffer()):e._copyToClipboard(e._getSelectedContent())},n.prototype._execPaste=function(){var e=this,n,i=e._getDesignViewDocument();if(t.browser.safari)r(this.localizeString("errorMessagePasteError","This function is not supported in current browser. Plesse use (Ctrl + V)."));else if(t.browser.msie)i.execCommand("Paste",!1,null),e._addtoUndoBuffer();else try{n=e._copyFromClipboard(),n&&n!==""&&e.insertHTML(n)}catch(s){}},n.prototype._getFontSizeCollection=function(){return{"10px":Ht,"13px":Bt,"16px":jt,"18px":Ft,"24px":It,"32px":qt,"48px":Rt,1:Ht,2:Bt,3:jt,4:Ft,5:It,6:qt,7:Rt}},n.prototype._updateButtonStates=function(e){var n=this,r=n._getDesignViewDocument(),i,s,o={},u=[Y,Z,et,tt,nt,rt,V,$,R,U,z,W],a,f=e.target,l=t(f);t.each(u,function(e,t){o[t]=r.queryCommandState(t)}),n.$ribbon.wijribbon(E,o),i=n._queryCommandValue(Ut)||"",t.each(n.$ribbon.wijribbon("getDropdownList",Ut),function(e,t){if(t.toUpperCase()===i.toUpperCase())return s=e,!1}),n.$ribbon.wijribbon(w,s,!0,Ut),n._isFontSizeCustomized()?(l.is("span")?s=f.style.fontSize:s="",s===""&&(a=l.parents("span."+vs),t.each(a,function(e,t){s=t.style.fontSize;if(s&&s!=="")return!1})),s===""&&(s=l.css("font-size"))):(i=n._queryCommandValue(zt)||"",i===""&&(i=l.css("font-size")),t.each(n._getFontSizeCollection(),function(e,t){if(e.toString()===i.toString())return s=t,!1})),n.$ribbon.wijribbon(w,s,!0,zt)},n.prototype._queryCommandValue=function(e){var t=this._getDesignViewDocument();try{if(!t.queryCommandEnabled(e))return null}catch(n){return null}try{return t.queryCommandValue(e)}catch(r){}return null},n.prototype._escActionAssociated=function(){var e=this,t=e._getDesignViewWindow();t.document.selection!==undefined&&t.document.selection.empty(),t.getSelection!==undefined&&t.getSelection().removeAllRanges(),e._hideAllDropdownsMenus()},n.prototype._hideAllDropdownsMenus=function(){var e=this;e.contextMenu&&e.contextMenu[e._contextMenuWidgetName()]("hideAllMenus"),e.$ribbon.wijribbon("hideDropdown",Ut).wijribbon("hideDropdown",zt).wijribbon("hideDropdown",lt)},n.prototype._onDesignViewKeyDown=function(e){var t=this,n;t._setSaveBtnEnabled();try{if(e.ctrlKey)n=String.fromCharCode(e.keyCode).toLowerCase();else switch(e.keyCode){case 27:t._escActionAssociated();break;case 13:case 46:t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1;break;default:t._continueSavingInputTextForUndo=!0}}catch(r){}},n.prototype._onDesignViewKeyUp=function(e){var t=this,n;(e.keyCode===37||e.keyCode===38||e.keyCode===39||e.keyCode===40||e.keyCode===33||e.keyCode===34||e.keyCode===35||e.keyCode===36)&&t._updateButtonStates(e);if(e.ctrlKey){n=String.fromCharCode(e.keyCode).toLowerCase();switch(n){case"y":t._redoAction(),e.preventDefault(),e.stopPropagation();break;case"z":t._undoAction(),e.preventDefault(),e.stopPropagation();break;case"x":case"v":t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1}}},n.prototype._onDesignViewMouseUp=function(e){var n=this,r;if(e.button===2)return;n._updateButtonStates(e),n._refreshPathSelector(),n._hideAllDropdownsMenus(),t(document).mouseup(undefined);if(t.browser.msie){r=t(e.target).closest("a");if(e.ctrlKey&&r.length>0)try{r.focus(),i.open(r[0].href,"_blank")}catch(s){}}},n.prototype._onDesignViewBlur=function(e){var n=this,r=n.options,i;i=n._getDesignViewText(),n._onTextChange(e),r.mode==="bbcode"&&(i=n._convertHtmlToBBCode(t.trim(i))),n.sourceView.val(i),r.text=i},n.prototype._onTextChange=function(e){var t=this;t._continueSavingInputTextForUndo&&(t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1),t._trigger("textChanged",e,{text:t.options.text})},n.prototype._onSourceViewBlur=function(){var e=this,t;t=e.sourceView.val(),e._setDesignViewText(t),e.options.text=t},n.prototype._convertBBCodeToHtml=function(e){return e?(e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/(?:\r\n|\n|\r)/g,"<br>"),e=e.replace(/\[EMAIL\]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$1</a>'),e=e.replace(/\[EMAIL\=([^\]]+)]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$2</a>'),e=e.replace(/\[URL\]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$1</a>'),e=e.replace(/\[URL\=([^\]]+)]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$2</a>'),e=e.replace(/\[B\]/gim,"<b>"),e=e.replace(/\[\/B\]/gim,"</b>"),e=e.replace(/\[I\]/gim,"<i>"),e=e.replace(/\[\/I\]/gim,"</i>"),e=e.replace(/\[S\]/gim,"<strike>"),e=e.replace(/\[\/S\]/gim,"</strike>"),e=e.replace(/\[U\]/gim,"<u>"),e=e.replace(/\[\/U\]/gim,"</u>"),e=e.replace(/\[IMG height=(.*?) width=(.*?)](.+?)\[\/IMG\]/gim,'<img height="$1" width = "$2" src="$3"/>'),e=e.replace(/\[BLOCK\]/gim,"<blockquote>"),e=e.replace(/\[\/BLOCK\]/gim,"</blockquote>"),e=e.replace(/\[LIST\=1\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ol><li>$1</li></ol>"),e=e.replace(/\[LIST\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ul><li>$1</li></ul>"),e=e.replace(/\[\*\]/gim,"</li><li>"),e=e.replace(/\[size=([^\]]*?)\]/gi,'<font size="$1">'),e=e.replace(/\[\/size\]/gim,"</font>"),e=e.replace(/\[color=([^\]]*?)\]/gi,'<font color="$1">'),e=e.replace(/\[\/color\]/gim,"</font>"),e):""},n.prototype._replaceComplexHtml=function(e){var n,r,i,s,o=t("<div/>").html(e);n=t("img",o),t.each(n,function(){i="[IMG height="+t(this).height()+" width="+t(this).width()+"]"+t(this).attr("src").toString()+"[/IMG]",t(this).replaceWith(i)}),r=t("font",o);for(s=r.length-1;s>=0;s--)t(r[s]).attr("color")&&t(t(r[s])).attr("size")?i="[Color="+t(t(r[s])).attr("color")+"]"+"[Size="+t(t(r[s])).attr("size")+"]"+t(t(r[s])).html()+"[/Size][/Color]":t(t(r[s])).attr("color")&&!t(t(r[s])).attr("size")?i="[Color="+t(t(r[s])).attr("color")+"] "+t(t(r[s])).html()+"[/Color]":t(t(r[s])).attr("size")&&!t(t(r[s])).attr("color")&&(i="[Size="+t(t(r[s])).attr("size")+"]"+t(t(r[s])).html()+"[/Size]"),t(t(r[s])).replaceWith(i);return o.html()},n.prototype._convertHtmlToBBCode=function(e){var t=this;if(e==="")return;return e=t._replaceComplexHtml(e),e=e.replace(/<br(?=[ \/>]).*?>/gim,"\r\n"),e=e.replace(/<a .*?href=(["'])(.+?)\1.*?>(.+?)<\/a>/gi,"[URL=$2]$3[/URL]"),e=e.replace(/<a .*?href=(["'])mailto:(.+?)\1.*?>(.+?)<\/a>/gi,"[EMAIL=$2]$3[/EMAIL]"),e=e.replace(/<(?:b|strong)>/gim,"[B]"),e=e.replace(/<\/(?:b|strong)>/gim,"[/B]"),e=e.replace(/<(?:i|em)>/gim,"[I]"),e=e.replace(/<\/(?:i|em)>/gim,"[/I]"),e=e.replace(/<(?:strike|s)>/gim,"[S]"),e=e.replace(/<\/(?:strike|s)>/gim,"[/S]"),e=e.replace(/<u>/gim,"[U]"),e=e.replace(/<\/u>/gim,"[/U]"),e=e.replace(/<blockquote.*?\>/gim,"[BLOCK]"),e=e.replace(/\s{0,}<\/blockquote>/gim,"[/BLOCK]"),e=e.replace(/(?:\r\n|\r|\n){0,1}<(?:ol)>[\s]*/gim,"[LIST=1]"),e=e.replace(/<\/(?:ol)>/gim,"[/LIST]"),e=e.replace(/(?:\r\n|\r|\n){0,1}\<(?:ul)>[\s]*/gim,"[LIST]"),e=e.replace(/<\/(?:ul)>/gim,"[/LIST]"),e=e.replace(/\s{0,}<li\s{0,1}.*?>([\s\S]*?)\n{0,}\s{0,}<\/li>/gim,"[*]$1"),e=e.replace(/&nbsp;/gi," "),e=e.replace(/(<[^>]+>)/gm,""),e},n.prototype._convertFontStyleToStandTag=function(){var e=this,n=e._getDesignViewDocument(),r=t(n.body),i,s,o=t("[style*='color: ']",r);o.length!==0&&(i=o,s="<font color='"+e._getWebColorFromRgb(o.css("color"))+"'></font>"),i&&t.each(i,function(e){t(this).is("span")?t(this).replaceWith(t(s).html(t(this).html())):t(this).is("font")&&t(this).attr("size")&&t(this).removeAttr("style").html(t(s).html())})},n.prototype._convertStyleToStandTag=function(){var e=this,n=e._getDesignViewDocument(),r=t(n.body),i,s,o,u=t("[style*='font-weight: bold;']",r),a=t("[style*='font-style: italic;']",r),f=t("[style*='text-decoration: line-through;']",r),l=t("[style*='text-decoration: underline;']",r);u.length!==0?(i=u,s="<b></b>",o="font-weight"):a.length!==0?(i=a,s="<i></i>",o="font-style"):f.length!==0?(i=f,s="<strike></strikes>",o="text-decoration"):l.length!==0&&(i=l,s="<u></u>",o="text-decoration"),i&&t.each(i,function(e){t(this).is("span")&&this.style.fontSize===""?t(this).replaceWith(t(s).html(t(this).html())):t(this).removeAttr("style").html(t(s).html())})},n.prototype._getWebColorFromRgb=function(e){var t=this,n;return e.indexOf("rgb(")===0&&(n=e.substring(4,e.length-1).split(","),e=t._convertToWebColor(o(n[0]),o(n[1]),o(n[2]))),e},n.prototype._updateList=function(e,n){var r;t("option",n).remove();for(r in e)e[r]&&n.append("<option>"+r+"</option>")},n.prototype._triggerEvent=function(e,t){var n=this,r=n.options[e];return r&&typeof r=="function"?r.call(n,t):r},n.prototype._closeDialog=function(){this.dialog.wijdialog("close")},n.prototype._onTemplateList=function(e){return this._triggerEvent("templateList",e)},n.prototype.updateTemplateList=function(e,n){var r=this,i=n||t("select",r.dialog);r._updateList(e,i),r._templateList=e},n.prototype.initTemplateDialog=function(){var e=this,n=e.dialog,r=t("select",n),i=e._onTemplateList();n.delegate("select","change."+e.widgetName,function(){e.templateListOnChanged()}).delegate("."+Zr,"click."+e.widgetName,function(){e.deleteTemplate()}).delegate("."+ei,"click."+e.widgetName,function(){e.saveTemplate()}).delegate(ms,"click."+e.widgetName,function(){e.applyTemplate()}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()});if(!i){i=e._templateList;if(!i)return}e.updateTemplateList(i,r)},n.prototype.templateListOnChanged=function(){var e=this,n=e.dialog,r=t("select",n).val(),i=t("iframe",n),s=e._templateList,o;if(!s)return;o=s[r],o.src&&i.attr("src",o.src+"?d="+(new Date).getMilliseconds().toString()),o.text&&i.length>0&&i[0].contentWindow.document.write(o.text),r&&(t("."+$r,n).html(r),t("."+Qr,n).val(r)),o.desc&&(t("."+Jr,n).html(o.desc),t("."+Gr,n).val(o.desc))},n.prototype._onSaveTemplate=function(e){this._triggerEvent("saveTemplate",e)},n.prototype.saveTemplate=function(){var e=this,n=e.dialog,i=t("."+Qr,n).val(),s=t("."+Gr,n).val(),o=e._templateList,u=this._getDesignViewText();if(t.trim(i)===""){r(this.localizeString("errorMessageTemplateNameError","Please input a template name!"));return}o||(e._templateList=[],o=e._templateList),o[i]||t("select",n).append("<option>"+i+"</option>"),o[i]={desc:s,text:u},e._onSaveTemplate({name:i,desc:s,text:u})},n.prototype._onDeleteTemplate=function(e){this._triggerEvent("deleteTemplate",e)},n.prototype.deleteTemplate=function(){var e=this,n=e.dialog,i=t("select",n),s=i.val(),o=e._templateList;if(t.trim(s)===""){r(this.localizeString("errorMessageTemplateFileError","Please select a template file."));return}t("option:selected",i).remove(),t("iframe",n).attr("src","about:blank"),t("."+$r,n).empty(),t("."+Qr,n).val(""),t("."+Jr,n).empty(),t("."+Gr,n).val(""),delete o[s],e._onDeleteTemplate(s)},n.prototype.applyTemplate=function(){var e=this,n=e.dialog,i=t("select",n),s=i.val(),o=t("iframe",n)[0],u=t("."+Qr,n).val(),a=o.contentWindow.document.body.innerHTML;if(t.trim(u)===""||t.trim(s)===""){r(this.localizeString("errorMessageValidTemplateFileError","Please select a valid template file."));return}e._setDesignViewText(a),e._addtoUndoBuffer(),e._setSaveBtnEnabled(),e._closeDialog()},n.prototype._onImageList=function(){var e=this,t=e.options.imageList;return t&&typeof t=="function"?t.call(e):t},n.prototype.updateImageList=function(e,n){var r=this,i=r.dialog,s=n||t("select",i),o=t("."+Or,i);r._updateList(e,s),r._imgList=e;if(!e){o.addClass(Fr);return}o.removeClass(Fr)},n.prototype.initImageBrowserDialog=function(){var e=this,n=e.dialog,r=e._onImageList();t("img",n).hide(),n.delegate("select","change."+e.widgetName,function(){e.imageListOnChanged()}).delegate(ms,"click."+e.widgetName,function(t){e.submitInsertImageDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()}),t("."+Dr+" input",n).bind("change."+e.widgetName,function(){e.imageUrlChanged(this)});if(!r){r=e._imgList;if(!r){t("."+Or,n).addClass(Fr);return}}e.updateImageList(r,t("select",n))},n.prototype.imageUrlChanged=function(e){var n=this,r=n.dialog;t("img",this.dialog).attr("src",t(e).val()+"?"+(new Date).getTime()).show().bind("load",function(){t("."+Hr+" input",r).val(t("img",r).width().toString()),t("."+Br+" input",r).val(t("img",r).height().toString())})},n.prototype.imageListOnChanged=function(){var e=this,n=e.dialog,r=t("select",n).val(),s=e._imgList,o;if(!s)return;o=s[r],t("img",n).attr("src",o).show(),t("."+Dr+" input",n).attr("value",o),i.setTimeout(function(){t("."+Hr+" input",n).val(t("img",n).width().toString()),t("."+Br+" input",n).val(t("img",n).height().toString())},200)},n.prototype.submitInsertImageDialog=function(){var e=this,n,i=e.dialog,s=t("."+Dr+" input",i).val(),o=t("."+Pr+" input",i).val(),u=t("."+Hr+" input",i).val(),a=t("."+Br+" input",i).val(),f=t("."+jr+" input",i).val();if(t.trim(s)===""){r(this.localizeString("errorMessageSelectImageError","Please select a image."));return}if(!e._isNumeric(u)){r(this.localizeString("errorMessageImageWidthError","Please input a number for 'Image width' textbox."));return}if(!e._isNumeric(a)){r(this.localizeString("errorMessageImageHeightError","Please input a number for 'Image height' textbox."));return}e.focus(),t.browser.msie?(n='<img src="'+s+'" alt="'+o+'" style="width:'+u+"px;height:"+a+"px",e.options.mode!=="bbcode"&&f!==null&&f!==undefined&&f.length>0&&(n+=";"+f)):(n='<img src="'+s+'" alt="'+o+'" width="'+u+'" height="'+a,e.options.mode!=="bbcode"&&(n+='" style="'+f)),n+='"/>',e.insertHTML(n),e._closeDialog()},n.prototype.initHyperLinkDialog=function(){var e=this,n=e.dialog,r=e.getLinkHrefField(),s=t("."+ci,n),o,u,a,f=t("."+ni+" input",n);n.delegate(ms,"click."+e.widgetName,function(t){e.submitHyperLinkDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+ii,"change."+e.widgetName,function(){e.anchorListOnChanged(this)}).delegate("."+ri+">div","click."+e.widgetName,function(){e.radioListOnChanged()}).delegate("."+hi+">div","click."+e.widgetName,function(){e.linkIconTypeOnChanged()}).delegate("."+ai+" input","change."+e.widgetName,function(){e.tempImg=t('<img src="'+t("."+ai+" input",n).val()+'">').appendTo("body"),i.setTimeout(function(){t("."+fi+" input",n).val(e.tempImg.width().toString()),t("."+li+" input",n).val(e.tempImg.height().toString()),e.tempImg.remove(),e.tempImg=undefined},200)});try{f.val(r),u=e._getLinkInnerHTML()}catch(l){}a=t(u),u&&u.substring(0,3)==="<img"?o=!0:o=!1,o?(s.show(),t("."+si+" input",n).hide(),t("."+ai+" input",n).val(a.attr("src")),t("."+fi+" input",n).val(a.attr("width")),t("."+li+" input",n).val(a.attr("heigth"))):(t("."+si+" input",n).show(),s.hide(),t("."+si+" input",n).val(u)),t("."+ui+" input",n).val(e._getLinkCssField()),t("."+oi+" select",n).val(e._getLinkTarget()),t("#radAnchor",n).attr("checked","checked"),t("#radLinkTypeIsText",n).attr("checked","checked"),r.length>6&&(r.substring(0,4)==="http"?t("#radUrl",n).attr("checked","checked"):r.substring(0,6)==="mailto"?t("#radMail",n).attr("checked","checked"):r.substring(0,1)==="#"?t("#radAnchor",n).attr("checked","checked"):t("#radFile",n).attr("checked","checked")),a=undefined},n.prototype._getLinkInnerHTML=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return t.innerHTML||""}catch(n){}return""},n.prototype.getLinkHrefField=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return e.fixAbsoluteUrlsIfNeeded(t.href||"")}catch(n){}return""},n.prototype._getLinkTarget=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return t.target||""}catch(n){}return""},n.prototype._getLinkCssField=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return t.style.cssText||""}catch(n){}return""},n.prototype.submitHyperLinkDialog=function(){var e=this,n=e.dialog,i=t("#radMail",n),s=t("."+ni+" input",n),o=t("."+si+" input",n),u=t("."+ui+" input",n),a=t("."+oi+" select",n),f=s.val(),l=o.val(),c=a.val(),h=t("#radLinkTypeIsImage",n),p=h.attr("checked"),d=t("."+ai+" input",n).val(),v=t("."+fi+" input",n).val(),m=t("."+li+" input",n).val(),g=u.val();if(f===""){r(this.localizeString("errorMessageAddressError","Please input address!"));return}if(l===""&&!p){r(this.localizeString("errorMessageDisplayTextError","Please input display text!"));return}if(d===""&&p){r(this.localizeString("errorMessageHyperLinkImageUrlError","Please input image url!"));return}if(!e._isNumeric(v)&&p){r(this.localizeString("errorMessageHyperLinkImageWidthError","Please input correct image width!"));return}if(!e._isNumeric(m)&&p){r(this.localizeString("errorMessageHyperLinkImageHeightError","Please input correct image height!"));return}if(i.attr("checked")&&!e._isEmail(f)){r(this.localizeString("errorMessageHyperLinkEmail","Please input correct email!"));return}p&&(l='<img src="'+d+'" width="'+v+'" height="'+m,l+='"/>'),e._editLink(l,f,g,c),e._closeDialog()},n.prototype._editLink=function(e,t,n,r){var i=this,s,o="";i.focus(),s=i._getInspectElement();try{if(s&&s.tagName==="A"){s.innerHTML=e,s.href=t,s.target=r,n!==s.style.cssText&&(s.style.cssText=n),i._addtoUndoBuffer(),i._setSaveBtnEnabled();return}}catch(u){}o='<a href="'+t+'" target="'+r+'"',n!==""&&(o+=' style="'+n+'"'),o+=">"+e+"</a>",i._setIESelection(),i.insertHTML(o)},n.prototype.anchorListOnChanged=function(e){var n=this,r=n.dialog,i=t(e).val();i!==""&&(t("."+ni+" input",r).val(i),t("#radAnchor",r).attr("checked","checked"))},n.prototype.radioListOnChanged=function(){var e=this,n=e.dialog,r=t("."+ii,n),i=t("."+ni+" input",n);i.val(""),t("#radUrl",n).is(":checked")?r.hide():t("#radAnchor",n).is(":checked")?r.show():t("#radMail",n).is(":checked")?(r.hide(),i.val("mailto:")):t("#radFile",n).is(":checked")&&r.hide()},n.prototype.linkIconTypeOnChanged=function(){var e=this,n=e.dialog,r=t("."+ci,n),i=t("."+si,n);t("#radLinkTypeIsText",n).is(":checked")?(i.show(),r.hide()):t("#radLinkTypeIsImage",n).is(":checked")&&(i.hide(),r.show())},n.prototype._getDialogRes_Code=function(){var e=this,t=e._createDiv(ti);return t.add(e._createElement("div","Enter source code",{"class":vi})),t.add(e._createElement("textarea","",{"class":di})),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},n.prototype.initInsertCodeDialog=function(){var e=this,t=e.dialog;t.delegate(ms,"click."+e.widgetName,function(t){e.submitCodeDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()})},n.prototype.submitCodeDialog=function(){var e=this,n=e.dialog,r=t("."+di,n),i=r.val();if(i==="")return;i=i.replace(/</g,"&lt;"),i=i.replace(/>/g,"&gt;"),i="<pre>"+i+"</pre>",e._setIESelection(),e.insertHTML(i),e._closeDialog()},n.prototype.initTagInspectorDialog=function(){var e=this,n=e.dialog,r=t("."+xi);n.delegate(ms,"click."+e.widgetName,function(t){e.submitTagInspectorDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("#displayNoEmpty","click."+e.widgetName,function(){e.tagInspectorDialogSwitchAttList(this)}),e._laySelectedElementAttributes(t("."+Si,n),t("."+bi,n)),t("."+Ti+" input",n).val(e._getSelectedElementStyle()),e._selectedElementCanHaveChildren()?(r.show(),t("textarea",r).val(e._getSelectedElementInnerHTML())):r.hide()},n.prototype.submitTagInspectorDialog=function(){var e=this,n=e.dialog,r=e._getInspectElement(),i=t("."+Si,n),s=t("."+Ti+" input").val(),o=t("."+xi+" textarea").val();try{t.each(t("input:checkbox",i),function(e,n){var i,s,o=t(n);o.is(":checked")&&(i=o.siblings("span").text(),i=i.substring(0,i.length-1),s=o.siblings("input:text").val(),t(r).attr(i,s))}),t.trim(s)!==""&&(r.style.cssText=s),e._selectedElementCanHaveChildren()&&t(r).html(o)}catch(u){}e._closeDialog(),e._addtoUndoBuffer(),e._setSaveBtnEnabled()},n.prototype.tagInspectorDialogSwitchAttList=function(e){var n=t("."+Si,this.dialog),r=!e.checked;t.each(t("input:text",n),function(e,n){t(n).val()===""&&t(n).parent("li")[r?"show":"hide"]()})},n.prototype._laySelectedElementAttributes=function(e,n){var r=this,i=r._getInspectElement(),s,o,u,a=this.localizeString("tagInspectorDialogSave","Save"),f="";if(!i)return;n.html(i.tagName),s=r._getDictionaryDeclare(),o=i.tagName.toLowerCase(),u=s[o];switch(o){case"ul":case"u":case"textarea":case"tbody":case"tr":case"th":case"td":case"table":case"select":case"strong":case"span":case"p":case"option":case"ol":case"li":case"label":case"input":case"img":case"i":case"hr":case"form":case"font":case"em":case"div":case"code":case"button":case"body":case"b":case"a":f+="<ul class='ui-helper-reset'>",t.each(u,function(e,t){var n=i.getAttribute(t)||"";f+="<li><span class='"+Cr+"'>",f+=t+":</span>",f+="<input type='text' value='"+n+"'/>",f+="<input type='checkbox' id='save"+e+"'/>",f+="<label for='save"+e+"'>"+a+"</label></li>"})}e.html(f)},n.prototype._getSelectedElementStyle=function(){var e=this._getInspectElement();return e&&e.style?e.style.cssText||"":""},n.prototype._getSelectedElementInnerHTML=function(){var e=this._getInspectElement();return e?e.innerHTML:""},n.prototype._selectedElementCanHaveChildren=function(){return!t(this._getInspectElement()).is("input,hr,br,img")},n.prototype.initBackColorDialog=function(){this._initColorDialog("BackColor")},n.prototype.initForeColorDialog=function(){this._initColorDialog("ForeColor")},n.prototype._initColorDialog=function(e){var n=this,r=n.dialog,i=n._getDesignViewDocument(),s=i.queryCommandValue(e),u,a,f;r.delegate(ms,"click."+n.widgetName,function(t){n.submitColorDialog(e),n._onDesignViewBlur(t)}).delegate(gs,"click."+n.widgetName,function(){n._closeDialog()}),s&&(f=s.toString(),t.browser.mozilla&&f==="transparent"&&(f="#ffffff"),t.browser.msie&&(u=o(f),f="rgb("+(u&255)+", "+((u&65280)>>8)+", "+((u&16711680)>>16)+")"),f.indexOf("rgb(")===0?(a=f.substring(4,f.length-1).split(","),f=n._convertToWebColor(o(a[0]),o(a[1]),o(a[2]))):f.indexOf("rgba(")===0&&(a=f.substring(5,f.length-1).split(","),f=n._convertToWebColor(o(a[0]),o(a[1]),o(a[2]))),t("."+ki+" input",r).attr("value",f)),t("."+Ci,r).wijeditorcolorcanvas("."+ki+" input",f)},n.prototype.submitColorDialog=function(e){var n=this,r=t("."+ki+" input",n.dialog);n.setColor(e,r.val()),n._closeDialog()},n.prototype.setColor=function(e,n){var r=this,i=r._getDesignViewDocument(),s=r._getDesignViewWindow(),o;r._setIESelection(),t.browser.mozilla&&e==="BackColor"?(o=s.getSelection(),r.insertHTML('<span style="background-color:'+n+';">'+o+"</span>")):(i.execCommand(e,!1,n),r.options.mode==="bbcode"&&!t.browser.msie&&r._convertFontStyleToStandTag()),r._addtoUndoBuffer(),r._setSaveBtnEnabled()},n.prototype.initInsertTableDialog=function(){var e=this,t=e.dialog;t.delegate(ms,"click."+e.widgetName,function(t){e.submitInsertTableDialog(),e._onDesignViewBlur(t)}).delegate(bs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+ji+" input:button","click."+e.widgetName,function(){e.showTableColorDialog(this)})},n.prototype.submitInsertTableDialog=function(){var e=this,t=e._getValuesFromTableDialog();if(!t)return;e._insertTable(t),e._closeDialog()},n.prototype._insertTable=function(e){var n=this,r="",i,s;if(!e)return!1;n._setIEFocus(),r+='<table width="'+e.width+'" height="'+e.height+'" cellspacing="'+e.cspacing+'" cellpadding="'+e.cpadding+'" border="'+e.border+'" bgcolor="'+e.bgcolor+'" style="'+e.css+'">';for(i=0;i<e.rows;i++){r+="<tr>";for(s=0;s<e.cols;s++)r+="<td>Cell "+(i+1)+"-"+(s+1)+"</td>";r+="</tr>"}r+="</table>";if(t.browser.mozilla||t.browser.msie&&o(t.browser.version)>=9)r+="<br />";n.insertHTML(r)},n.prototype.initEditTableDialog=function(){var e=this,n=e.dialog,r=e._getInspectElement(),i,s;n.delegate(ms,"click."+e.widgetName,function(t){e.submitEditTableDialog(),e._onDesignViewBlur(t)}).delegate(bs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+ji+" input:button","click."+e.widgetName,function(){e.showTableColorDialog(this)});if(!r)return;try{i=r.rows,i.length>0?s=i[0].cells.length:s=0,i=i.length}catch(o){}t("."+Ai+" input",n).val(i),t("."+Oi+" input",n).val(s),t("."+Mi+" input",n).val(r.getAttribute("width")),t("."+_i+" input",n).val(r.getAttribute("height")),t("."+Di+" input",n).val(r.getAttribute("border")),t("."+Pi+" input",n).val(r.getAttribute("cellPadding")),t("."+Hi+" input",n).val(r.getAttribute("cellSpacing")),t("."+ji+" input",n).val(r.getAttribute("bgcolor")||"#ffffff"),t("."+Bi+" input",n).val(r.style.cssText)},n.prototype.submitEditTableDialog=function(){var e=this,n=e._getInspectElement(),r=t(n),i=e._getValuesFromTableDialog(),s=i&&o(i.rows),u=i&&o(i.cols),a,f;if(!i)return;if(n){r.attr("width",i.width),r.attr("height",i.height),r.attr("bgcolor",i.bgcolor),r.attr("border",i.border),r.attr("cellSpacing",i.cspacing),r.attr("cellPadding",i.cpadding),n.style.cssText=i.css;if(!s||isNaN(s))return;if(!u||isNaN(u))return;while(n.rows.length>s)n.deleteRow(0);while(n.rows.length<s){a=n.insertRow(0);while(a.cells.length<u)f=a.insertCell(0),f.innerHTML="&nbsp;"}t.each(n.rows,function(e,t){while(t.cells.length>u)t.deleteCell(0);while(t.cells.length<u)f=t.insertCell(0),f.innerHTML="&nbsp;"})}e._closeDialog()},n.prototype._getValuesFromTableDialog=function(){var e=this,n=e.dialog,i=t("."+Ai+" input",n).val(),s=t("."+Oi+" input",n).val(),u=t("."+Mi+" input",n).val(),a=t("."+_i+" input",n).val(),f=t("."+Di+" input",n).val(),l=t("."+Pi+" input",n).val(),c=t("."+Hi+" input",n).val(),h=t("."+Bi+" input",n).val(),p=t("."+ji+" input",n).val();return e._isNumeric(i)?e._isNumeric(s)?e._isNumeric(u)?e._isNumeric(a)?e._isNumeric(f)?e._isNumeric(l)?e._isNumeric(c)?{rows:i,cols:s,width:o(u),height:o(a),border:f,cpadding:l,cspacing:c,css:h,bgcolor:p}:(r(this.localizeString("tableDialogCellSpacingError","Please input a number for 'Cell Spacing' textbox.")),!1):(r(this.localizeString("tableDialogCellPaddingError","Please input a number for 'Cell Padding' textbox.")),!1):(r(this.localizeString("tableDialogBorderError","Please input a number for 'Border thickness' textbox.")),!1):(r(this.localizeString("errorMessageTableHeightError","Please input a number for 'Table Height' textbox.")),!1):(r(this.localizeString("errorMessageTableWidthError","Please input a number for 'Table Width ' textbox.")),!1):(r(this.localizeString("errorMessageColumnsError","Please input a number for 'Columns' textbox.")),!1):(r(this.localizeString("errorMessageRowsError","Please input a number for 'Rows' textbox.")),!1)},n.prototype.showTableColorDialog=function(e){var n=this,r,i=n.subDialog,s=t(e).prev().val(),u=n._getDialogRes_Color();r={width:"auto",height:"auto",modal:!0,title:"Set Background Color",position:"center",resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},i.empty().append(u),t.browser.msie&&o(t.browser.version)===6?window.setTimeout(function(){i.wijdialog(r)},0):i.wijdialog(r),i.delegate(ys,"click."+n.widgetName,function(){n.submitTableColorDialog()}).delegate(bs,"click."+n.widgetName,function(){n.closeSubDialog()}),s!==""&&t("."+ki+" input",i).val(s),t("."+Ci,i).wijeditorcolorcanvas("."+ki+" input",s),i.wijdialog("open")},n.prototype.submitTableColorDialog=function(){var e=this,n=e.subDialog,r=e.dialog,i=t("."+ki+" input",n).val();t("."+ji+" input:text",r).val(i),e.closeSubDialog()},n.prototype.closeSubDialog=function(){this.subDialog.wijdialog("close")},n.prototype._getEditableTable=function(){var e=this,n,i,s;i=e._getSelectedElement();if(!i)return r(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;s=t(i);if(s.is("td,tr,tbody"))i=s.parents("table:first")[0];else{n=s.find("table:only-child");if(!t.browser.msie||!n.length)return r(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;i=n[0]}return g=i,!0},n.prototype.initPreviewDialog=function(){var e=this,t=e.dialog;e._setPreviewContent(0),t.delegate("#rad640_480","click."+e.widgetName,function(){e._setPreviewDialogSize(640,480)}).delegate("#rad800_600","click."+e.widgetName,function(){e._setPreviewDialogSize(800,600)}).delegate("#rad1024_768","click."+e.widgetName,function(){e._setPreviewDialogSize(1024,768)}).delegate("#chkSplit","click."+e.widgetName,function(){e._splitPreviewPages(this.checked)}).delegate("."+zi,"click."+e.widgetName,function(){e._printPreviewPage(!0)}).delegate("."+Wi,"click."+e.widgetName,function(){e._printPreviewPage(!1)}).delegate("."+Xi,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Ri,"click."+e.widgetName,function(){e._navigatePreviewPage(!1)}).delegate("."+Ui,"click."+e.widgetName,function(){e._navigatePreviewPage(!0)})},n.prototype._setPreviewContent=function(e){var n=this,r=n.dialog,i=t("iframe",r),s=t("."+qi+" span",r),o=i[0].contentWindow.document;o.open(),e===-1?(o.write(n._getPreviewAllPageContent()),s.html("1 / 1")):(o.write(n._getPreviewPageContent(e)),s.html(e+1+" / "+n._getPreviewPageCount())),o.close()},n.prototype._setPreviewDialogSize=function(e,n){var r=this,i=r.dialog,s=t("iframe",i),o=i.wijdialog("option","width"),u=i.wijdialog("option","height");o==="auto"?o=i.parent(".wijmo-wijdialog").width()-s.width():o-=s.width(),u==="auto"?u=i.parent(".wijmo-wijdialog").height()-s.height():u-=s.height(),s.css("width",e).css("height",n),i.wijdialog("option",{width:e+o,height:n+u})},n.prototype._getPreviewPageCount=function(){return this._getPreviewPages().length},n.prototype._getPreviewPageContent=function(e){var t=this._getPreviewPages();return t.length>e?t[e]:null},n.prototype._getPreviewAllPageContent=function(){return this._getDesignViewText()},n.prototype._getPreviewPages=function(){var e=this._getPreviewAllPageContent(),t=new RegExp("<(DIV|div)[^>]*(page-break-before|PAGE-BREAK-BEFORE)[ ]*:[ ]*always[^>]*>(.*?)<\\/(DIV|div)>","g"),n=e.replace(t,"!-~U^n#i@q,P|.a=g~e+br!");return n.split("!-~U^n#i@q,P|.a=g~e+br!")},n.prototype._splitPreviewPages=function(e){var n=this,r=n.dialog,i=t("."+Vi,r),s=t("."+qi,r);e?(n._setPreviewContent(0),s.show(),i.hide()):(n._setPreviewContent(-1),s.hide(),i.show()),n._curPageIdx=0},n.prototype._navigatePreviewPage=function(e){var n=this,r=t("#chkSplit",n.dialog),i=n._curPageIdx,s=n._getPreviewPageCount();r.is(":checked")&&(e?(i++,i<s?n._setPreviewContent(i):i=s-1):(i--,i>=0?n._setPreviewContent(i):i=0),n._curPageIdx=i)},n.prototype._printPreviewPage=function(e){var n=this,r=n.dialog,i=t("#chkSplit",r),s=t("iframe",r)[0].contentWindow;e&&(i.removeAttr("checked"),n._setPreviewContent(-1)),s.focus(),s.print()},n.prototype.initCleanUpDialog=function(){var e=this,n=e.dialog;t("textarea",n).val(e.sourceView.val()),n.delegate(ms,"click."+e.widgetName,function(t){e.submitCleanUpDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()})},n.prototype.submitCleanUpDialog=function(){var e=this,n=e.dialog,r=e.sourceView,i=r.val(),s;t("#replaceSpans",n).is(":checked")&&(s=new RegExp("<\\/?SPAN[^>]*>","g"),i=i.replace(s,"")),t("#replaceClass",n).is(":checked")&&(s=new RegExp("<(\\w[^>]*) class=([^ |>]*)([^>]*)","g"),i=i.replace(s,"<$1$3")),t("#replaceStyle",n).is(":checked")&&(s=new RegExp('<(\\w[^>]*) style="([^"]*)"([^>]*)',"g"),i=i.replace(s,"<$1$3"),s=new RegExp("<(\\w[^>]*) lang=([^ |>]*)([^>]*)","g"),i=i.replace(s,"<$1$3"),s=new RegExp("<\\\\?\\?xml[^>]*>","g"),i=i.replace(s,""),s=new RegExp("<\\/?\\w+:[^>]*>","g"),i=i.replace(s,"")),t("#replaceNbsp",n).is(":checked")&&(s=new RegExp("&nbsp;","g"),i=i.replace(s," ")),t("#transformPtoDiv",n).is(":checked")&&(s=new RegExp("(<P)([^>]*>.*?)(<\\/P>)","g"),i=i.replace(s,"<div$2</div>")),r.val(i),e._setDesignViewText(i),e._addtoUndoBuffer(),e._closeDialog()},n.prototype.initFindDialog=function(){var e=this,t=e.dialog;e.tRange&&(e.tRange=null),t.delegate(ms,"click."+e.widgetName,function(){e.submitFindAction()}).delegate(gs,"click."+e.widgetName,function(t){e.submitReplaceAction(),e._onDesignViewBlur(t)})},n.prototype.submitFindAction=function(){var e=this,n=t("textarea:first",e.dialog).val();if(t.trim(n)==="")return;e._findAndReplaceString(n)},n.prototype.submitReplaceAction=function(){var e=this,n=e.dialog,i=t("textarea:first",n).val(),s=t("textarea:last",n).val();if(t.trim(i)==="")return;if(t.trim(s)===""){r(this.localizeString("errorMessageReplaceStringError","please input replace string!"));return}e._findAndReplaceString(i,s)},n.prototype._findAndReplaceString=function(e,n){var i=this,s=i._getDesignViewWindow(),o=0,u=!1,a=n&&n!==e;n||(n=e);if(t.browser.msie)i.tRange&&(i.txtFoundInIE&&a?(o=i.tRange.findText(e),o&&(i.tRange.pasteHTML(n),i.tRange.collapse(!1),u=!0,i.txtFoundInIE=!1)):(i.tRange.collapse(!1),o=i.tRange.findText(e),o&&i.tRange.select())),!u&&(!i.tRange||!o)&&(i.tRange=s.document.body.createTextRange(),o=i.tRange.findText(e),o&&(i.tRange.select(),a&&(i.tRange.pasteHTML(n),u=!0)));else{if(i.txtFoundInNoneIE&&a)i._replaceSelectionForNoneIE(n),u=!0,i.txtFoundInNoneIE=!1;else{o=s.find(e);if(!o){o=s.find(e,0,1);while(s.find(e,0,1))continue}}i.txtFoundInNoneIE=i.txtFoundInNoneIE||o,i.txtFoundInNoneIE&&a&&(i._replaceSelectionForNoneIE(n),u=!0,i.txtFoundInNoneIE=!1)}!o&&!u?(r('"'+e+'"'+this.localizeString("errorMessageFindTextError"," String Not Found!")),i.tRange=null,i.txtFoundInNoneIE=!1,i.txtFoundInIE=!1):i.txtFoundInIE=!0},n.prototype._replaceSelectionForNoneIE=function(e){var t=this._getDesignViewDocument();t.execCommand("inserthtml",!1,e)},n.prototype.initMediaDialog=function(){var e=this,t=e.dialog;t.delegate(ms,"click."+e.widgetName,function(t){e.submitMediaDialog(),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()})},n.prototype.submitMediaDialog=function(){var e=this,n=e.dialog,i=t("select",n).val(),s=t("."+rs+" input",n).val(),o=t("."+is+" input",n).val(),u=t("."+ss+" input",n).val();if(s===""){r(this.localizeString("errorMessageUrlEmptyError","URL is empty!"));return}if(!e._isUrl(s)){r(this.localizeString("errorMessageUrlCorrectError","please input correct URL!"));return}if(!e._isNumeric(o)){r(this.localizeString("errorMessageMediaWidthError","please input width of the media!"));return}if(!e._isNumeric(u)){r(this.localizeString("errorMessageMediaHeightError","please input height of the media!"));return}e._insertMedia(i,s,o,u),e._closeDialog()},n.prototype._insertMedia=function(e,t,n,r){var i=this,s="";i._setIESelection();switch(e){case"video":s+='<embed src="'+t+'" width="'+n+'" '+'height="'+r+'" '+'type=audio/x-pn-realaudio-plugin console="Clip1" '+'controls="IMAGEWINDOW,ControlPanel,StatusBar" '+'autostart="true"></embed>';break;case"flash":s+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="'+n+'" height="'+r+'">',s+='<param name="movie" value="'+t+'">',s+='<param name="quality" value="high">',s+='<embed src="'+t+'" quality="high" '+'pluginspage="http://www.macromedia.com/go/getflashplayer" '+'type="application/x-shockwave-flash" '+'width="'+n+'" height="'+r+'"></embed>',s+="</object>";break;case"applet":s+='<applet code="'+t+'" width="'+n+'" '+'height="'+r+'"></applet>';break;case"other":s+='<embed src="'+t+'" width="'+n+'" '+'height="'+r+'"></embed>'}i.insertHTML(s)},n.prototype.initSpecialCharacterDialog=function(){var e=this,n=e.dialog,r=t("."+fs+" span",n);n.delegate("label","click."+e.widgetName,function(t){e.submitSpecialCharacterDialog(this),e._onDesignViewBlur(t)}).delegate(ms,"click."+e.widgetName,function(){e._closeDialog()}).delegate("label","mouseover."+e.widgetName,function(){r.html(t(this).html())}).delegate("label","mouseout."+e.widgetName,function(){r.empty()})},n.prototype.submitSpecialCharacterDialog=function(e){var n=this;n._setIESelection(),n.insertHTML(t(e).html()),n._closeDialog()},n.prototype._setSaveBtnEnabled=function(){this.$ribbon.wijribbon(y,Mt,!1)},n.prototype._undoAction=function(){var e=this._getDesignViewDocument().body,t={};d--,d<=0&&(d=0),e.innerHTML=v[d],d?this.$ribbon.wijribbon(y,bt,!1):(t[yt]=!0,t[bt]=!1,this.$ribbon.wijribbon(b,t))},n.prototype._redoAction=function(){var e=this._getDesignViewDocument().body,t=v.length,n={};d++,d>=t-1&&(d=t-1),e.innerHTML=v[d],d===t-1?(n[yt]=!1,n[bt]=!0,this.$ribbon.wijribbon(b,n)):this.$ribbon.wijribbon(y,yt,!1)},n.prototype._addtoUndoBuffer=function(){var e=v.length-1-d,t;for(t=0;t<e;t++)v.pop();d++,v.push(this._getDesignViewText()),this.$ribbon.wijribbon(y,yt,!1)},n.prototype._deleteSelectionContent=function(){var e=this._getDesignViewWindow(),n,r,i,s="rangeCount";if(t.browser.msie)n=e.document.selection,n.type.toLowerCase()!=="none"&&n.clear();else{n=e.getSelection();for(r=0;r<n[s];r++)i=n.getRangeAt(r),i.deleteContents()}},n.prototype._refreshPathSelector=function(){var e=this,n=e._getParentElement(e._getDesignViewWindow()),r,i=e._getPathSelector(),s=t(n).parents(),o=s.length,u="wijmo-wijeditor-label ui-state-default ui-corner-all",a;if(!n)return;r=n.tagName?n.tagName.toLowerCase():"",i.empty();for(a=o-1;a>=0;a--)i.append("<label class='"+u+"'>&lt;"+s[a].tagName.toLowerCase()+"&gt;</label>");i.append("<label class='"+u+" wijmo-wijeditor-selectlabel ui-state-highlight ui-corner-all'>&lt;"+r+"&gt;</label>")},n.prototype._toggleTableBorders=function(){var e=this._getDesignViewDocument(),n=t("#__wijStyle",e);p=!p,t.browser.safari?p?n.html("table,td,tr{border: 1px #acacac dashed;}"):n.empty():n.attr("disabled",!p)},n.prototype._tableAction=function(e){var n=this,i=n._getParentElement(n._getDesignViewWindow()),s=t(i).closest("td"),o,u,a,f,l,c,h,p,d,v,m=0;n._setSaveBtnEnabled();if(s.length===0&&e!==j)return!1;e!==j&&(o=s.parent(),u=o.closest("table"),a=s[0],f=o[0],l=u[0],c=f.rowIndex,h=a.cellIndex);try{switch(e){case P:p=f.cells.length,v=l.insertRow(c);for(m=0;m<p;m++)n._insertCell(v,m);break;case I:l.deleteRow(c);break;case D:d=l.rows.length;for(m=0;m<d;m++)n._insertCell(l.rows[m],h);break;case F:n._removeColumn(l,h);break;case H:n._insertCell(f,h+1);break;case q:p=f.cells.length,p===1?l.deleteRow(c):f.deleteCell(h);break;case B:n._splitCell(l,f,c,h);break;case j:n._mergeCell(n._getSelectedCells(i))}this._addtoUndoBuffer()}catch(g){return r(g.message),!1}return!0},n.prototype._removeColumn=function(e,t){var n=e.rows.length,r=0,i,s,o,u,a;while(r<n)i=e.rows[r],s=i.cells,o=s.length,u=t>o-1?o-1:t,a=s[u].colSpan,a>1&&o>1&&(u+1<o?s[u+1].colSpan+=a-1:s[u-1].colSpan+=a+1),o===1?(e.deleteRow(r),n=e.rows.length):(i.deleteCell(u),r++)},n.prototype._splitCell=function(e,t,n,r){var i=e.rows.length,s=0,o=0,u,a,f,l,c;while(s<=r)t.cells[s].colSpan>1&&(o+=t.cells[s].colSpan-1),s++;this._insertCell(t,r+1);for(f=0;f<i;f++){u=e.rows[f];if(f!==n){l=r,s=0,a=0;while(s<=l)u.cells[s].colSpan>1&&(a+=u.cells[s].colSpan-1,l-=a),s++;c=r+o-a,c<0&&(c=0),u.cells[c].colSpan++}}},n.prototype._mergeCell=function(e){var t=e.length,n,r,i,s;if(t<2||e[0].parentNode!==e[t-1].parentNode)return!1;n=e[0].parentNode,r=e[0].cellIndex,i=r+t;for(s=r+1;s<i;s++)n.cells[r].innerHTML+=n.cells[r+1].innerHTML,n.cells[r].colSpan++,n.deleteCell(r+1)},n.prototype._getSelectedCells=function(e){var n=this._getDesignViewWindow(),r=n.document,i=[],s,o,u,a,f,l,c,h;if(t.browser.msie)s=r.selection.createRange(),o=t(e).closest("tr")[0],o&&t.each(o.cells,function(e,t){var n=r.selection.createRange(),o="compareEndPoints";n.moveToElementText(t),(s.inRange(n)||s[o]("StartToStart",n)>=0&&s[o]("StartToEnd",n)<=0||s[o]("EndToStart",n)>=0&&s[o]("EndToEnd",n)<=0)&&i.push(t)});else if(t.browser.mozilla){u=n.getSelection(),f=u.rangeCount;for(a=0;a<f;a++)s=u.getRangeAt(a),l=s.startContainer,c=l.nodeName.toLowerCase(),c==="td"||c==="th"?i.push(l):c==="tr"&&(h=s.startOffset,i.push(l.cells[h]))}else{u=n.getSelection(),o=t(e).closest("tr")[0];if(o){f=o.cells.length;for(a=0;a<f;a++)i.push(o.cells[a])}}return i},n.prototype.insertDateAndTime=function(){var e=new Date;this.options.culture&&this.options.culture!==""?this.insertHTML(Globalize.format(e,"dddd ",Globalize.findClosestCulture(this.options.culture))+Globalize.format(e,"F",Globalize.findClosestCulture(this.options.culture))):this.insertHTML(e.toDateString()+" "+e.toTimeString())},n.prototype._toggleWordWrap=function(){var e=this,n=e.sourceView,r="wrap",s;h=!h,s=h?"soft":"off",n.attr(r,s),n[0].focus(),t.browser.mozilla&&(n.hide(),i.setTimeout(function(){n.show()},40))},n.prototype.insertHTML=function(e){var n=this,r=n._getDesignViewDocument(),i;try{t.browser.msie?(i=r.selection.createRange(),i.pasteHTML(e),i.collapse(!1),i.select()):r.execCommand("insertHTML",!1,e)}catch(s){}n._addtoUndoBuffer(),n._setSaveBtnEnabled()},n.prototype._getSelectedContent=function(){var e=this._getDesignViewWindow(),t=e.document,n="",r="cloneContents",i,s,o;return t.selection?(i=t.selection.createRange(),i.htmlText):(i=e.getSelection().getRangeAt(0),i&&i[r]&&(s=i[r](),o=document.createElement("div"),o.appendChild(s),n=o.innerHTML,o=null),n||"")},n.prototype._setIESelection=function(){t.browser.msie&&m&&m.select()},n.prototype._setIEFocus=function(){var e=this._getDesignViewDocument();if(t.browser.msie)try{e.body.focus()}catch(n){}},n.prototype.focus=function(){var e=this._getDesignViewWindow(),n=e.document;t.browser.msie?m?m.select():n.body.focus():e.focus()},n.prototype._getInspectElement=function(){return g||this._getSelectedElement()},n.prototype._getSelectedElement=function(){return this._getParentElement(this._getDesignViewWindow())},n.prototype._createElement=function(e,t,n){return new Cs(e,t,n)},n.prototype._createDiv=function(e,t){return this._createElement("div",{"class":e})},n.prototype._createSpan=function(e,t){var n=this;return t?e.length===0?n._createElement("span",t):this._createElement("span",t,{"class":e}):n._createElement("span",{"class":e})},n.prototype._createTextBox=function(e,t){var n={"class":e,type:"text",value:undefined};return t&&(n.value=t),this._createElement("input",n)},n.prototype._createLabel=function(e,t){return t?new Cs("label",e,{"for":t}):new Cs("label",e)},n.prototype._createRadio=function(e,t,n){var r={name:t,id:e,value:n,type:"radio"};return this._createElement("input",r)},n.prototype._createCheckbox=function(e){var t={type:"checkbox",id:e};return this._createElement("input","",t)},n.prototype._createSelect=function(e,n){var r=this,i={"class":e},s=r._createElement("select",i);return e===""&&(s=r._createElement("select")),t.each(n,function(e,n){t.isPlainObject(n)&&n.selected?s.add(r._createElement("option",n.text,{selected:"selected"})):s.add(r._createElement("option",n))}),s},n.prototype._createInputButton=function(e,t){var n={"class":e,type:"button",value:undefined};return t&&(n.value=t),this._createElement("input",n)},n.prototype._createTextField=function(e,t,n,r){var i=this,s=i._createDiv(t),o={type:"text",value:""};return r&&(o.value=r),s.add(i._createSpan(Cr,e)),s.add(i._createElement("input",o)),n&&s.add(new Ns(n)),s},n.prototype._createSeparator=function(){var e=this,t=e._createDiv(xr);return t.add(e._createElement("hr")),t},n.prototype._createOKCancelButtons=function(){var e=this,t=e._createDiv(Tr);return t.add(e._createElement("input",{type:"button","class":Nr,value:this.localizeString("dialogOK","OK")})),t.add(e._createElement("input",{type:"button","class":Nr,engValue:"Cancel",value:this.localizeString("dialogCancel","Cancel")})),t},n.prototype._getDialogRes_Template=function(){var e=this,t=e._createDiv(Ir),n=e._createDiv(qr),r=e._createDiv(zr),i=e._createDiv(Wr),s=e._createDiv(Xr),o=e._createDiv(Vr),u=e._createElement("div",this.localizeString("templateDialogName","Name :")),a=e._createElement("div",this.localizeString("templateDialogDescription","Description :")),f=e._createDiv(Kr),l=e._createDiv(Yr);return n.add(e._createElement("div",this.localizeString("templateDialogSelectTemplate","Select Template:"),{"class":Rr})),n.add(e._createElement("div",this.localizeString("templateDialogTemplatePreview","Template Preview:"),{"class":Ur})),t.add(n),i.add(e._createElement("select",{size:8})),s.add(e._createElement("iframe",{frameborder:0})),r.add(i),r.add(s),t.add(r),u.add(e._createSpan($r)),a.add(e._createSpan(Jr)),o.add(u),o.add(a),t.add(o),f.add(e._createSpan(Cr,this.localizeString("templateDialogName","Name :"))),f.add(e._createTextBox(Qr)),f.add(e._createSpan(Cr,this.localizeString("templateDialogDescription","Description :"))),f.add(e._createTextBox(Gr)),t.add(f),l.add(e._createInputButton(Nr+" "+Zr,this.localizeString("templateDialogDeleteSelected","Delete selected"))),l.add(e._createInputButton(Nr+" "+ei,this.localizeString("templateDialogSaveCurrentPage","Save current page as template"))),t.add(l),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},n.prototype._getDialogRes_ImageBrowser=function(){var e=this,t=e._createDiv(kr),n=e._createDiv(Lr),r=e._createDiv(Ar),i=e._createDiv(Or),s=e._createDiv(Mr),o=e._createDiv(_r);return r.add(e._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),Dr)),r.add(e._createTextField(this.localizeString("imageEditorDialogImageAltText","Image alt text:"),Pr)),r.add(e._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),Hr,this.localizeString("dialogPixel","px"))),r.add(e._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),Br,this.localizeString("dialogPixel","px"))),r.add(e._createTextField(this.localizeString("imageEditorDialogCssText","Css text:"),jr)),n.add(r),i.add(s),s.add(e._createElement("select",{size:8})),i.add(o),o.add(e._createElement("img",{src:"",alt:""})),n.add(i),n.add(e._createSeparator()),n.add(e._createOKCancelButtons()),t.add(n),t.render()},n.prototype._getDialogRes_Link=function(){var e=this,n=e._createDiv(ti),r=e._createTextField(this.localizeString("hyperLinkDialogAddress","Address :"),ni),i=e._createDiv(ri+" ui-helper-clearfix"),s=e._createElement("div"),o=e._createDiv(ci),u=e._createDiv(hi),a=e._createElement("div"),f=[{id:"radUrl",value:"url",text:this.localizeString("hyperLinkDialogUrl","url")},{id:"radAnchor",value:"anchor",checked:!0,text:this.localizeString("hyperLinkDialogAnchor","anchor")},{id:"radMail",value:"email",text:this.localizeString("hyperLinkDialogEmail","email")}],l=[{id:"radLinkTypeIsText",value:"text",checked:!0,text:this.localizeString("hyperLinkDialogText","text")},{id:"radLinkTypeIsImage",value:"image",text:this.localizeString("hyperLinkDialogImage","image")}],c=[],h=e._createTextField(this.localizeString("hyperLinkDialogTextToDisplay","Text to display :"),si),p=e._createSpan(Cr,this.localizeString("hyperLinkDialogIconType","Icon Type :")),d=e._createDiv(oi),v=e._createSpan(Cr,this.localizeString("hyperLinkDialogTarget","Target :")),m=[{text:"_blank",selected:!0},"_parent","_self","_top"],g=e._createSelect(oi,m),y=e._createTextField(this.localizeString("hyperLinkDialogCss","Css :"),ui),b;o.add(e._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),ai)),o.add(e._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),fi,this.localizeString("dialogPixel","px"))),o.add(e._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),li,this.localizeString("dialogPixel","px"))),n.add(r),n.add(i),i.add(s),u.add(a),a.add(p),t.each(f,function(t,n){s.add(e._createRadio(n.id,"radioList",n.value)),s.add(e._createLabel(n.text,n.id))}),t.each(l,function(t,n){a.add(e._createRadio(n.id,"linkIconRadioList",n.value)),a.add(e._createLabel(n.text,n.id))});for(b=1;b<8;b++)c.push("#anchor"+b.toString());return i.add(e._createSelect(ii,c)),n.add(e._createSeparator()),n.add(u),n.add(h),n.add(o),n.add(d),d.add(v),d.add(g),n.add(y),n.add(e._createSeparator()),n.add(e._createOKCancelButtons()),n.render()},n.prototype._getDialogRes_TagInspector=function(){var e=this,t=e._createDiv(mi),n=e._createDiv(gi),r=e._createDiv(wi),i=e._createDiv(Ei),s=e._createDiv(xi);return t.add(n),n.add(e._createSpan(yi,this.localizeString("tagInspectorDialogSelectedTag","Selected tag :"))),n.add(e._createSpan(bi,"")),t.add(r),r.add(e._createCheckbox("displayNoEmpty")),r.add(e._createLabel(this.localizeString("tagInspectorDialogDisplayNotEmptyAttributes","Display not empty attributes only"),"displayNoEmpty")),t.add(i),i.add(e._createSpan(Cr,this.localizeString("tagInspectorDialogAttributes","Attributes:"))),i.add(e._createDiv(Si)),t.add(s),s.add(e._createSpan(Cr,this.localizeString("tagInspectorDialogInnerHTML","Inner HTML:"))),s.add(e._createElement("textarea")),t.add(e._createTextField(this.localizeString("tagInspectorDialogCSSText","Css Text:"),Ti)),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},n.prototype._getDialogRes_Color=function(){return this._getDialogRes_CommonColor("#FFFFFF")},n.prototype._getDialogRes_ForeColor=function(){return this._getDialogRes_CommonColor("#000000")},n.prototype._getDialogRes_BackColor=function(){return this._getDialogRes_CommonColor("#FFFFFF")},n.prototype._getDialogRes_CommonColor=function(e){var t=this,n=t._createDiv(Ni),r=t._createDiv(ki);return n.add(t._createDiv(Ci)),n.add(r),r.add(t._createSpan(Cr,this.localizeString("backColorDialogSelectedColor","Selected Color:"))),r.add(t._createElement("input",{type:"text",value:e})),n.add(t._createSeparator()),n.add(t._createOKCancelButtons()),n.render()},n.prototype._getDialogRes_Table=function(){var e=this,t=e._createDiv(Li),n=e._createDiv(ji);return t.add(e._createTextField(this.localizeString("tableDialogRows","Rows :"),Ai,"",3)),t.add(e._createTextField(this.localizeString("tableDialogColumns","Columns :"),Oi,"",3)),t.add(e._createTextField(this.localizeString("tableDialogTableWidth","Table Width :"),Mi,this.localizeString("tableDialogPixels","pixels"),200)),t.add(e._createTextField(this.localizeString("tableDialogTableHeight","Table Height :"),_i,this.localizeString("tableDialogPixels","pixels"),200)),t.add(e._createTextField(this.localizeString("tableDialogBorder","Border thickness:"),Di)),t.add(e._createTextField(this.localizeString("tableDialogCellPadding","Cell Padding :"),Pi)),t.add(e._createTextField(this.localizeString("tableDialogCellSpacing","Cell Spacing :"),Hi)),t.add(e._createTextField(this.localizeString("tableDialogCssText","Css Text :"),Bi)),t.add(n),n.add(e._createSpan(Cr,this.localizeString("tableDialogBackgroundColor","Background Color:"))),n.add(e._createElement("input",{type:"text"})),n.add(e._createElement("input",{type:"button",value:"..."})),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},n.prototype._getDialogRes_Preview=function(){var e=this,t=e._createDiv(Fi),n=e._createDiv(Ii),r=e._createDiv(Tr),i=e._createDiv(qi),s=e._createDiv($i);return t.add(n),n.add(e._createSpan(Cr,this.localizeString("previewDialogPreviewSize","Preview Size:"))),n.add(e._createElement("input",{id:"rad640_480",name:"preview",type:"radio",checked:"checked"})),n.add(e._createLabel("640x480","rad640_480")),n.add(e._createElement("input",{id:"rad800_600",name:"preview",type:"radio"})),n.add(e._createLabel("800x600","rad800_600")),n.add(e._createElement("input",{id:"rad1024_768",name:"preview",type:"radio"})),n.add(e._createLabel("1024x768","rad1024_768")),n.add(e._createElement("input",{id:"chkSplit",type:"checkbox",checked:"checked"})),n.add(e._createLabel(this.localizeString("previewDialogSplit","Split pages"),"chkSplit")),t.add(e._createSeparator()),t.add(r),r.add(e._createInputButton(Nr+" "+zi,this.localizeString("previewDialogPrintAll","Print All"))),r.add(e._createInputButton(Nr+" "+Wi,this.localizeString("previewDialogPrintPage","Print Page"))),r.add(e._createInputButton(Nr+" "+Xi,this.localizeString("dialogOK","OK"))),t.add(e._createSeparator()),t.add(i),i.add(e._createElement("a",this.localizeString("previewDialogPrevPage","Prev page"),{"class":Ri,href:"#"})),i.add(e._createElement("span","1 / 1")),i.add(e._createElement("a",this.localizeString("previewDialogNextPage","Next page"),{"class":Ui,href:"#"})),t.add(e._createDiv(Vi)),t.add(s),s.add(e._createElement("iframe",{src:"about:blank"})),t.render()},n.prototype._getDialogRes_CleanUp=function(){var e=this,n=e._createDiv(Ji),r=e._createDiv(Ki),i=e._createDiv(Qi),s=e._createDiv(Gi),o=[{id:"replaceSpans",label:this.localizeString("cleanUpDialogStripSpanTag","Strip SPAN tag")},{id:"replaceClass",label:this.localizeString("cleanUpDialogStripClass","Strip CLASS tag")},{id:"replaceStyle",label:this.localizeString("cleanUpDialogStripStyle","Strip STYLE attribute")},{id:"replaceNbsp",label:this.localizeString("cleanUpDialogReplaceSymbol","Replace &amp;nbsp; symbol")},{id:"transformPtoDiv",label:this.localizeString("cleanUpDialogTransformParagraphToDIV","Transform Paragraph to DIV")}];return n.add(r),r.add(e._createSpan(Cr,this.localizeString("cleanUpDialogDocumentSource","Document source :"))),n.add(i),i.add(e._createElement("textarea",{readonly:"readonly"})),n.add(s),t.each(o,function(t,n){s.add(e._createCheckbox(n.id)),s.add(e._createLabel(n.label,n.id))}),n.add(e._createSeparator()),n.add(e._createOKCancelButtons()),n.render()},n.prototype._getDialogRes_FindAndReplace=function(){var e=this,t=e._createDiv(Yi),n=e._createDiv(Zi),r=e._createDiv(es),i=e._createDiv(Tr);return t.add(n),n.add(e._createSpan(Cr,this.localizeString("findAndReplaceFind","Find:"))),n.add(e._createElement("textarea","text")),t.add(r),r.add(e._createSpan(Cr,this.localizeString("findAndReplaceReplace","Replace:"))),r.add(e._createElement("textarea")),t.add(e._createSeparator()),t.add(i),i.add(e._createInputButton(Nr,this.localizeString("findAndReplaceFindButton","Find"))),i.add(e._createInputButton(Nr,this.localizeString("findAndReplaceReplaceButton","Replace"))),t.render()},n.prototype._getDialogRes_Media=function(){var e=this,t=e._createDiv(ts),n=e._createDiv(ns);return t.add(n),n.add(e._createSpan(Cr,this.localizeString("mediaDialogMediaType","Media Type :"))),n.add(e._createSelect("",["flash","video","applet","other"])),t.add(e._createTextField(this.localizeString("mediaDialogMediaUrl","Media Url :"),rs)),t.add(e._createTextField(this.localizeString("mediaDialogWidth","Width :"),is,this.localizeString("dialogPixel","px"),200)),t.add(e._createTextField(this.localizeString("mediaDialogHeight","Height :"),ss,this.localizeString("dialogPixel","px"),200)),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},n.prototype._getDialogRes_SpecialCharacter=function(){var e=this,n=e._createDiv(os),r=e._createDiv(us),i=e._createDiv(as),s=e._createDiv(fs),o=e._createDiv(ls),u=e._createDiv(cs,"Punctuation"),a=e._createDiv(hs),f=["&#8211;","&#8212;","&iexcl;","&iquest;","&quot;","&laquo;","&raquo;","&nbsp;"],l=e._createDiv(cs,"Symbols"),c=e._createDiv(ps),h=["&amp;","&cent;","&copy;","&divide;","&gt;","&lt;","&micro;","&#8226;","&para;","&plusmn;","&#8364;","&pound;","&reg;","&sect;","&yen;"],p=e._createDiv(cs,"Diacritics"),d=e._createDiv(ds),v=["&aacute;","&Aacute;","&agrave;","&Agrave;","&acirc;","&Acirc;","&aring;","&Aring;","&atilde;","&Atilde;","&auml;","&Auml;","&aelig;","&AElig;","&ccedil;","&Ccedil;","&eacute;","&Eacute;","&egrave;","&Egrave;","&ecirc;","&Ecirc;","&euml;","&Euml;","&iacute;","&Iacute;","&igrave;","&Igrave;","&icirc;","&Icirc;","&iuml;","&Iuml;","&ntilde;","&Ntilde;","&oacute;","&Oacute;","&ograve;","&Ograve;","&ocirc;","&Ocirc;","&oslash;","&Oslash;","&otilde;","&Otilde;","&ouml;","&Ouml;","&uacute;","&Uacute;","&ugrave;","&Ugrave;","&ucirc;","&Ucirc;","&uuml;","&Uuml;","&szlig;","&yuml;","&#8216;","&#8217;"],m=e._createDiv(Tr);return n.add(r),r.add(i),i.add(s),s.add(new Cs("span")),r.add(o),o.add(u),u.add(a),t.each(f,function(t,n){a.add(e._createLabel(n))}),o.add(l),l.add(c),t.each(h,function(t,n){c.add(e._createLabel(n))}),o.add(p),p.add(d),t.each(v,function(t,n){d.add(e._createLabel(n))}),n.add(e._createSeparator()),m.add(e._createInputButton(Nr,"Cancel")),n.add(m),n.render()},n.prototype._copyFromClipboard=function(){var e,n,r,s;if(i.clipboardData)return i.clipboardData.getData("Text");if(t.browser.mozilla){try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(o){}return e=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard),e?(n=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable),n?(n.addDataFlavor("text/unicode"),e.getData(n,e.kGlobalClipboard),n.getTransferData("text/unicode",r,s),r&&(r=r.value.QueryInterface(Components.interfaces.nsISupportsString)),r?r.data.substring(0,s.value/2):""):!1):!1}},n.prototype._copyToClipboard=function(e){var n,s,o,u={},a={};if(i.clipboardData&&e)i.clipboardData.setData("Text",e);else if(t.browser.mozilla)try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),n=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!n)return;s=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!s)return;s.addDataFlavor("text/unicode"),a={},u=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),u.data=e,s.setTransferData("text/unicode",u,e.length*2),o=Components.interfaces.nsIClipboard;if(!n)return!1;n.setData(s,null,o.kGlobalClipboard)}catch(f){u="Copy text to Clipboard \n",u+="If you are using firefox please do the following :\n ",u+="1. Write in your url box : 'about:config'\n",u+="2. Change signed.applets.codebase_principal_support = true\n",r(this.localizeString("errorMessageCopyToClipboardError",u))}},n.prototype.fixAbsoluteUrlsIfNeeded=function(e){var t=this,n=s.URL,r=s.URL,i=s.URL,o=!1,u=r.length,a=e,f,l,c,h,p,d,v,m;for(v=u-1;v>0;v--){f=r.charAt(v),l=r.charAt(v-1);if(f==="/"||f==="\\"){if(f===l)break;i=r.substring(0,v)+f,o||(r=i,o=!0)}}return c=t._prepareLiteralRegexText(n+"?"),h=new RegExp(c,"g"),a=a.replace(h,"?"),p=t._prepareLiteralRegexText(r),h=new RegExp(p,"g"),a=a.replace(h,""),d=t._prepareLiteralRegexText(i),h=new RegExp(d,"g"),a=a.replace(h,"/"),m=a.indexOf("#"),m>-1&&(a=a.substr(m)),a},n.prototype._insertCell=function(e,t){var n=e.insertCell(t);return n.innerHTML="&nbsp;",n},n.prototype._getDictionaryDeclare=function(){var e={};return e.a=["accesskey","charset","class","coords","dir","href","hreflang","id","lang","name","rel","rev","shape","tabindex","target","title"],e.b=["class","dir","id","lang","title"],e.body=["alink","background","bgColor","bgproperties","bottommargin","class","dir","id","lang","leftmargin","link","marginheight","marginwidth","rightmargin","text","title","topmargin","vlink"],e.button=["accesskey","class","dir","disabled","id","lang","name","tabindex","title","type","value"],e.code=["class","dir","id","lang","title"],e.div=["align","class","dir","id","lang","title"],e.em=["class","dir","id","lang","title"],e.font=["class","color","dir","face","id","lang","pointsize","size","title"],e.form=["action","class","dir","enctype","id","lang","method","name","runat","target","title"],e.hr=["align","class","color","id","noshade","size","title","width"],e.i=["class","dir","id","lang","title"],e.img=["align","alt","border","class","controls","dir","dynsrc","height","hspace","id","ismap","lang","longdesc","loop","lowsrc","name","src","start","title","usemap","vspace","width"],e.input=["accept","accesskey","align","alt","border","checked","class","dir","disabled","height","hspace","id","lang","maxlength","name","readonly","size","src","tabindex","title","type","usemap","value","vspace","width"],e.label=["accesskey","class","dir","for","id","lang","title"],e.li=["class","dir","id","lang","title","type","value"],e.ol=["class","compact","dir","id","lang","start","title","type"],e.option=["class","dir","disabled","id","label","lang","selected","title","value"],e.p=["align","class","dir","id","lang","title"],e.span=["class","dir","id","lang","title"],e.strong=["class","dir","id","lang","title"],e.select=["accesskey","class","dir","disabled","id","lang","multiple","name","size","tabindex","title"],e.table=["align","background","bgColor","border","bordercolor","bordercolordark","bordercolorlight","cellpadding","cellspacing","class","cols","datapagesize","dir","frame","height","hspace","id","lang","rules","summary","title","vspace","width"],e.td=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],e.th=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],e.tr=["align","bgColor","bordercolor","bordercolordark","bordercolorlight","class","dir","height","id","lang","nowrap","title","valign"],e.tbody=["align","bgColor","class","dir","id","lang","title","valign"],e.textarea=["accesskey","class","cols","dir","disabled","id","label","lang","name","readonly","rows","tabindex","title","wrap"],e.u=["class","id","xml:lang"],e.ul=["class","compact","dir","id","lang","title","type"],e},n.prototype._getParentElement=function(e){var t=this,n=t._getRange(e),r,i,s,o,u;if(!n)return null;if(n.commonAncestorContainer)return r=e.getSelection(),i=n.startContainer||r.baseNode,s=n.endContainer||r.extentNode,o=n.startOffset,o===null&&(o=r.baseOffset),u=n.endOffset,u===null&&(u=r.extentOffset),i===s&&u-o===1?r.anchorNode.childNodes[r.anchorOffset]:n.commonAncestorContainer.tagName?n.commonAncestorContainer:e.document===n.commonAncestorContainer&&r.baseNode?r.baseNode.parentNode:n.commonAncestorContainer.parentNode;return n.length?n.item(0):n.parentElement?n.parentElement():null},n.prototype._getRange=function(e){var t,n;if(e.document.selection&&!i.opera)return e.document.selection.createRange();if(e.getSelection)return t=e.getSelection(),!t||t.rangeCount<1?null:(t.getRangeAt?n=t.getRangeAt(0):n=e.document.createRange(),n)},n.prototype._generateUniqueName=function(e){var t=l[e];return t||(t=0),l[e]=++t,e+t},n.prototype._setContentEditable=function(e,n){var r="designMode",i="contentEditable";try{e.body[i]&&(e.body[i]=n.toString()),e[r]&&(!n&&e[r]!=="off"?e[r]="off":n&&e[r]!=="on"&&(t.browser.msie&&o(t.browser.version)>=9||(e[r]="on"))),n&&!t.browser.msie&&e.execCommand("useCSS",!1,!0)}catch(s){}},n.prototype._setContentSpellCheck=function(e,t){var n="spellcheck";try{e.body[n]!==undefined&&(e.body[n]=t)}catch(r){}},n.prototype._formatString=function(e,t){var n=e.length,r;for(r=0;r<t-n;r++)e="0"+e;return e},n.prototype._convertToWebColor=function(e,t,n){var r=this,i,s,u,a;if(isNaN(e)||255-e<0)e=0;if(isNaN(t)||255-t<0)t=0;if(isNaN(n)||255-n<0)n=0;return i=r._formatString(o(e).toString(16),2),s=r._formatString(o(t).toString(16),2),u=r._formatString(o(n).toString(16),2),a="#"+i+s+u,a},n.prototype._prepareLiteralRegexText=function(e){var t=e;return t=t.replace("\\","\\\\"),t=t.replace(".","\\."),t=t.replace("?","\\?"),t},n.prototype._isNumeric=function(e){return(new RegExp("^\\d+$")).test(e)},n.prototype._isEmail=function(e){return(new RegExp("mailto:(\\S)+[@]{1}(\\S)+[.]{1}(\\w)+")).test(e)},n.prototype._isUrl=function(e){return(new RegExp("[a-zA-z]+://[^s]+")).test(e)},n.prototype.refresh=function(){var e=this,t=e.element,n=e._getHeader(),r=e._getFooter(),i=e._oriEleWidth,s=e._oriEleHeight,o=e._getContent(),u;e.editor.width(i).height(s),this.$ribbon.wijribbon("updateRibbonSize"),u=e.editor.height()-n.outerHeight(!0)-r.outerHeight(!0),o.height(u).wijsplitter("refresh")},n.prototype.getText=function(){var e=this;return e._getDesignViewText()},n.prototype.setText=function(e){var t=this;e&&(t._setDesignViewText(e),t.sourceView.val(e))},n.prototype.localizeString=function(e,t){var n=this.options;return n.localization&&n.localization[e]?n.localization[e]:t},n}(e.wijmoWidget);e.wijeditor=ks,ks.prototype.options=t.extend(!0,{},e.wijmoWidget.prototype.options,{initSelector:":jqmData(role='wijeditor')",fullScreenContainerSelector:"",editorMode:"wysiwyg",fullScreenMode:!1,showPathSelector:!0,mode:"ribbon",commandButtonClick:null,simpleModeCommands:null,showFooter:!0,customContextMenu:!0,text:null,textChanged:null,localization:null}),t.wijmo.registerWidget("wijeditor",ks.prototype);var Ls=vr+"-colorcanvas",As=vr+"-color",Os=vr+"-wheel",Ms=vr+"-overlay",_s=vr+"-marker";t.fn.wijeditorcolorcanvas=function(e,t){var n=this.get(0);return n.wijeditorcolorcanvas||(n.wijeditorcolorcanvas=new Ds(n,e,t))};var Ds=function(){function e(e,n,r){var i=this,u="",a,f;f="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, ",u+="<div class='"+Ls+"'>",u+="<div class='"+As+"'></div>",u+="<div class='"+Os+"'></div>",u+="<div class='"+Ms+"'></div>",u+="<div class='h-marker "+_s+"'></div>",u+="<div class='sl-marker "+_s+"'></div></div>",t(e).html(u),a=t("."+Ls,e),i.wheel=t("."+Os,e).get(0),i.radius=84,i.square=100,i.width=194,t.browser.msie&&parseInt(t.browser.version,10)<7&&t("*",a).each(function(){var e=this,n=e.currentStyle.backgroundImage;return n!=="none"&&(n=n.substring(5,n.length-2),t(e).css({backgroundImage:"none",filter:f+"src='"+n+"')"})),this}),i.linkTo=function(e){typeof i.callback=="object"&&t(i.callback).unbind("keyup",i.updateValue),i.color=null;if(typeof e=="function")i.callback=e;else if(typeof e=="object"||typeof e=="string")i.callback=t(e),i.callback.bind("keyup",i.updateValue),i.callback.get(0).value&&i.setColor(i.callback.get(0).value);return this},i.updateValue=function(e){var t=this;t.value&&t.value!==i.color&&i.setColor(t.value)},i.setColor=function(e){var t=i.unpack(e);return i.color!==e&&t&&(i.color=e,i.rgb=t,i.hsl=i.RGBToHSL(i.rgb),i.updateDisplay()),this},i.setHSL=function(e){return i.hsl=e,i.rgb=i.HSLToRGB(e),i.color=i.pack(i.rgb),i.updateDisplay(),this},i.widgetCoords=function(e){var n,r,s,o,u;return s=e.target||e.srcElement,o=i.wheel,u=i.absolutePosition(o),n=(e.pageX||0*(e.clientX+t("html").get(0).scrollLeft))-u.x,r=(e.pageY||0*(e.clientY+t("html").get(0).scrollTop))-u.y,{x:n-i.width/2,y:r-i.width/2}},i.mousedown=function(e){s.dragging||(t(s).bind("mousemove",i.mousemove).bind("mouseup",i.mouseup),s.dragging=!0);var n=i.widgetCoords(e);return i.circleDrag=Math.max(Math.abs(n.x),Math.abs(n.y))*2>i.square,i.mousemove(e),!1},i.mousemove=function(e){var t=i.widgetCoords(e),n,r,s;return i.circleDrag?(n=Math.atan2(t.x,-t.y)/6.28,n<0&&(n+=1),i.setHSL([n,i.hsl[1],i.hsl[2]])):(r=Math.max(0,Math.min(1,-(t.x/i.square)+.5)),s=Math.max(0,Math.min(1,-(t.y/i.square)+.5)),i.setHSL([i.hsl[0],r,s])),!1},i.mouseup=function(){t(s).unbind("mousemove",i.mousemove).unbind("mouseup",i.mouseup),s.dragging=!1},i.updateDisplay=function(){var e=i.hsl[0]*6.28,n;t(".h-marker",a).css({left:Math.round(Math.sin(e)*i.radius+i.width/2)+"px",top:Math.round(-Math.cos(e)*i.radius+i.width/2)+"px"}),t(".sl-marker",a).css({left:Math.round(i.square*(.5-i.hsl[1])+i.width/2)+"px",top:Math.round(i.square*(.5-i.hsl[2])+i.width/2)+"px"}),t("."+As,a).css("backgroundColor",i.pack(i.HSLToRGB([i.hsl[0],1,.5]))),typeof i.callback=="object"?(t(i.callback).css({backgroundColor:i.color,color:i.hsl[2]>.5?"#000":"#fff"}),t(i.callback).each(function(){return n=this,n.value&&n.value!==i.color&&(n.value=i.color),this})):typeof i.callback=="function"&&i.callback.call(i,i.color)},i.absolutePosition=function(e){var t={x:e.offsetLeft,y:e.offsetTop},n;return e.offsetParent&&(n=i.absolutePosition(e.offsetParent),t.x+=n.x,t.y+=n.y),t},i.pack=function(e){var t=Math.round(e[0]*255),n,r;return n=Math.round(e[1]*255),r=Math.round(e[2]*255),"#"+(t<16?"0":"")+t.toString(16)+(n<16?"0":"")+n.toString(16)+(r<16?"0":"")+r.toString(16)},i.unpack=function(e){if(e.length===7)return[o("0x"+e.substring(1,3))/255,o("0x"+e.substring(3,5))/255,o("0x"+e.substring(5,7))/255];if(e.length===4)return[o("0x"+e.substring(1,2))/15,o("0x"+e.substring(2,3))/15,o("0x"+e.substring(3,4))/15]},i.HSLToRGB=function(e){var t,n,r,i,s,o=this;return r=e[0],i=e[1],s=e[2],n=s<=.5?s*(i+1):s+i-s*i,t=s*2-n,[o.hueToRGB(t,n,r+.33333),o.hueToRGB(t,n,r),o.hueToRGB(t,n,r-.33333)]},i.hueToRGB=function(e,t,n){return n=n<0?n+1:n>1?n-1:n,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(.66666-n)*6:e},i.RGBToHSL=function(e){var t,n,r,i,s,o,u,a,f;return u=e[0],a=e[1],f=e[2],t=Math.min(u,Math.min(a,f)),n=Math.max(u,Math.max(a,f)),r=n-t,o=(t+n)/2,s=0,o>0&&o<1&&(s=r/(o<.5?2*o:2-2*o)),i=0,r>0&&(n===u&&n!==a&&(i+=(a-f)/r),n===a&&n!==f&&(i+=2+(f-u)/r),n===f&&n!==u&&(i+=4+(u-a)/r),i/=6),[i,s,o]},t("*",a).mousedown(i.mousedown),i.setColor(r||"#000000"),n&&i.linkTo(n)}return e}();e._wijeditorcolorcanvas=Ds})(wijmo||(wijmo={}));